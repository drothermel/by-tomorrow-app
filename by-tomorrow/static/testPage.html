<!DOCTYPE html>

<html lang="en">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <title>A Survey on Evaluation of Out-of-Distribution Generalization</title>
    <!--Generated on Mon Mar  4 09:27:58 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no"
      name="viewport" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" type="text/css" />
    <link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet"
      type="text/css" />
    <link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet"
      type="text/css" />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
    <script src="/static/browse/0.3.4/js/addons.js"></script>
    <script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
    <meta content="
Out-of-Distribution Generalization,  Distribution shift,  Model Evaluation,  Dataset Benchmarks,  Performance Prediction,  Invariant Learning,  Distributionally Robust Optimization
" lang="en" name="keywords" />
    <base href="/html/2403.01874v1/" /></head>
  <body>
    <nav class="ltx_page_navbar">
      <nav class="ltx_TOC">
        <ol class="ltx_toclist">
          <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
              href="https://arxiv.org/html/2403.01874v1#S1"
              title="1 Introduction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">1 </span><span
                  class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
          <li class="ltx_tocentry ltx_tocentry_section">
            <a class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S2"
              title="2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">2 </span><span
                  class="ltx_text ltx_font_smallcaps">Problem setting and
                  categorization</span></span></a>
            <ol class="ltx_toclist ltx_toclist_section">
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S2.SS1"
                  title="2.1 Problem Definition of OOD Generalization ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">2.1 </span><span
                      class="ltx_text ltx_font_italic">Problem Definition of OOD
                      Generalization</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection">
                <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S2.SS2"
                  title="2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">2.2 </span><span
                      class="ltx_text ltx_font_italic">Categorization of OOD
                      Evaluation</span></span></a>
                <ol class="ltx_toclist ltx_toclist_subsection">
                  <li class="ltx_tocentry ltx_tocentry_paragraph"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S2.SS2.SSS0.Px1"
                      title="OOD Performance Testing ‣ 2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title">OOD Performance
                        Testing</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_paragraph"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S2.SS2.SSS0.Px2"
                      title="OOD Performance Prediction ‣ 2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title">OOD Performance
                        Prediction</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_paragraph"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S2.SS2.SSS0.Px3"
                      title="OOD Intrinsic Property Characterization ‣ 2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title">OOD Intrinsic Property
                        Characterization</span></a></li>
                </ol>
              </li>
            </ol>
          </li>
          <li class="ltx_tocentry ltx_tocentry_section">
            <a class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S3"
              title="3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">3 </span><span
                  class="ltx_text ltx_font_smallcaps">OOD performance
                  testing</span></span></a>
            <ol class="ltx_toclist ltx_toclist_section">
              <li class="ltx_tocentry ltx_tocentry_subsection">
                <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S3.SS1"
                  title="3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">3.1 </span><span
                      class="ltx_text ltx_font_italic">Designing Datasets and
                      Benchmarks</span></span></a>
                <ol class="ltx_toclist ltx_toclist_subsection">
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS1"
                      title="3.1.1 Synthetic Datasets ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.1 </span>Synthetic
                        Datasets</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS2"
                      title="3.1.2 Visual Datasets ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.2 </span>Visual
                        Datasets</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS3"
                      title="3.1.3 Text Datasets ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.3 </span>Text
                        Datasets</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS4"
                      title="3.1.4 Tabular Datasets ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.4 </span>Tabular
                        Datasets</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS5"
                      title="3.1.5 Benchmarks with Combined Datasets or Settings ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.5 </span>Benchmarks
                        with Combined Datasets or Settings</span></a></li>
                  <li class="ltx_tocentry ltx_tocentry_subsubsection"><a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S3.SS1.SSS6"
                      title="3.1.6 Discussion ‣ 3.1 Designing Datasets and Benchmarks ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_title"><span
                          class="ltx_tag ltx_tag_ref">3.1.6
                        </span>Discussion</span></a></li>
                </ol>
              </li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S3.SS2"
                  title="3.2 Analyzing Performance and Shifts ‣ 3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">3.2 </span><span
                      class="ltx_text ltx_font_italic">Analyzing Performance and
                      Shifts</span></span></a></li>
            </ol>
          </li>
          <li class="ltx_tocentry ltx_tocentry_section">
            <a class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S4"
              title="4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">4 </span><span
                  class="ltx_text ltx_font_smallcaps">OOD performance
                  prediction</span></span></a>
            <ol class="ltx_toclist ltx_toclist_section">
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S4.SS1"
                  title="4.1 Performance Prediction using Model Output Properties on Test Data ‣ 4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">4.1 </span><span
                      class="ltx_text ltx_font_italic">Performance Prediction
                      using Model Output Properties on Test
                      Data</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S4.SS2"
                  title="4.2 Distribution Discrepancy based Performance Prediction ‣ 4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">4.2 </span><span
                      class="ltx_text ltx_font_italic">Distribution Discrepancy
                      based Performance Prediction</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S4.SS3"
                  title="4.3 Model Agreement based Performance Prediction ‣ 4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">4.3 </span><span
                      class="ltx_text ltx_font_italic">Model Agreement based
                      Performance Prediction</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S4.SS4"
                  title="4.4 Discussion ‣ 4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">4.4 </span><span
                      class="ltx_text ltx_font_italic">Discussion</span></span></a></li>
            </ol>
          </li>
          <li class="ltx_tocentry ltx_tocentry_section">
            <a class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S5"
              title="5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">5 </span><span
                  class="ltx_text ltx_font_smallcaps">OOD intrinsic property
                  characterization</span></span></a>
            <ol class="ltx_toclist ltx_toclist_section">
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S5.SS1"
                  title="5.1 Distributional Robustness ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">5.1 </span><span
                      class="ltx_text ltx_font_italic">Distributional
                      Robustness</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S5.SS2"
                  title="5.2 Stability ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">5.2 </span><span
                      class="ltx_text ltx_font_italic">Stability</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S5.SS3"
                  title="5.3 Invariance ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">5.3 </span><span
                      class="ltx_text ltx_font_italic">Invariance</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S5.SS4"
                  title="5.4 Flatness ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">5.4 </span><span
                      class="ltx_text ltx_font_italic">Flatness</span></span></a></li>
              <li class="ltx_tocentry ltx_tocentry_subsection"><a
                  class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S5.SS5"
                  title="5.5 Discussion ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title"><span
                      class="ltx_tag ltx_tag_ref">5.5 </span><span
                      class="ltx_text ltx_font_italic">Discussion</span></span></a></li>
            </ol>
          </li>
          <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
              href="https://arxiv.org/html/2403.01874v1#S6"
              title="6 Discussion on pretrained models ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">6 </span><span
                  class="ltx_text ltx_font_smallcaps">Discussion on pretrained
                  models</span></span></a></li>
          <li class="ltx_tocentry ltx_tocentry_section">
            <a class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S7"
              title="7 Conclusion and Future Directions ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                class="ltx_text ltx_ref_title"><span
                  class="ltx_tag ltx_tag_ref">7 </span><span
                  class="ltx_text ltx_font_smallcaps">Conclusion and Future
                  Directions</span></span></a>
            <ol class="ltx_toclist ltx_toclist_section">
              <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S7.SS0.SSS0.Px1"
                  title="OOD evaluation beyond performance ‣ 7 Conclusion and Future Directions ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title">OOD evaluation beyond
                    performance</span></a></li>
              <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S7.SS0.SSS0.Px2"
                  title="OOD evaluation of training data ‣ 7 Conclusion and Future Directions ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title">OOD evaluation of training
                    data</span></a></li>
              <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S7.SS0.SSS0.Px3"
                  title="Distinguishing performance of OOD generalization from ID generalization ‣ 7 Conclusion and Future Directions ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_title">Distinguishing performance of
                    OOD generalization from ID generalization</span></a></li>
            </ol>
          </li>
        </ol></nav>
    </nav>
    <div class="ltx_page_main">
      <div class="ltx_page_content"><div class="section"
          id="target-section"><div id="license-tr">License: arXiv.org perpetual
            non-exclusive license</div><div id="watermark-tr">arXiv:2403.01874v1
            [cs.LG] 04 Mar 2024</div></div>
        <article class="ltx_document ltx_authors_1line">
          <h1 class="ltx_title ltx_title_document">A Survey on Evaluation of
            Out-of-Distribution Generalization</h1>
          <div class="ltx_authors">
            <span class="ltx_creator ltx_role_author">
              <span class="ltx_personname">
                Han Yu, Jiashuo Liu, Xingxuan Zhang, Jiayun Wu, Peng Cui<math
                  alttext="{}^{\dagger}" class="ltx_Math" display="inline"
                  id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup
                      id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi
                        id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mo
                        id="id1.1.m1.1.1.1"
                        xref="id1.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml
                      encoding="MathML-Content" id="id1.1.m1.1b"><apply
                        id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><ci
                          id="id1.1.m1.1.1.1.cmml"
                          xref="id1.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation
                      encoding="application/x-tex"
                      id="id1.1.m1.1c">{}^{\dagger}</annotation><annotation
                      encoding="application/x-llamapun"
                      id="id1.1.m1.1d">start_FLOATSUPERSCRIPT †
                      end_FLOATSUPERSCRIPT</annotation></semantics></math>
              </span><span class="ltx_author_notes"><math alttext="\dagger"
                  class="ltx_Math" display="inline" id="id2.2.m1.1"><semantics
                    id="id2.2.m1.1a"><mo id="id2.2.m1.1.1"
                      xref="id2.2.m1.1.1.cmml">†</mo><annotation-xml
                      encoding="MathML-Content" id="id2.2.m1.1b"><ci
                        id="id2.2.m1.1.1.cmml"
                        xref="id2.2.m1.1.1">†</ci></annotation-xml><annotation
                      encoding="application/x-tex"
                      id="id2.2.m1.1c">\dagger</annotation><annotation
                      encoding="application/x-llamapun"
                      id="id2.2.m1.1d">†</annotation></semantics></math>
                Corresponding Author
                E-mail: yuh21@mails.tsinghua.edu.cn, liujiashuo77@gmail.com,
                xingxuanzhang@hotmail.com, jiayun.wu.work@gmail.com,
                cuip@tsinghua.edu.cn.
                All authors are with the Department of Computer Science and
                Technology, Tsinghua University, Beijing, China. </span></span>
          </div>
          <div class="ltx_abstract">
            <h6 class="ltx_title ltx_title_abstract">Abstract</h6>
            <p class="ltx_p" id="id3.id1">Machine learning models, while
              progressively advanced, rely heavily on the IID assumption, which
              is often unfulfilled in practice due to inevitable distribution
              shifts. This renders them susceptible and untrustworthy for
              deployment in risk-sensitive applications.
              Such a significant problem has consequently spawned various
              branches of works dedicated to developing algorithms capable of
              Out-of-Distribution (OOD) generalization.
              Despite these efforts, much less attention has been paid to the
              evaluation of OOD generalization, which is also a complex and
              fundamental problem. Its goal is not only to assess whether a
              model’s OOD generalization capability is strong or not, but also
              to evaluate where a model generalizes well or poorly. This entails
              characterizing the types of distribution shifts that a model can
              effectively address, and identifying the safe and risky input
              regions given a model.
              This paper serves as the first effort to conduct a comprehensive
              review of OOD evaluation. We categorize existing research into
              three paradigms: OOD performance testing, OOD performance
              prediction, and OOD intrinsic property characterization, according
              to the availability of test data. Additionally, we briefly discuss
              OOD evaluation in the context of pretrained models. In closing, we
              propose several promising directions for future research in OOD
              evaluation.</p>
          </div>
          <div class="ltx_keywords">
            <h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
            Out-of-Distribution Generalization, Distribution shift, Model
            Evaluation, Dataset Benchmarks, Performance Prediction, Invariant
            Learning, Distributionally Robust Optimization

          </div>
          <section class="ltx_section" id="S1">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">1 </span><span
                class="ltx_text ltx_font_smallcaps"
                id="S1.1.1">Introduction</span>
            </h2>
            <div class="ltx_para" id="S1.p1">
              <p class="ltx_p" id="S1.p1.1">Over the past decade, significant
                advancements have transpired in the field of machine learning.
                Driven by the exponential growth of data and computational
                resources, neural networks have achieved marvelous performance
                across a wide spectrum of applications, including but not
                limited to computer vision <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib1"
                    title>1</a>]</cite>, natural language processing <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib2"
                    title>2</a>]</cite>, and recommender systems <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib3"
                    title>3</a>]</cite>.
                Despite remarkable progress, it is imperative to acknowledge
                that existing machine learning algorithms and models still
                grapple with several persistent challenges that greatly
                undermine their reliability and trustworthiness.
                The challenges encompass issues such as privacy leakage <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib4"
                    title>4</a>]</cite>, weak interpretability of black box
                models <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib5"
                    title>5</a>]</cite>, vulnerability under adversarial attacks
                <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib6"
                    title>6</a>]</cite>, and a notable decline in generalization
                performance when confronted with distribution shifts <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                    title>7</a>]</cite>.
                These aforementioned challenges pose a substantial impediment to
                the widespread adoption of current machine learning algorithms,
                particularly in fields of high risk sensitivity.
                Typical examples include law <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib8"
                    title>8</a>]</cite>, where fairness and equity are
                paramount, medical care <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib9"
                    title>9</a>]</cite>, where patient well-being is at stake,
                and autonomous driving <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib10"
                    title>10</a>]</cite>, where human lives depend on the
                performance of these algorithms.</p>
            </div>
            <div class="ltx_para" id="S1.p2">
              <p class="ltx_p" id="S1.p2.1">Among the challenges, one that poses
                a substantial obstacle is the problem of generalization against
                distribution shifts, often referred to as Out-of-Distribution
                (OOD) generalization.
                This is most prevalent because current algorithms heavily rely
                on the IID assumption, i.e. test data and training data should
                be independent and identically distributed, but distribution
                shifts are almost everywhere.
                In real applications, we can hardly guarantee that the test data
                encountered by deployed models will conform to the same
                distribution as training data.
                For example, models of recommender systems are trained on user
                data collected from the United States, but are tasked with
                extending to users in different countries, where the
                distribution of user preferences may vary largely.
                Similarly, visual recognition models trained on a dataset
                primarily comprising real photographs face the demanding task of
                recognizing images of diverse styles, such as art paintings,
                which represent a substantial distribution shift from their
                training data <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib11"
                    title>11</a>]</cite>.
                Additionally, demographic groups are usually imbalanced in
                training data, particularly with respect to gender or race. In
                such cases, the generalization performance of models can easily
                drop when minority groups in the training data dominate the test
                data <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib12"
                    title>12</a>]</cite>.
                All these instances of distribution shifts bring about
                performance degradation of machine learning algorithms.
                Although domain adaptation techniques <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib13"
                    title>13</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib14"
                    title>14</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib15"
                    title>15</a>]</cite> have been developed to solve a similar
                problem with the help of test data since much earlier, in wild
                environments, distribution shifts are ubiquitous and unknown,
                where we are unlikely to have access to test data a priori.</p>
            </div>
            <div class="ltx_para" id="S1.p3">
              <p class="ltx_p" id="S1.p3.1">One straightforward way involves
                developing algorithms that enhance the OOD generalization
                ability of models when test data is totally unknown, as
                highlighted by Shen et al. <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                    title>7</a>]</cite>.
                In recent years, several branches of works have been dedicated
                to this objective.
                Domain generalization (DG) <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib16"
                    title>16</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib17"
                    title>17</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                    title>18</a>]</cite> takes advantage of multiple training
                domains to enable models to generalize to previously unseen test
                domains, mainly in the area of computer vision.
                Distributionally Robust Optimization (DRO) and its variants
                <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib19"
                    title>19</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib20"
                    title>20</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib21"
                    title>21</a>]</cite> try to address the worst-case
                distribution.
                Invariant learning <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                    title>22</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib23"
                    title>23</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib24"
                    title>24</a>]</cite> seeks to capture the underlying
                heterogeneity and invariance present in the training data.
                Stable learning <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib25"
                    title>25</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib26"
                    title>26</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib27"
                    title>27</a>]</cite> methods borrow ideas from causal
                inference to decorrelate variables through sample reweighting.
                These diverse branches collectively contribute to the
                overarching goal of improving OOD generalization, each offering
                unique insights and advancements that cannot be ignored.</p>
            </div>
            <div class="ltx_para" id="S1.p4">
              <p class="ltx_p" id="S1.p4.1">An alternative avenue for rendering
                machine learning models applicable in high-stakes areas is <span
                  class="ltx_text ltx_font_bold"
                  id="S1.p4.1.1">evaluation</span>, i.e. evaluating their
                generalization ability under possible OOD scenarios.
                In contrast to the rapid proliferation of OOD generalization
                algorithms, much less attention has been paid to the aspect of
                evaluation. Evaluation is imperative across various areas of
                machine learning. Appropriate evaluation protocols and methods
                possess the potential to catalyze advancements in a field, just
                like ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib28"
                    title>28</a>]</cite> did in the realm of computer vision.
                In the context of OOD generalization, evaluation plays an even
                more fundamental role.
                On one hand, OOD evaluation appears generally more intricate
                compared with its ID (In-Distribution) counterpart. For
                instance, given a dataset of a single task like image
                recognition, a natural approach entails randomly splitting it
                into a training set and a test set, with test accuracy serving
                as the evaluation metric for ID generalization. But when
                confronted with the same dataset, how can we split the dataset
                to generate the desired distribution shift and characterize the
                shift? Is this distribution shift solvable <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib29"
                    title>29</a>]</cite>? It becomes a much more complicated
                procedure within the context of OOD.
                On the other hand, it is worth noting that none of the current
                OOD generalization algorithms have achieved universal and
                tremendous improvement across various OOD settings and blasted
                the OOD community like ResNet <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib1"
                    title>1</a>]</cite> did to the community of computer vision,
                or Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib30"
                    title>30</a>]</cite> did to the community of natural
                language processing.
                Indeed, it is quite difficult to develop a model that
                consistently outperforms others by a large margin in terms of
                OOD generalization, given that there are diverse types of
                distribution shifts to be addressed <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib31"
                    title>31</a>]</cite>, and one can hardly address them once
                and for all.
                Under this circumstance, it is more practical and useful to
                evaluate <span class="ltx_text ltx_font_italic"
                  id="S1.p4.1.2">where</span> a model excels or falters.
                Specifically, our objective shifts towards identifying what
                types of distribution shifts there exist <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib32"
                    title>32</a>]</cite> and assessing the model’s competence in
                handling them, and we seek to pinpoint safe and risky input
                regions in which the model demonstrates exceptional or terrible
                performance <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                    title>33</a>]</cite>. In this way, we can fully take
                advantage of existing trained models, which cannot generalize
                arbitrarily but are applicable to certain scenarios.</p>
            </div>
            <div class="ltx_para" id="S1.p5">
              <p class="ltx_p" id="S1.p5.1">Besides, OOD evaluation offers
                additional benefits when compared with directly developing a
                model tailored for OOD generalization.
                Nowadays, training a deep model from scratch, or even merely
                fine-tuning an existing one, could be time-consuming and
                expensive <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib34"
                    title>34</a>]</cite>. In data-scarce scenarios like rare
                diseases <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib35"
                    title>35</a>]</cite>, there could be not enough data for
                training at all. In such cases, despite being unable to further
                improve it, we can decide whether and where to use this model
                with the help of proper OOD evaluation methods, or pick the
                suitable one from a model pool.
                Moreover, OOD evaluation is more flexible as well. The designed
                evaluation metric does not have to be optimizable, and it can be
                seamlessly incorporated into the process of model selection,
                which represents a crucial but seldom investigated aspect of OOD
                generalization <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                    title>18</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib36"
                    title>36</a>]</cite>. It can also be combined with
                non-algorithmic operations like adding extra data or features
                <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                    title>33</a>]</cite>.</p>
            </div>
            <div class="ltx_para" id="S1.p6">
              <p class="ltx_p" id="S1.p6.1">Therefore, we consider OOD
                evaluation as a fundamental direction for OOD generalization.
                The goal is not only to determine whether a model possesses a
                good OOD generalization ability, but also to identify where it
                can perform well, including the types and degrees of
                distribution shifts, along with the corresponding input regions
                where the model maintains its competence.
                In this paper, we provide a systematic review of current OOD
                evaluation protocols, metrics, and methods, covering the
                multifaceted goals of OOD evaluation. To the best of our
                knowledge, we are the first to take a comprehensive view of this
                area. Previous surveys mainly concentrated on either the OOD
                generalization itself <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                    title>7</a>]</cite>, or on the general evaluation of machine
                learning models <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib34"
                    title>34</a>]</cite>. Another survey also reviews the
                evaluation of OOD models but its scope is confined to the realm
                of NLP only <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib37"
                    title>37</a>]</cite>.</p>
            </div>
            <div class="ltx_para" id="S1.p7">
              <p class="ltx_p" id="S1.p7.1">The rest of this paper is organized
                as follows.
                In Section <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S2"
                  title="2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">2</span></a>, we introduce the
                problem setting and the categorization of OOD evaluation
                paradigms.
                In Section <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S3"
                  title="3 OOD performance testing ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">3</span></a>, <a
                  class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S4"
                  title="4 OOD performance prediction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">4</span></a>, <a
                  class="ltx_ref" href="https://arxiv.org/html/2403.01874v1#S5"
                  title="5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">5</span></a>, we describe each
                category of OOD evaluation paradigms, mainly according to the
                dependence on OOD test data.
                In Section <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S6"
                  title="6 Discussion on pretrained models ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">6</span></a>, we discuss OOD
                evaluation within the scope of pretrained models, including
                Large Language Models (LLMs).
                Finally, in Section <a class="ltx_ref"
                  href="https://arxiv.org/html/2403.01874v1#S7"
                  title="7 Conclusion and Future Directions ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                    class="ltx_text ltx_ref_tag">7</span></a>, we conclude this
                paper and raise some directions that merit further exploration
                in future research endeavors.</p>
            </div>
          </section>
          <section class="ltx_section" id="S2">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">2 </span><span
                class="ltx_text ltx_font_smallcaps" id="S2.1.1">Problem setting
                and categorization</span>
            </h2>
            <figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption"
                class="ltx_graphics ltx_centering ltx_img_landscape"
                height="397" id="S2.F1.g1" src="x1.png" width="831" />
              <figcaption class="ltx_caption ltx_centering"><span
                  class="ltx_tag ltx_tag_figure">Figure 1: </span>An overview of
                OOD evaluation. </figcaption>
            </figure>
            <div class="ltx_para" id="S2.p1">
              <p class="ltx_p" id="S2.p1.1">In this section, we first introduce
                the definition of the OOD generalization problem, and then we
                categorize existing literature on OOD evaluation into three
                distinct parts based on their dependence upon OOD test data.</p>
            </div>
            <section class="ltx_subsection" id="S2.SS1">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">2.1 </span><span
                  class="ltx_text ltx_font_italic" id="S2.SS1.1.1">Problem
                  Definition of OOD Generalization</span>
              </h3>
              <div class="ltx_para" id="S2.SS1.p1">
                <p class="ltx_p" id="S2.SS1.p1.9">Following Shen et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                      title>7</a>]</cite>, we denote the input space as <math
                    alttext="\mathcal{X}" class="ltx_Math" display="inline"
                    id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi
                        class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1"
                        xref="S2.SS1.p1.1.m1.1.1.cmml">𝒳</mi><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci
                          id="S2.SS1.p1.1.m1.1.1.cmml"
                          xref="S2.SS1.p1.1.m1.1.1">𝒳</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.1.m1.1c">\mathcal{X}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.1.m1.1d">caligraphic_X</annotation></semantics></math>
                  and the output space as <math alttext="\mathcal{Y}"
                    class="ltx_Math" display="inline"
                    id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi
                        class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.1"
                        xref="S2.SS1.p1.2.m2.1.1.cmml">𝒴</mi><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci
                          id="S2.SS1.p1.2.m2.1.1.cmml"
                          xref="S2.SS1.p1.2.m2.1.1">𝒴</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.2.m2.1c">\mathcal{Y}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.2.m2.1d">caligraphic_Y</annotation></semantics></math>.
                  We define the parametric mapping function as <math
                    alttext="f_{\theta}:\mathcal{X}\mapsto\mathcal{Y}"
                    class="ltx_Math" display="inline"
                    id="S2.SS1.p1.3.m3.1"><semantics
                      id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1"
                        xref="S2.SS1.p1.3.m3.1.1.cmml"><msub
                          id="S2.SS1.p1.3.m3.1.1.2"
                          xref="S2.SS1.p1.3.m3.1.1.2.cmml"><mi
                            id="S2.SS1.p1.3.m3.1.1.2.2"
                            xref="S2.SS1.p1.3.m3.1.1.2.2.cmml">f</mi><mi
                            id="S2.SS1.p1.3.m3.1.1.2.3"
                            xref="S2.SS1.p1.3.m3.1.1.2.3.cmml">θ</mi></msub><mo
                          id="S2.SS1.p1.3.m3.1.1.1" lspace="0.278em"
                          rspace="0.278em"
                          xref="S2.SS1.p1.3.m3.1.1.1.cmml">:</mo><mrow
                          id="S2.SS1.p1.3.m3.1.1.3"
                          xref="S2.SS1.p1.3.m3.1.1.3.cmml"><mi
                            class="ltx_font_mathcaligraphic"
                            id="S2.SS1.p1.3.m3.1.1.3.2"
                            xref="S2.SS1.p1.3.m3.1.1.3.2.cmml">𝒳</mi><mo
                            id="S2.SS1.p1.3.m3.1.1.3.1" stretchy="false"
                            xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">↦</mo><mi
                            class="ltx_font_mathcaligraphic"
                            id="S2.SS1.p1.3.m3.1.1.3.3"
                            xref="S2.SS1.p1.3.m3.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply
                          id="S2.SS1.p1.3.m3.1.1.cmml"
                          xref="S2.SS1.p1.3.m3.1.1"><ci
                            id="S2.SS1.p1.3.m3.1.1.1.cmml"
                            xref="S2.SS1.p1.3.m3.1.1.1">:</ci><apply
                            id="S2.SS1.p1.3.m3.1.1.2.cmml"
                            xref="S2.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous"
                              id="S2.SS1.p1.3.m3.1.1.2.1.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci
                              id="S2.SS1.p1.3.m3.1.1.2.2.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.2.2">𝑓</ci><ci
                              id="S2.SS1.p1.3.m3.1.1.2.3.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.2.3">𝜃</ci></apply><apply
                            id="S2.SS1.p1.3.m3.1.1.3.cmml"
                            xref="S2.SS1.p1.3.m3.1.1.3"><csymbol cd="latexml"
                              id="S2.SS1.p1.3.m3.1.1.3.1.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.3.1">maps-to</csymbol><ci
                              id="S2.SS1.p1.3.m3.1.1.3.2.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.3.2">𝒳</ci><ci
                              id="S2.SS1.p1.3.m3.1.1.3.3.cmml"
                              xref="S2.SS1.p1.3.m3.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.3.m3.1c">f_{\theta}:\mathcal{X}\mapsto\mathcal{Y}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT
                        italic_θ end_POSTSUBSCRIPT : caligraphic_X ↦
                        caligraphic_Y</annotation></semantics></math>, which
                  represents the machine learning model. There is also a loss
                  function describing the dissimilarity between the predicted
                  output and the ground-truth output, denoted as <math
                    alttext="\ell:\mathcal{Y}\times\mathcal{Y}\mapsto\mathbb{R}"
                    class="ltx_Math" display="inline"
                    id="S2.SS1.p1.4.m4.1"><semantics
                      id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1"
                        xref="S2.SS1.p1.4.m4.1.1.cmml"><mi
                          id="S2.SS1.p1.4.m4.1.1.2" mathvariant="normal"
                          xref="S2.SS1.p1.4.m4.1.1.2.cmml">ℓ</mi><mo
                          id="S2.SS1.p1.4.m4.1.1.1" lspace="0.278em"
                          rspace="0.278em"
                          xref="S2.SS1.p1.4.m4.1.1.1.cmml">:</mo><mrow
                          id="S2.SS1.p1.4.m4.1.1.3"
                          xref="S2.SS1.p1.4.m4.1.1.3.cmml"><mrow
                            id="S2.SS1.p1.4.m4.1.1.3.2"
                            xref="S2.SS1.p1.4.m4.1.1.3.2.cmml"><mi
                              class="ltx_font_mathcaligraphic"
                              id="S2.SS1.p1.4.m4.1.1.3.2.2"
                              xref="S2.SS1.p1.4.m4.1.1.3.2.2.cmml">𝒴</mi><mo
                              id="S2.SS1.p1.4.m4.1.1.3.2.1" lspace="0.222em"
                              rspace="0.222em"
                              xref="S2.SS1.p1.4.m4.1.1.3.2.1.cmml">×</mo><mi
                              class="ltx_font_mathcaligraphic"
                              id="S2.SS1.p1.4.m4.1.1.3.2.3"
                              xref="S2.SS1.p1.4.m4.1.1.3.2.3.cmml">𝒴</mi></mrow><mo
                            id="S2.SS1.p1.4.m4.1.1.3.1" stretchy="false"
                            xref="S2.SS1.p1.4.m4.1.1.3.1.cmml">↦</mo><mi
                            id="S2.SS1.p1.4.m4.1.1.3.3"
                            xref="S2.SS1.p1.4.m4.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply
                          id="S2.SS1.p1.4.m4.1.1.cmml"
                          xref="S2.SS1.p1.4.m4.1.1"><ci
                            id="S2.SS1.p1.4.m4.1.1.1.cmml"
                            xref="S2.SS1.p1.4.m4.1.1.1">:</ci><ci
                            id="S2.SS1.p1.4.m4.1.1.2.cmml"
                            xref="S2.SS1.p1.4.m4.1.1.2">ℓ</ci><apply
                            id="S2.SS1.p1.4.m4.1.1.3.cmml"
                            xref="S2.SS1.p1.4.m4.1.1.3"><csymbol cd="latexml"
                              id="S2.SS1.p1.4.m4.1.1.3.1.cmml"
                              xref="S2.SS1.p1.4.m4.1.1.3.1">maps-to</csymbol><apply
                              id="S2.SS1.p1.4.m4.1.1.3.2.cmml"
                              xref="S2.SS1.p1.4.m4.1.1.3.2"><times
                                id="S2.SS1.p1.4.m4.1.1.3.2.1.cmml"
                                xref="S2.SS1.p1.4.m4.1.1.3.2.1"></times><ci
                                id="S2.SS1.p1.4.m4.1.1.3.2.2.cmml"
                                xref="S2.SS1.p1.4.m4.1.1.3.2.2">𝒴</ci><ci
                                id="S2.SS1.p1.4.m4.1.1.3.2.3.cmml"
                                xref="S2.SS1.p1.4.m4.1.1.3.2.3">𝒴</ci></apply><ci
                              id="S2.SS1.p1.4.m4.1.1.3.3.cmml"
                              xref="S2.SS1.p1.4.m4.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.4.m4.1c">\ell:\mathcal{Y}\times\mathcal{Y}\mapsto\mathbb{R}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.4.m4.1d">roman_ℓ : caligraphic_Y ×
                        caligraphic_Y ↦
                        blackboard_R</annotation></semantics></math>. As usually
                  assumed, we consider test data originating from a probability
                  distribution <math alttext="P_{te}(X,Y)" class="ltx_Math"
                    display="inline" id="S2.SS1.p1.5.m5.2"><semantics
                      id="S2.SS1.p1.5.m5.2a"><mrow id="S2.SS1.p1.5.m5.2.3"
                        xref="S2.SS1.p1.5.m5.2.3.cmml"><msub
                          id="S2.SS1.p1.5.m5.2.3.2"
                          xref="S2.SS1.p1.5.m5.2.3.2.cmml"><mi
                            id="S2.SS1.p1.5.m5.2.3.2.2"
                            xref="S2.SS1.p1.5.m5.2.3.2.2.cmml">P</mi><mrow
                            id="S2.SS1.p1.5.m5.2.3.2.3"
                            xref="S2.SS1.p1.5.m5.2.3.2.3.cmml"><mi
                              id="S2.SS1.p1.5.m5.2.3.2.3.2"
                              xref="S2.SS1.p1.5.m5.2.3.2.3.2.cmml">t</mi><mo
                              id="S2.SS1.p1.5.m5.2.3.2.3.1"
                              xref="S2.SS1.p1.5.m5.2.3.2.3.1.cmml">⁢</mo><mi
                              id="S2.SS1.p1.5.m5.2.3.2.3.3"
                              xref="S2.SS1.p1.5.m5.2.3.2.3.3.cmml">e</mi></mrow></msub><mo
                          id="S2.SS1.p1.5.m5.2.3.1"
                          xref="S2.SS1.p1.5.m5.2.3.1.cmml">⁢</mo><mrow
                          id="S2.SS1.p1.5.m5.2.3.3.2"
                          xref="S2.SS1.p1.5.m5.2.3.3.1.cmml"><mo
                            id="S2.SS1.p1.5.m5.2.3.3.2.1" stretchy="false"
                            xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">(</mo><mi
                            id="S2.SS1.p1.5.m5.1.1"
                            xref="S2.SS1.p1.5.m5.1.1.cmml">X</mi><mo
                            id="S2.SS1.p1.5.m5.2.3.3.2.2"
                            xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">,</mo><mi
                            id="S2.SS1.p1.5.m5.2.2"
                            xref="S2.SS1.p1.5.m5.2.2.cmml">Y</mi><mo
                            id="S2.SS1.p1.5.m5.2.3.3.2.3" stretchy="false"
                            xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.5.m5.2b"><apply
                          id="S2.SS1.p1.5.m5.2.3.cmml"
                          xref="S2.SS1.p1.5.m5.2.3"><times
                            id="S2.SS1.p1.5.m5.2.3.1.cmml"
                            xref="S2.SS1.p1.5.m5.2.3.1"></times><apply
                            id="S2.SS1.p1.5.m5.2.3.2.cmml"
                            xref="S2.SS1.p1.5.m5.2.3.2"><csymbol cd="ambiguous"
                              id="S2.SS1.p1.5.m5.2.3.2.1.cmml"
                              xref="S2.SS1.p1.5.m5.2.3.2">subscript</csymbol><ci
                              id="S2.SS1.p1.5.m5.2.3.2.2.cmml"
                              xref="S2.SS1.p1.5.m5.2.3.2.2">𝑃</ci><apply
                              id="S2.SS1.p1.5.m5.2.3.2.3.cmml"
                              xref="S2.SS1.p1.5.m5.2.3.2.3"><times
                                id="S2.SS1.p1.5.m5.2.3.2.3.1.cmml"
                                xref="S2.SS1.p1.5.m5.2.3.2.3.1"></times><ci
                                id="S2.SS1.p1.5.m5.2.3.2.3.2.cmml"
                                xref="S2.SS1.p1.5.m5.2.3.2.3.2">𝑡</ci><ci
                                id="S2.SS1.p1.5.m5.2.3.2.3.3.cmml"
                                xref="S2.SS1.p1.5.m5.2.3.2.3.3">𝑒</ci></apply></apply><interval
                            closure="open" id="S2.SS1.p1.5.m5.2.3.3.1.cmml"
                            xref="S2.SS1.p1.5.m5.2.3.3.2"><ci
                              id="S2.SS1.p1.5.m5.1.1.cmml"
                              xref="S2.SS1.p1.5.m5.1.1">𝑋</ci><ci
                              id="S2.SS1.p1.5.m5.2.2.cmml"
                              xref="S2.SS1.p1.5.m5.2.2">𝑌</ci></interval></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.5.m5.2c">P_{te}(X,Y)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.5.m5.2d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_e end_POSTSUBSCRIPT ( italic_X ,
                        italic_Y )</annotation></semantics></math>, where both
                  <math alttext="X\in\mathcal{X}" class="ltx_Math"
                    display="inline" id="S2.SS1.p1.6.m6.1"><semantics
                      id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1"
                        xref="S2.SS1.p1.6.m6.1.1.cmml"><mi
                          id="S2.SS1.p1.6.m6.1.1.2"
                          xref="S2.SS1.p1.6.m6.1.1.2.cmml">X</mi><mo
                          id="S2.SS1.p1.6.m6.1.1.1"
                          xref="S2.SS1.p1.6.m6.1.1.1.cmml">∈</mo><mi
                          class="ltx_font_mathcaligraphic"
                          id="S2.SS1.p1.6.m6.1.1.3"
                          xref="S2.SS1.p1.6.m6.1.1.3.cmml">𝒳</mi></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply
                          id="S2.SS1.p1.6.m6.1.1.cmml"
                          xref="S2.SS1.p1.6.m6.1.1"><in
                            id="S2.SS1.p1.6.m6.1.1.1.cmml"
                            xref="S2.SS1.p1.6.m6.1.1.1"></in><ci
                            id="S2.SS1.p1.6.m6.1.1.2.cmml"
                            xref="S2.SS1.p1.6.m6.1.1.2">𝑋</ci><ci
                            id="S2.SS1.p1.6.m6.1.1.3.cmml"
                            xref="S2.SS1.p1.6.m6.1.1.3">𝒳</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.6.m6.1c">X\in\mathcal{X}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.6.m6.1d">italic_X ∈
                        caligraphic_X</annotation></semantics></math> and <math
                    alttext="Y\in\mathcal{Y}" class="ltx_Math" display="inline"
                    id="S2.SS1.p1.7.m7.1"><semantics
                      id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.1"
                        xref="S2.SS1.p1.7.m7.1.1.cmml"><mi
                          id="S2.SS1.p1.7.m7.1.1.2"
                          xref="S2.SS1.p1.7.m7.1.1.2.cmml">Y</mi><mo
                          id="S2.SS1.p1.7.m7.1.1.1"
                          xref="S2.SS1.p1.7.m7.1.1.1.cmml">∈</mo><mi
                          class="ltx_font_mathcaligraphic"
                          id="S2.SS1.p1.7.m7.1.1.3"
                          xref="S2.SS1.p1.7.m7.1.1.3.cmml">𝒴</mi></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply
                          id="S2.SS1.p1.7.m7.1.1.cmml"
                          xref="S2.SS1.p1.7.m7.1.1"><in
                            id="S2.SS1.p1.7.m7.1.1.1.cmml"
                            xref="S2.SS1.p1.7.m7.1.1.1"></in><ci
                            id="S2.SS1.p1.7.m7.1.1.2.cmml"
                            xref="S2.SS1.p1.7.m7.1.1.2">𝑌</ci><ci
                            id="S2.SS1.p1.7.m7.1.1.3.cmml"
                            xref="S2.SS1.p1.7.m7.1.1.3">𝒴</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.7.m7.1c">Y\in\mathcal{Y}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.7.m7.1d">italic_Y ∈
                        caligraphic_Y</annotation></semantics></math> are random
                  variables. In our paper, we focus on the classical supervised
                  learning problem. Consequently, we assume that training data
                  is sampled independently and identically from a probability
                  distribution <math alttext="P_{tr}(X,Y)" class="ltx_Math"
                    display="inline" id="S2.SS1.p1.8.m8.2"><semantics
                      id="S2.SS1.p1.8.m8.2a"><mrow id="S2.SS1.p1.8.m8.2.3"
                        xref="S2.SS1.p1.8.m8.2.3.cmml"><msub
                          id="S2.SS1.p1.8.m8.2.3.2"
                          xref="S2.SS1.p1.8.m8.2.3.2.cmml"><mi
                            id="S2.SS1.p1.8.m8.2.3.2.2"
                            xref="S2.SS1.p1.8.m8.2.3.2.2.cmml">P</mi><mrow
                            id="S2.SS1.p1.8.m8.2.3.2.3"
                            xref="S2.SS1.p1.8.m8.2.3.2.3.cmml"><mi
                              id="S2.SS1.p1.8.m8.2.3.2.3.2"
                              xref="S2.SS1.p1.8.m8.2.3.2.3.2.cmml">t</mi><mo
                              id="S2.SS1.p1.8.m8.2.3.2.3.1"
                              xref="S2.SS1.p1.8.m8.2.3.2.3.1.cmml">⁢</mo><mi
                              id="S2.SS1.p1.8.m8.2.3.2.3.3"
                              xref="S2.SS1.p1.8.m8.2.3.2.3.3.cmml">r</mi></mrow></msub><mo
                          id="S2.SS1.p1.8.m8.2.3.1"
                          xref="S2.SS1.p1.8.m8.2.3.1.cmml">⁢</mo><mrow
                          id="S2.SS1.p1.8.m8.2.3.3.2"
                          xref="S2.SS1.p1.8.m8.2.3.3.1.cmml"><mo
                            id="S2.SS1.p1.8.m8.2.3.3.2.1" stretchy="false"
                            xref="S2.SS1.p1.8.m8.2.3.3.1.cmml">(</mo><mi
                            id="S2.SS1.p1.8.m8.1.1"
                            xref="S2.SS1.p1.8.m8.1.1.cmml">X</mi><mo
                            id="S2.SS1.p1.8.m8.2.3.3.2.2"
                            xref="S2.SS1.p1.8.m8.2.3.3.1.cmml">,</mo><mi
                            id="S2.SS1.p1.8.m8.2.2"
                            xref="S2.SS1.p1.8.m8.2.2.cmml">Y</mi><mo
                            id="S2.SS1.p1.8.m8.2.3.3.2.3" stretchy="false"
                            xref="S2.SS1.p1.8.m8.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.8.m8.2b"><apply
                          id="S2.SS1.p1.8.m8.2.3.cmml"
                          xref="S2.SS1.p1.8.m8.2.3"><times
                            id="S2.SS1.p1.8.m8.2.3.1.cmml"
                            xref="S2.SS1.p1.8.m8.2.3.1"></times><apply
                            id="S2.SS1.p1.8.m8.2.3.2.cmml"
                            xref="S2.SS1.p1.8.m8.2.3.2"><csymbol cd="ambiguous"
                              id="S2.SS1.p1.8.m8.2.3.2.1.cmml"
                              xref="S2.SS1.p1.8.m8.2.3.2">subscript</csymbol><ci
                              id="S2.SS1.p1.8.m8.2.3.2.2.cmml"
                              xref="S2.SS1.p1.8.m8.2.3.2.2">𝑃</ci><apply
                              id="S2.SS1.p1.8.m8.2.3.2.3.cmml"
                              xref="S2.SS1.p1.8.m8.2.3.2.3"><times
                                id="S2.SS1.p1.8.m8.2.3.2.3.1.cmml"
                                xref="S2.SS1.p1.8.m8.2.3.2.3.1"></times><ci
                                id="S2.SS1.p1.8.m8.2.3.2.3.2.cmml"
                                xref="S2.SS1.p1.8.m8.2.3.2.3.2">𝑡</ci><ci
                                id="S2.SS1.p1.8.m8.2.3.2.3.3.cmml"
                                xref="S2.SS1.p1.8.m8.2.3.2.3.3">𝑟</ci></apply></apply><interval
                            closure="open" id="S2.SS1.p1.8.m8.2.3.3.1.cmml"
                            xref="S2.SS1.p1.8.m8.2.3.3.2"><ci
                              id="S2.SS1.p1.8.m8.1.1.cmml"
                              xref="S2.SS1.p1.8.m8.1.1">𝑋</ci><ci
                              id="S2.SS1.p1.8.m8.2.2.cmml"
                              xref="S2.SS1.p1.8.m8.2.2">𝑌</ci></interval></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.8.m8.2c">P_{tr}(X,Y)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.8.m8.2d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_r end_POSTSUBSCRIPT ( italic_X ,
                        italic_Y )</annotation></semantics></math>. The primary
                  goal is to find a model <math alttext="f_{\theta}^{*}"
                    class="ltx_Math" display="inline"
                    id="S2.SS1.p1.9.m9.1"><semantics
                      id="S2.SS1.p1.9.m9.1a"><msubsup id="S2.SS1.p1.9.m9.1.1"
                        xref="S2.SS1.p1.9.m9.1.1.cmml"><mi
                          id="S2.SS1.p1.9.m9.1.1.2.2"
                          xref="S2.SS1.p1.9.m9.1.1.2.2.cmml">f</mi><mi
                          id="S2.SS1.p1.9.m9.1.1.2.3"
                          xref="S2.SS1.p1.9.m9.1.1.2.3.cmml">θ</mi><mo
                          id="S2.SS1.p1.9.m9.1.1.3"
                          xref="S2.SS1.p1.9.m9.1.1.3.cmml">*</mo></msubsup><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply
                          id="S2.SS1.p1.9.m9.1.1.cmml"
                          xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous"
                            id="S2.SS1.p1.9.m9.1.1.1.cmml"
                            xref="S2.SS1.p1.9.m9.1.1">superscript</csymbol><apply
                            id="S2.SS1.p1.9.m9.1.1.2.cmml"
                            xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous"
                              id="S2.SS1.p1.9.m9.1.1.2.1.cmml"
                              xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci
                              id="S2.SS1.p1.9.m9.1.1.2.2.cmml"
                              xref="S2.SS1.p1.9.m9.1.1.2.2">𝑓</ci><ci
                              id="S2.SS1.p1.9.m9.1.1.2.3.cmml"
                              xref="S2.SS1.p1.9.m9.1.1.2.3">𝜃</ci></apply><times
                            id="S2.SS1.p1.9.m9.1.1.3.cmml"
                            xref="S2.SS1.p1.9.m9.1.1.3"></times></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p1.9.m9.1c">f_{\theta}^{*}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p1.9.m9.1d">italic_f start_POSTSUBSCRIPT
                        italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT *
                        end_POSTSUPERSCRIPT</annotation></semantics></math> that
                  exhibits optimal performance in the test distribution:</p>
              </div>
              <div class="ltx_para" id="S2.SS1.p2">
                <table class="ltx_equation ltx_eqn_table" id="S2.E1">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="f_{\theta}^{*}=\arg\min_{f_{\theta}}\mathop{\mathbb{E}}\limits_{X,Y\sim P_{te}%
}[\ell(f_{\theta}(X),Y)]" class="ltx_Math" display="block"
                          id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow
                              id="S2.E1.m1.5.5"
                              xref="S2.E1.m1.5.5.cmml"><msubsup
                                id="S2.E1.m1.5.5.3"
                                xref="S2.E1.m1.5.5.3.cmml"><mi
                                  id="S2.E1.m1.5.5.3.2.2"
                                  xref="S2.E1.m1.5.5.3.2.2.cmml">f</mi><mi
                                  id="S2.E1.m1.5.5.3.2.3"
                                  xref="S2.E1.m1.5.5.3.2.3.cmml">θ</mi><mo
                                  id="S2.E1.m1.5.5.3.3"
                                  xref="S2.E1.m1.5.5.3.3.cmml">*</mo></msubsup><mo
                                id="S2.E1.m1.5.5.2"
                                xref="S2.E1.m1.5.5.2.cmml">=</mo><mrow
                                id="S2.E1.m1.5.5.1"
                                xref="S2.E1.m1.5.5.1.cmml"><mrow
                                  id="S2.E1.m1.5.5.1.3"
                                  xref="S2.E1.m1.5.5.1.3.cmml"><mi
                                    id="S2.E1.m1.5.5.1.3.1"
                                    xref="S2.E1.m1.5.5.1.3.1.cmml">arg</mi><mo
                                    id="S2.E1.m1.5.5.1.3a" lspace="0.167em"
                                    xref="S2.E1.m1.5.5.1.3.cmml">⁡</mo><munder
                                    id="S2.E1.m1.5.5.1.3.2"
                                    xref="S2.E1.m1.5.5.1.3.2.cmml"><mi
                                      id="S2.E1.m1.5.5.1.3.2.2"
                                      xref="S2.E1.m1.5.5.1.3.2.2.cmml">min</mi><msub
                                      id="S2.E1.m1.5.5.1.3.2.3"
                                      xref="S2.E1.m1.5.5.1.3.2.3.cmml"><mi
                                        id="S2.E1.m1.5.5.1.3.2.3.2"
                                        xref="S2.E1.m1.5.5.1.3.2.3.2.cmml">f</mi><mi
                                        id="S2.E1.m1.5.5.1.3.2.3.3"
                                        xref="S2.E1.m1.5.5.1.3.2.3.3.cmml">θ</mi></msub></munder></mrow><mo
                                  id="S2.E1.m1.5.5.1.2" lspace="0.167em"
                                  xref="S2.E1.m1.5.5.1.2.cmml">⁢</mo><mrow
                                  id="S2.E1.m1.5.5.1.1"
                                  xref="S2.E1.m1.5.5.1.1.cmml"><munder
                                    id="S2.E1.m1.5.5.1.1.2"
                                    xref="S2.E1.m1.5.5.1.1.2.cmml"><mo
                                      id="S2.E1.m1.5.5.1.1.2.2"
                                      movablelimits="false" rspace="0em"
                                      xref="S2.E1.m1.5.5.1.1.2.2.cmml">𝔼</mo><mrow
                                      id="S2.E1.m1.2.2.2"
                                      xref="S2.E1.m1.2.2.2.cmml"><mrow
                                        id="S2.E1.m1.2.2.2.4.2"
                                        xref="S2.E1.m1.2.2.2.4.1.cmml"><mi
                                          id="S2.E1.m1.1.1.1.1"
                                          xref="S2.E1.m1.1.1.1.1.cmml">X</mi><mo
                                          id="S2.E1.m1.2.2.2.4.2.1"
                                          xref="S2.E1.m1.2.2.2.4.1.cmml">,</mo><mi
                                          id="S2.E1.m1.2.2.2.2"
                                          xref="S2.E1.m1.2.2.2.2.cmml">Y</mi></mrow><mo
                                        id="S2.E1.m1.2.2.2.3"
                                        xref="S2.E1.m1.2.2.2.3.cmml">∼</mo><msub
                                        id="S2.E1.m1.2.2.2.5"
                                        xref="S2.E1.m1.2.2.2.5.cmml"><mi
                                          id="S2.E1.m1.2.2.2.5.2"
                                          xref="S2.E1.m1.2.2.2.5.2.cmml">P</mi><mrow
                                          id="S2.E1.m1.2.2.2.5.3"
                                          xref="S2.E1.m1.2.2.2.5.3.cmml"><mi
                                            id="S2.E1.m1.2.2.2.5.3.2"
                                            xref="S2.E1.m1.2.2.2.5.3.2.cmml">t</mi><mo
                                            id="S2.E1.m1.2.2.2.5.3.1"
                                            xref="S2.E1.m1.2.2.2.5.3.1.cmml">⁢</mo><mi
                                            id="S2.E1.m1.2.2.2.5.3.3"
                                            xref="S2.E1.m1.2.2.2.5.3.3.cmml">e</mi></mrow></msub></mrow></munder><mrow
                                    id="S2.E1.m1.5.5.1.1.1.1"
                                    xref="S2.E1.m1.5.5.1.1.1.2.cmml"><mo
                                      id="S2.E1.m1.5.5.1.1.1.1.2"
                                      stretchy="false"
                                      xref="S2.E1.m1.5.5.1.1.1.2.1.cmml">[</mo><mrow
                                      id="S2.E1.m1.5.5.1.1.1.1.1"
                                      xref="S2.E1.m1.5.5.1.1.1.1.1.cmml"><mi
                                        id="S2.E1.m1.5.5.1.1.1.1.1.3"
                                        mathvariant="normal"
                                        xref="S2.E1.m1.5.5.1.1.1.1.1.3.cmml">ℓ</mi><mo
                                        id="S2.E1.m1.5.5.1.1.1.1.1.2"
                                        xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                        id="S2.E1.m1.5.5.1.1.1.1.1.1.1"
                                        xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml"><mo
                                          id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2"
                                          stretchy="false"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mrow
                                          id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub
                                            id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2"
                                            xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo
                                            id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1"
                                            xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow
                                            id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2"
                                            xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.1"
                                              stretchy="false"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mi
                                              id="S2.E1.m1.3.3"
                                              xref="S2.E1.m1.3.3.cmml">X</mi><mo
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.2"
                                              stretchy="false"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                          id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">,</mo><mi
                                          id="S2.E1.m1.4.4"
                                          xref="S2.E1.m1.4.4.cmml">Y</mi><mo
                                          id="S2.E1.m1.5.5.1.1.1.1.1.1.1.4"
                                          stretchy="false"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo
                                      id="S2.E1.m1.5.5.1.1.1.1.3"
                                      stretchy="false"
                                      xref="S2.E1.m1.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S2.E1.m1.5b"><apply
                                id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5"><eq
                                  id="S2.E1.m1.5.5.2.cmml"
                                  xref="S2.E1.m1.5.5.2"></eq><apply
                                  id="S2.E1.m1.5.5.3.cmml"
                                  xref="S2.E1.m1.5.5.3"><csymbol cd="ambiguous"
                                    id="S2.E1.m1.5.5.3.1.cmml"
                                    xref="S2.E1.m1.5.5.3">superscript</csymbol><apply
                                    id="S2.E1.m1.5.5.3.2.cmml"
                                    xref="S2.E1.m1.5.5.3"><csymbol
                                      cd="ambiguous"
                                      id="S2.E1.m1.5.5.3.2.1.cmml"
                                      xref="S2.E1.m1.5.5.3">subscript</csymbol><ci
                                      id="S2.E1.m1.5.5.3.2.2.cmml"
                                      xref="S2.E1.m1.5.5.3.2.2">𝑓</ci><ci
                                      id="S2.E1.m1.5.5.3.2.3.cmml"
                                      xref="S2.E1.m1.5.5.3.2.3">𝜃</ci></apply><times
                                    id="S2.E1.m1.5.5.3.3.cmml"
                                    xref="S2.E1.m1.5.5.3.3"></times></apply><apply
                                  id="S2.E1.m1.5.5.1.cmml"
                                  xref="S2.E1.m1.5.5.1"><times
                                    id="S2.E1.m1.5.5.1.2.cmml"
                                    xref="S2.E1.m1.5.5.1.2"></times><apply
                                    id="S2.E1.m1.5.5.1.3.cmml"
                                    xref="S2.E1.m1.5.5.1.3"><arg
                                      id="S2.E1.m1.5.5.1.3.1.cmml"
                                      xref="S2.E1.m1.5.5.1.3.1"></arg><apply
                                      id="S2.E1.m1.5.5.1.3.2.cmml"
                                      xref="S2.E1.m1.5.5.1.3.2"><csymbol
                                        cd="ambiguous"
                                        id="S2.E1.m1.5.5.1.3.2.1.cmml"
                                        xref="S2.E1.m1.5.5.1.3.2">subscript</csymbol><min
                                        id="S2.E1.m1.5.5.1.3.2.2.cmml"
                                        xref="S2.E1.m1.5.5.1.3.2.2"></min><apply
                                        id="S2.E1.m1.5.5.1.3.2.3.cmml"
                                        xref="S2.E1.m1.5.5.1.3.2.3"><csymbol
                                          cd="ambiguous"
                                          id="S2.E1.m1.5.5.1.3.2.3.1.cmml"
                                          xref="S2.E1.m1.5.5.1.3.2.3">subscript</csymbol><ci
                                          id="S2.E1.m1.5.5.1.3.2.3.2.cmml"
                                          xref="S2.E1.m1.5.5.1.3.2.3.2">𝑓</ci><ci
                                          id="S2.E1.m1.5.5.1.3.2.3.3.cmml"
                                          xref="S2.E1.m1.5.5.1.3.2.3.3">𝜃</ci></apply></apply></apply><apply
                                    id="S2.E1.m1.5.5.1.1.cmml"
                                    xref="S2.E1.m1.5.5.1.1"><apply
                                      id="S2.E1.m1.5.5.1.1.2.cmml"
                                      xref="S2.E1.m1.5.5.1.1.2"><csymbol
                                        cd="ambiguous"
                                        id="S2.E1.m1.5.5.1.1.2.1.cmml"
                                        xref="S2.E1.m1.5.5.1.1.2">subscript</csymbol><ci
                                        id="S2.E1.m1.5.5.1.1.2.2.cmml"
                                        xref="S2.E1.m1.5.5.1.1.2.2">𝔼</ci><apply
                                        id="S2.E1.m1.2.2.2.cmml"
                                        xref="S2.E1.m1.2.2.2"><csymbol
                                          cd="latexml"
                                          id="S2.E1.m1.2.2.2.3.cmml"
                                          xref="S2.E1.m1.2.2.2.3">similar-to</csymbol><list
                                          id="S2.E1.m1.2.2.2.4.1.cmml"
                                          xref="S2.E1.m1.2.2.2.4.2"><ci
                                            id="S2.E1.m1.1.1.1.1.cmml"
                                            xref="S2.E1.m1.1.1.1.1">𝑋</ci><ci
                                            id="S2.E1.m1.2.2.2.2.cmml"
                                            xref="S2.E1.m1.2.2.2.2">𝑌</ci></list><apply
                                          id="S2.E1.m1.2.2.2.5.cmml"
                                          xref="S2.E1.m1.2.2.2.5"><csymbol
                                            cd="ambiguous"
                                            id="S2.E1.m1.2.2.2.5.1.cmml"
                                            xref="S2.E1.m1.2.2.2.5">subscript</csymbol><ci
                                            id="S2.E1.m1.2.2.2.5.2.cmml"
                                            xref="S2.E1.m1.2.2.2.5.2">𝑃</ci><apply
                                            id="S2.E1.m1.2.2.2.5.3.cmml"
                                            xref="S2.E1.m1.2.2.2.5.3"><times
                                              id="S2.E1.m1.2.2.2.5.3.1.cmml"
                                              xref="S2.E1.m1.2.2.2.5.3.1"></times><ci
                                              id="S2.E1.m1.2.2.2.5.3.2.cmml"
                                              xref="S2.E1.m1.2.2.2.5.3.2">𝑡</ci><ci
                                              id="S2.E1.m1.2.2.2.5.3.3.cmml"
                                              xref="S2.E1.m1.2.2.2.5.3.3">𝑒</ci></apply></apply></apply></apply><apply
                                      id="S2.E1.m1.5.5.1.1.1.2.cmml"
                                      xref="S2.E1.m1.5.5.1.1.1.1"><csymbol
                                        cd="latexml"
                                        id="S2.E1.m1.5.5.1.1.1.2.1.cmml"
                                        xref="S2.E1.m1.5.5.1.1.1.1.2">delimited-[]</csymbol><apply
                                        id="S2.E1.m1.5.5.1.1.1.1.1.cmml"
                                        xref="S2.E1.m1.5.5.1.1.1.1.1"><times
                                          id="S2.E1.m1.5.5.1.1.1.1.1.2.cmml"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.2"></times><ci
                                          id="S2.E1.m1.5.5.1.1.1.1.1.3.cmml"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.3">ℓ</ci><interval
                                          closure="open"
                                          id="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml"
                                          xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"><apply
                                            id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"
                                            xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"><times
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1"></times><apply
                                              id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol
                                                cd="ambiguous"
                                                id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml"
                                                xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci
                                                id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml"
                                                xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci
                                                id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml"
                                                xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci
                                              id="S2.E1.m1.3.3.cmml"
                                              xref="S2.E1.m1.3.3">𝑋</ci></apply><ci
                                            id="S2.E1.m1.4.4.cmml"
                                            xref="S2.E1.m1.4.4">𝑌</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S2.E1.m1.5c">f_{\theta}^{*}=\arg\min_{f_{\theta}}\mathop{\mathbb{E}}\limits_{X,Y\sim
                              P_{te}%
                              }[\ell(f_{\theta}(X),Y)]</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S2.E1.m1.5d">italic_f start_POSTSUBSCRIPT
                              italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT *
                              end_POSTSUPERSCRIPT = roman_arg roman_min
                              start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT
                              italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT
                              blackboard_E start_POSTSUBSCRIPT italic_X ,
                              italic_Y ∼ italic_P start_POSTSUBSCRIPT italic_t
                              italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT [
                              roman_ℓ ( italic_f start_POSTSUBSCRIPT italic_θ
                              end_POSTSUBSCRIPT ( italic_X ) , italic_Y )
                              ]</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
                    </tr></tbody>
                </table>
              </div>
              <div class="ltx_para" id="S2.SS1.p3">
                <p class="ltx_p" id="S2.SS1.p3.2">When <math
                    alttext="P_{tr}(X,Y)=P_{te}(X,Y)" class="ltx_Math"
                    display="inline" id="S2.SS1.p3.1.m1.4"><semantics
                      id="S2.SS1.p3.1.m1.4a"><mrow id="S2.SS1.p3.1.m1.4.5"
                        xref="S2.SS1.p3.1.m1.4.5.cmml"><mrow
                          id="S2.SS1.p3.1.m1.4.5.2"
                          xref="S2.SS1.p3.1.m1.4.5.2.cmml"><msub
                            id="S2.SS1.p3.1.m1.4.5.2.2"
                            xref="S2.SS1.p3.1.m1.4.5.2.2.cmml"><mi
                              id="S2.SS1.p3.1.m1.4.5.2.2.2"
                              xref="S2.SS1.p3.1.m1.4.5.2.2.2.cmml">P</mi><mrow
                              id="S2.SS1.p3.1.m1.4.5.2.2.3"
                              xref="S2.SS1.p3.1.m1.4.5.2.2.3.cmml"><mi
                                id="S2.SS1.p3.1.m1.4.5.2.2.3.2"
                                xref="S2.SS1.p3.1.m1.4.5.2.2.3.2.cmml">t</mi><mo
                                id="S2.SS1.p3.1.m1.4.5.2.2.3.1"
                                xref="S2.SS1.p3.1.m1.4.5.2.2.3.1.cmml">⁢</mo><mi
                                id="S2.SS1.p3.1.m1.4.5.2.2.3.3"
                                xref="S2.SS1.p3.1.m1.4.5.2.2.3.3.cmml">r</mi></mrow></msub><mo
                            id="S2.SS1.p3.1.m1.4.5.2.1"
                            xref="S2.SS1.p3.1.m1.4.5.2.1.cmml">⁢</mo><mrow
                            id="S2.SS1.p3.1.m1.4.5.2.3.2"
                            xref="S2.SS1.p3.1.m1.4.5.2.3.1.cmml"><mo
                              id="S2.SS1.p3.1.m1.4.5.2.3.2.1" stretchy="false"
                              xref="S2.SS1.p3.1.m1.4.5.2.3.1.cmml">(</mo><mi
                              id="S2.SS1.p3.1.m1.1.1"
                              xref="S2.SS1.p3.1.m1.1.1.cmml">X</mi><mo
                              id="S2.SS1.p3.1.m1.4.5.2.3.2.2"
                              xref="S2.SS1.p3.1.m1.4.5.2.3.1.cmml">,</mo><mi
                              id="S2.SS1.p3.1.m1.2.2"
                              xref="S2.SS1.p3.1.m1.2.2.cmml">Y</mi><mo
                              id="S2.SS1.p3.1.m1.4.5.2.3.2.3" stretchy="false"
                              xref="S2.SS1.p3.1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo
                          id="S2.SS1.p3.1.m1.4.5.1"
                          xref="S2.SS1.p3.1.m1.4.5.1.cmml">=</mo><mrow
                          id="S2.SS1.p3.1.m1.4.5.3"
                          xref="S2.SS1.p3.1.m1.4.5.3.cmml"><msub
                            id="S2.SS1.p3.1.m1.4.5.3.2"
                            xref="S2.SS1.p3.1.m1.4.5.3.2.cmml"><mi
                              id="S2.SS1.p3.1.m1.4.5.3.2.2"
                              xref="S2.SS1.p3.1.m1.4.5.3.2.2.cmml">P</mi><mrow
                              id="S2.SS1.p3.1.m1.4.5.3.2.3"
                              xref="S2.SS1.p3.1.m1.4.5.3.2.3.cmml"><mi
                                id="S2.SS1.p3.1.m1.4.5.3.2.3.2"
                                xref="S2.SS1.p3.1.m1.4.5.3.2.3.2.cmml">t</mi><mo
                                id="S2.SS1.p3.1.m1.4.5.3.2.3.1"
                                xref="S2.SS1.p3.1.m1.4.5.3.2.3.1.cmml">⁢</mo><mi
                                id="S2.SS1.p3.1.m1.4.5.3.2.3.3"
                                xref="S2.SS1.p3.1.m1.4.5.3.2.3.3.cmml">e</mi></mrow></msub><mo
                            id="S2.SS1.p3.1.m1.4.5.3.1"
                            xref="S2.SS1.p3.1.m1.4.5.3.1.cmml">⁢</mo><mrow
                            id="S2.SS1.p3.1.m1.4.5.3.3.2"
                            xref="S2.SS1.p3.1.m1.4.5.3.3.1.cmml"><mo
                              id="S2.SS1.p3.1.m1.4.5.3.3.2.1" stretchy="false"
                              xref="S2.SS1.p3.1.m1.4.5.3.3.1.cmml">(</mo><mi
                              id="S2.SS1.p3.1.m1.3.3"
                              xref="S2.SS1.p3.1.m1.3.3.cmml">X</mi><mo
                              id="S2.SS1.p3.1.m1.4.5.3.3.2.2"
                              xref="S2.SS1.p3.1.m1.4.5.3.3.1.cmml">,</mo><mi
                              id="S2.SS1.p3.1.m1.4.4"
                              xref="S2.SS1.p3.1.m1.4.4.cmml">Y</mi><mo
                              id="S2.SS1.p3.1.m1.4.5.3.3.2.3" stretchy="false"
                              xref="S2.SS1.p3.1.m1.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p3.1.m1.4b"><apply
                          id="S2.SS1.p3.1.m1.4.5.cmml"
                          xref="S2.SS1.p3.1.m1.4.5"><eq
                            id="S2.SS1.p3.1.m1.4.5.1.cmml"
                            xref="S2.SS1.p3.1.m1.4.5.1"></eq><apply
                            id="S2.SS1.p3.1.m1.4.5.2.cmml"
                            xref="S2.SS1.p3.1.m1.4.5.2"><times
                              id="S2.SS1.p3.1.m1.4.5.2.1.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.2.1"></times><apply
                              id="S2.SS1.p3.1.m1.4.5.2.2.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.2.2"><csymbol
                                cd="ambiguous"
                                id="S2.SS1.p3.1.m1.4.5.2.2.1.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.2.2">subscript</csymbol><ci
                                id="S2.SS1.p3.1.m1.4.5.2.2.2.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.2.2.2">𝑃</ci><apply
                                id="S2.SS1.p3.1.m1.4.5.2.2.3.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.2.2.3"><times
                                  id="S2.SS1.p3.1.m1.4.5.2.2.3.1.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.2.2.3.1"></times><ci
                                  id="S2.SS1.p3.1.m1.4.5.2.2.3.2.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.2.2.3.2">𝑡</ci><ci
                                  id="S2.SS1.p3.1.m1.4.5.2.2.3.3.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.2.2.3.3">𝑟</ci></apply></apply><interval
                              closure="open" id="S2.SS1.p3.1.m1.4.5.2.3.1.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.2.3.2"><ci
                                id="S2.SS1.p3.1.m1.1.1.cmml"
                                xref="S2.SS1.p3.1.m1.1.1">𝑋</ci><ci
                                id="S2.SS1.p3.1.m1.2.2.cmml"
                                xref="S2.SS1.p3.1.m1.2.2">𝑌</ci></interval></apply><apply
                            id="S2.SS1.p3.1.m1.4.5.3.cmml"
                            xref="S2.SS1.p3.1.m1.4.5.3"><times
                              id="S2.SS1.p3.1.m1.4.5.3.1.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.3.1"></times><apply
                              id="S2.SS1.p3.1.m1.4.5.3.2.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.3.2"><csymbol
                                cd="ambiguous"
                                id="S2.SS1.p3.1.m1.4.5.3.2.1.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.3.2">subscript</csymbol><ci
                                id="S2.SS1.p3.1.m1.4.5.3.2.2.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.3.2.2">𝑃</ci><apply
                                id="S2.SS1.p3.1.m1.4.5.3.2.3.cmml"
                                xref="S2.SS1.p3.1.m1.4.5.3.2.3"><times
                                  id="S2.SS1.p3.1.m1.4.5.3.2.3.1.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.3.2.3.1"></times><ci
                                  id="S2.SS1.p3.1.m1.4.5.3.2.3.2.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.3.2.3.2">𝑡</ci><ci
                                  id="S2.SS1.p3.1.m1.4.5.3.2.3.3.cmml"
                                  xref="S2.SS1.p3.1.m1.4.5.3.2.3.3">𝑒</ci></apply></apply><interval
                              closure="open" id="S2.SS1.p3.1.m1.4.5.3.3.1.cmml"
                              xref="S2.SS1.p3.1.m1.4.5.3.3.2"><ci
                                id="S2.SS1.p3.1.m1.3.3.cmml"
                                xref="S2.SS1.p3.1.m1.3.3">𝑋</ci><ci
                                id="S2.SS1.p3.1.m1.4.4.cmml"
                                xref="S2.SS1.p3.1.m1.4.4">𝑌</ci></interval></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p3.1.m1.4c">P_{tr}(X,Y)=P_{te}(X,Y)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p3.1.m1.4d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_r end_POSTSUBSCRIPT ( italic_X ,
                        italic_Y ) = italic_P start_POSTSUBSCRIPT italic_t
                        italic_e end_POSTSUBSCRIPT ( italic_X , italic_Y
                        )</annotation></semantics></math>, the IID assumption
                  holds, it becomes a standard learning problem. With the IID
                  assumption, Empirical Risk Minimization (ERM) <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib38"
                      title>38</a>]</cite>, which directly minimizes the average
                  loss of the training samples, can achieve a good performance.
                  Conversely, when <math alttext="P_{tr}(X,Y)\neq P_{te}(X,Y)"
                    class="ltx_Math" display="inline"
                    id="S2.SS1.p3.2.m2.4"><semantics
                      id="S2.SS1.p3.2.m2.4a"><mrow id="S2.SS1.p3.2.m2.4.5"
                        xref="S2.SS1.p3.2.m2.4.5.cmml"><mrow
                          id="S2.SS1.p3.2.m2.4.5.2"
                          xref="S2.SS1.p3.2.m2.4.5.2.cmml"><msub
                            id="S2.SS1.p3.2.m2.4.5.2.2"
                            xref="S2.SS1.p3.2.m2.4.5.2.2.cmml"><mi
                              id="S2.SS1.p3.2.m2.4.5.2.2.2"
                              xref="S2.SS1.p3.2.m2.4.5.2.2.2.cmml">P</mi><mrow
                              id="S2.SS1.p3.2.m2.4.5.2.2.3"
                              xref="S2.SS1.p3.2.m2.4.5.2.2.3.cmml"><mi
                                id="S2.SS1.p3.2.m2.4.5.2.2.3.2"
                                xref="S2.SS1.p3.2.m2.4.5.2.2.3.2.cmml">t</mi><mo
                                id="S2.SS1.p3.2.m2.4.5.2.2.3.1"
                                xref="S2.SS1.p3.2.m2.4.5.2.2.3.1.cmml">⁢</mo><mi
                                id="S2.SS1.p3.2.m2.4.5.2.2.3.3"
                                xref="S2.SS1.p3.2.m2.4.5.2.2.3.3.cmml">r</mi></mrow></msub><mo
                            id="S2.SS1.p3.2.m2.4.5.2.1"
                            xref="S2.SS1.p3.2.m2.4.5.2.1.cmml">⁢</mo><mrow
                            id="S2.SS1.p3.2.m2.4.5.2.3.2"
                            xref="S2.SS1.p3.2.m2.4.5.2.3.1.cmml"><mo
                              id="S2.SS1.p3.2.m2.4.5.2.3.2.1" stretchy="false"
                              xref="S2.SS1.p3.2.m2.4.5.2.3.1.cmml">(</mo><mi
                              id="S2.SS1.p3.2.m2.1.1"
                              xref="S2.SS1.p3.2.m2.1.1.cmml">X</mi><mo
                              id="S2.SS1.p3.2.m2.4.5.2.3.2.2"
                              xref="S2.SS1.p3.2.m2.4.5.2.3.1.cmml">,</mo><mi
                              id="S2.SS1.p3.2.m2.2.2"
                              xref="S2.SS1.p3.2.m2.2.2.cmml">Y</mi><mo
                              id="S2.SS1.p3.2.m2.4.5.2.3.2.3" stretchy="false"
                              xref="S2.SS1.p3.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo
                          id="S2.SS1.p3.2.m2.4.5.1"
                          xref="S2.SS1.p3.2.m2.4.5.1.cmml">≠</mo><mrow
                          id="S2.SS1.p3.2.m2.4.5.3"
                          xref="S2.SS1.p3.2.m2.4.5.3.cmml"><msub
                            id="S2.SS1.p3.2.m2.4.5.3.2"
                            xref="S2.SS1.p3.2.m2.4.5.3.2.cmml"><mi
                              id="S2.SS1.p3.2.m2.4.5.3.2.2"
                              xref="S2.SS1.p3.2.m2.4.5.3.2.2.cmml">P</mi><mrow
                              id="S2.SS1.p3.2.m2.4.5.3.2.3"
                              xref="S2.SS1.p3.2.m2.4.5.3.2.3.cmml"><mi
                                id="S2.SS1.p3.2.m2.4.5.3.2.3.2"
                                xref="S2.SS1.p3.2.m2.4.5.3.2.3.2.cmml">t</mi><mo
                                id="S2.SS1.p3.2.m2.4.5.3.2.3.1"
                                xref="S2.SS1.p3.2.m2.4.5.3.2.3.1.cmml">⁢</mo><mi
                                id="S2.SS1.p3.2.m2.4.5.3.2.3.3"
                                xref="S2.SS1.p3.2.m2.4.5.3.2.3.3.cmml">e</mi></mrow></msub><mo
                            id="S2.SS1.p3.2.m2.4.5.3.1"
                            xref="S2.SS1.p3.2.m2.4.5.3.1.cmml">⁢</mo><mrow
                            id="S2.SS1.p3.2.m2.4.5.3.3.2"
                            xref="S2.SS1.p3.2.m2.4.5.3.3.1.cmml"><mo
                              id="S2.SS1.p3.2.m2.4.5.3.3.2.1" stretchy="false"
                              xref="S2.SS1.p3.2.m2.4.5.3.3.1.cmml">(</mo><mi
                              id="S2.SS1.p3.2.m2.3.3"
                              xref="S2.SS1.p3.2.m2.3.3.cmml">X</mi><mo
                              id="S2.SS1.p3.2.m2.4.5.3.3.2.2"
                              xref="S2.SS1.p3.2.m2.4.5.3.3.1.cmml">,</mo><mi
                              id="S2.SS1.p3.2.m2.4.4"
                              xref="S2.SS1.p3.2.m2.4.4.cmml">Y</mi><mo
                              id="S2.SS1.p3.2.m2.4.5.3.3.2.3" stretchy="false"
                              xref="S2.SS1.p3.2.m2.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S2.SS1.p3.2.m2.4b"><apply
                          id="S2.SS1.p3.2.m2.4.5.cmml"
                          xref="S2.SS1.p3.2.m2.4.5"><neq
                            id="S2.SS1.p3.2.m2.4.5.1.cmml"
                            xref="S2.SS1.p3.2.m2.4.5.1"></neq><apply
                            id="S2.SS1.p3.2.m2.4.5.2.cmml"
                            xref="S2.SS1.p3.2.m2.4.5.2"><times
                              id="S2.SS1.p3.2.m2.4.5.2.1.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.2.1"></times><apply
                              id="S2.SS1.p3.2.m2.4.5.2.2.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.2.2"><csymbol
                                cd="ambiguous"
                                id="S2.SS1.p3.2.m2.4.5.2.2.1.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.2.2">subscript</csymbol><ci
                                id="S2.SS1.p3.2.m2.4.5.2.2.2.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.2.2.2">𝑃</ci><apply
                                id="S2.SS1.p3.2.m2.4.5.2.2.3.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.2.2.3"><times
                                  id="S2.SS1.p3.2.m2.4.5.2.2.3.1.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.2.2.3.1"></times><ci
                                  id="S2.SS1.p3.2.m2.4.5.2.2.3.2.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.2.2.3.2">𝑡</ci><ci
                                  id="S2.SS1.p3.2.m2.4.5.2.2.3.3.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.2.2.3.3">𝑟</ci></apply></apply><interval
                              closure="open" id="S2.SS1.p3.2.m2.4.5.2.3.1.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.2.3.2"><ci
                                id="S2.SS1.p3.2.m2.1.1.cmml"
                                xref="S2.SS1.p3.2.m2.1.1">𝑋</ci><ci
                                id="S2.SS1.p3.2.m2.2.2.cmml"
                                xref="S2.SS1.p3.2.m2.2.2">𝑌</ci></interval></apply><apply
                            id="S2.SS1.p3.2.m2.4.5.3.cmml"
                            xref="S2.SS1.p3.2.m2.4.5.3"><times
                              id="S2.SS1.p3.2.m2.4.5.3.1.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.3.1"></times><apply
                              id="S2.SS1.p3.2.m2.4.5.3.2.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.3.2"><csymbol
                                cd="ambiguous"
                                id="S2.SS1.p3.2.m2.4.5.3.2.1.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.3.2">subscript</csymbol><ci
                                id="S2.SS1.p3.2.m2.4.5.3.2.2.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.3.2.2">𝑃</ci><apply
                                id="S2.SS1.p3.2.m2.4.5.3.2.3.cmml"
                                xref="S2.SS1.p3.2.m2.4.5.3.2.3"><times
                                  id="S2.SS1.p3.2.m2.4.5.3.2.3.1.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.3.2.3.1"></times><ci
                                  id="S2.SS1.p3.2.m2.4.5.3.2.3.2.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.3.2.3.2">𝑡</ci><ci
                                  id="S2.SS1.p3.2.m2.4.5.3.2.3.3.cmml"
                                  xref="S2.SS1.p3.2.m2.4.5.3.2.3.3">𝑒</ci></apply></apply><interval
                              closure="open" id="S2.SS1.p3.2.m2.4.5.3.3.1.cmml"
                              xref="S2.SS1.p3.2.m2.4.5.3.3.2"><ci
                                id="S2.SS1.p3.2.m2.3.3.cmml"
                                xref="S2.SS1.p3.2.m2.3.3">𝑋</ci><ci
                                id="S2.SS1.p3.2.m2.4.4.cmml"
                                xref="S2.SS1.p3.2.m2.4.4">𝑌</ci></interval></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S2.SS1.p3.2.m2.4c">P_{tr}(X,Y)\neq
                        P_{te}(X,Y)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S2.SS1.p3.2.m2.4d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_r end_POSTSUBSCRIPT ( italic_X ,
                        italic_Y ) ≠ italic_P start_POSTSUBSCRIPT italic_t
                        italic_e end_POSTSUBSCRIPT ( italic_X , italic_Y
                        )</annotation></semantics></math>, a distribution shift
                  occurs, transforming it into an OOD generalization problem. In
                  such instances, ERM may fail severely in the face of
                  distribution shifts <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib39"
                      title>39</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib40"
                      title>40</a>]</cite>.
                  It is crucial to emphasize that assumptions and restrictions
                  regarding the types and degrees of distribution shifts need to
                  be made. On one hand, it is obviously impossible for any model
                  to generalize when test distribution bears no resemblance at
                  all to training distribution. On the other hand, even for
                  reasonable and solvable distribution shifts, it is hard for a
                  model to address all of them simultaneously.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S2.SS2">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">2.2 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S2.SS2.1.1">Categorization of OOD Evaluation</span>
              </h3>
              <div class="ltx_para" id="S2.SS2.p1">
                <p class="ltx_p" id="S2.SS2.p1.1">It is difficult to define OOD
                  evaluation mathematically since the evaluation is complex and
                  can be carried out in various forms. It could be a prescribed
                  protocol, a quantitative metric, or a predictive algorithm.
                  Despite this, still we make an organized categorization of
                  current works related to OOD evaluation based on the
                  requirement for OOD test data: OOD performance testing, OOD
                  performance prediction, and OOD intrinsic property
                  characterization. Each of these paradigms represents a unique
                  facet of OOD evaluation. The overall framework is shown in
                  Figure <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#S2.F1"
                    title="Figure 1 ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                      class="ltx_text ltx_ref_tag">1</span></a>.</p>
              </div>
              <section class="ltx_paragraph" id="S2.SS2.SSS0.Px1">
                <h5
                  class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">OOD
                  Performance Testing</h5>
                <div class="ltx_para" id="S2.SS2.SSS0.Px1.p1">
                  <p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.1">The OOD performance
                    testing paradigm involves the evaluation of models when
                    labeled test data is available. While the operation of <span
                      class="ltx_text ltx_font_italic"
                      id="S2.SS2.SSS0.Px1.p1.1.1">testing</span> a model on an
                    OOD dataset seems rather straightforward, the intricacies
                    lie in the evaluation protocol and the underlying design
                    principles, e.g. how to generate distribution shifts or
                    divide the dataset into distinct environments for various
                    data types and tasks, and how to mitigate unfair comparisons
                    stemming from oracle model selection as discussed by
                    Gulrajani et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                        title>18</a>]</cite>.
                    Moreover, not only do we want to test how well models
                    perform, but also we seek to comprehend the reasons behind a
                    model’s performance when confronted with the given
                    distribution shift. This deeper understanding allows us to
                    provide insights that can inform future algorithmic
                    developments or non-algorithmic operations, such as data
                    collection efforts targeting specific groups or attributes
                    with the aim of enhancing OOD generalization <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                        title>33</a>]</cite>.</p>
                </div>
              </section>
              <section class="ltx_paragraph" id="S2.SS2.SSS0.Px2">
                <h5
                  class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">OOD
                  Performance Prediction</h5>
                <div class="ltx_para" id="S2.SS2.SSS0.Px2.p1">
                  <p class="ltx_p" id="S2.SS2.SSS0.Px2.p1.1">In practice,
                    obtaining labeled OOD test data is often a formidable
                    challenge. It is a common case that only unlabeled test data
                    is available. Under this circumstance, we resort to OOD
                    performance prediction as a viable strategy to select the
                    best model or determine the usability of a given model with
                    the help of unlabeled test data.
                    Within this paradigm, researchers employ various strategies.
                    Some rely solely on properties of model output on the given
                    test data, e.g. model confidence <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib41"
                        title>41</a>]</cite>, without access to training data.
                    Others adopt different approaches by harnessing information
                    from the training data. They achieve this by characterizing
                    the distribution discrepancy between the unlabeled training
                    data and test data in a certain space induced by the
                    evaluated model <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib42"
                        title>42</a>]</cite>, or calculating model agreement
                    <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib43"
                        title>43</a>]</cite> as a means of predicting test
                    performance.</p>
                </div>
                <figure class="ltx_figure" id="S2.F2"><img
                    alt="Refer to caption"
                    class="ltx_graphics ltx_centering ltx_img_landscape"
                    height="116" id="S2.F2.g1"
                    src="extracted/5446353/figure/causal_graphs.png"
                    width="598" />
                  <figcaption class="ltx_caption ltx_centering"><span
                      class="ltx_tag ltx_tag_figure">Figure 2: </span>Common
                    types of causal graphs when generating synthetic datasets.
                    Image extracted from <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib44"
                        title>44</a>]</cite>. </figcaption>
                </figure>
              </section>
              <section class="ltx_paragraph" id="S2.SS2.SSS0.Px3">
                <h5
                  class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">OOD
                  Intrinsic Property Characterization</h5>
                <div class="ltx_para" id="S2.SS2.SSS0.Px3.p1">
                  <p class="ltx_p" id="S2.SS2.SSS0.Px3.p1.1">When there is no
                    test data available, OOD intrinsic property characterization
                    tries to seek and delineate the inherent properties of
                    models or training data that underpin OOD generalization.
                    Current works have delved into properties such as
                    distributional robustness <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib45"
                        title>45</a>]</cite>, stability <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib46"
                        title>46</a>]</cite>, invariance <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib47"
                        title>47</a>]</cite>, and flatness <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib48"
                        title>48</a>]</cite>.
                    These properties are closely connected with contemporary OOD
                    generalization algorithms. For instance, distributional
                    robustness is a direct derivative of DRO <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib49"
                        title>49</a>]</cite>, invariance aligns with invariant
                    learning <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                        title>22</a>]</cite>, and flatness intersects with
                    flatness-aware optimizers <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib50"
                        title>50</a>]</cite>.
                    It is worth noting that this pursuit is generally more
                    challenging in the absence of test data, but it potentially
                    probes deeper into the core essence of OOD
                    generalization.</p>
                </div>
                <div class="ltx_para" id="S2.SS2.SSS0.Px3.p2">
                  <p class="ltx_p" id="S2.SS2.SSS0.Px3.p2.1">In the subsequent
                    sections, we conduct a systematic review of these
                    studies.</p>
                </div>
              </section>
            </section>
          </section>
          <section class="ltx_section" id="S3">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">3 </span><span
                class="ltx_text ltx_font_smallcaps" id="S3.1.1">OOD performance
                testing</span>
            </h2>
            <div class="ltx_para" id="S3.p1">
              <p class="ltx_p" id="S3.p1.1">It is never a trivial problem to
                design the OOD performance testing procedure concerning a
                labeled dataset. For ID generalization tasks, given a labeled
                dataset, directly splitting it randomly into a training set and
                a test set will be reasonable enough. But for OOD
                generalization, many questions arise that require careful
                consideration.
                If there is no given dataset, how should we generate a labeled
                synthetic dataset from scratch to simulate a specific type of
                distribution shift?
                If there is a given dataset, how should we artificially generate
                a distribution shift or divide the dataset into multiple
                environments according to the existing distribution shift?
                After acquiring the dataset and environment partitions, how can
                we mitigate the potential possibility of test data information
                leakage resulting from pretraining <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib36"
                    title>36</a>]</cite> and oracle model selection <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                    title>18</a>]</cite>?
                Furthermore, once we have tested the model’s performance on the
                labeled dataset, how should we analyze this performance
                effectively?
                Numerous issues need to be resolved in terms of OOD performance
                testing.
                In this section, we will introduce current OOD datasets or
                benchmarks along with their underlying design principles, and
                the existing methods to analyze the performance and distribution
                shifts.</p>
            </div>
            <section class="ltx_subsection" id="S3.SS1">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">3.1 </span><span
                  class="ltx_text ltx_font_italic" id="S3.SS1.1.1">Designing
                  Datasets and Benchmarks</span>
              </h3>
              <div class="ltx_para" id="S3.SS1.p1">
                <p class="ltx_p" id="S3.SS1.p1.1">In this section, we begin by
                  categorically reviewing various types of OOD datasets
                  respectively. Then we shift our focus to benchmarks composed
                  of multiple datasets along with their protocols.</p>
              </div>
              <section class="ltx_subsubsection" id="S3.SS1.SSS1">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.1
                  </span>Synthetic Datasets</h4>
                <div class="ltx_para" id="S3.SS1.SSS1.p1">
                  <p class="ltx_p" id="S3.SS1.SSS1.p1.1">Synthetic data is
                    commonly exploited to assess an OOD method’s effectiveness
                    towards the targeted distribution shift. This involves the
                    creation of an ideal environment through artificially
                    designed data distributions.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS1.p2">
                  <p class="ltx_p" id="S3.SS1.SSS1.p2.13">In general, a
                    synthetic dataset is simulated according to a predesignated
                    causal (bayesian) graph <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib51"
                        title>51</a>]</cite> which describes the data generation
                    process under the prospect of potential distribution shifts.
                    As illustrated in Figure. <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S2.F2"
                      title="Figure 2 ‣ OOD Performance Prediction ‣ 2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_tag">2</span></a>, distribution
                    shifts are induced by the directed edge connecting the
                    environment variable <math alttext="E" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics
                        id="S3.SS1.SSS1.p2.1.m1.1a"><mi
                          id="S3.SS1.SSS1.p2.1.m1.1.1"
                          xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">E</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.1.m1.1b"><ci
                            id="S3.SS1.SSS1.p2.1.m1.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.1.m1.1.1">𝐸</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.1.m1.1c">E</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.1.m1.1d">italic_E</annotation></semantics></math>
                    with the covariates <math alttext="X" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p2.2.m2.1"><semantics
                        id="S3.SS1.SSS1.p2.2.m2.1a"><mi
                          id="S3.SS1.SSS1.p2.2.m2.1.1"
                          xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">X</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.2.m2.1b"><ci
                            id="S3.SS1.SSS1.p2.2.m2.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.2.m2.1.1">𝑋</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.2.m2.1c">X</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.2.m2.1d">italic_X</annotation></semantics></math>
                    and the target <math alttext="Y" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p2.3.m3.1"><semantics
                        id="S3.SS1.SSS1.p2.3.m3.1a"><mi
                          id="S3.SS1.SSS1.p2.3.m3.1.1"
                          xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.3.m3.1b"><ci
                            id="S3.SS1.SSS1.p2.3.m3.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.3.m3.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.3.m3.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.3.m3.1d">italic_Y</annotation></semantics></math>.
                    The covariates <math alttext="X" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p2.4.m4.1"><semantics
                        id="S3.SS1.SSS1.p2.4.m4.1a"><mi
                          id="S3.SS1.SSS1.p2.4.m4.1.1"
                          xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml">X</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.4.m4.1b"><ci
                            id="S3.SS1.SSS1.p2.4.m4.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.4.m4.1.1">𝑋</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.4.m4.1c">X</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.4.m4.1d">italic_X</annotation></semantics></math>
                    can be decomposed into two distinct components: an invariant
                    component denoted as <math alttext="X_{inv}"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.5.m5.1"><semantics
                        id="S3.SS1.SSS1.p2.5.m5.1a"><msub
                          id="S3.SS1.SSS1.p2.5.m5.1.1"
                          xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.5.m5.1.1.2"
                            xref="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.5.m5.1.1.3"
                            xref="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.1a"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.4"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.5.m5.1b"><apply
                            id="S3.SS1.SSS1.p2.5.m5.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.5.m5.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.5.m5.1.1.3"><times
                                id="S3.SS1.SSS1.p2.5.m5.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.5.m5.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.5.m5.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.5.m5.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p2.5.m5.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.5.m5.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p2.5.m5.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p2.5.m5.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.5.m5.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.5.m5.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math> and
                    a spurious component represented by <math alttext="X_{sp}"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.6.m6.1"><semantics
                        id="S3.SS1.SSS1.p2.6.m6.1a"><msub
                          id="S3.SS1.SSS1.p2.6.m6.1.1"
                          xref="S3.SS1.SSS1.p2.6.m6.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.6.m6.1.1.2"
                            xref="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.6.m6.1.1.3"
                            xref="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.6.m6.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1.3.2.cmml">s</mi><mo
                              id="S3.SS1.SSS1.p2.6.m6.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.6.m6.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.6.m6.1b"><apply
                            id="S3.SS1.SSS1.p2.6.m6.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.6.m6.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p2.6.m6.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.6.m6.1.1.3"><times
                                id="S3.SS1.SSS1.p2.6.m6.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.6.m6.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.6.m6.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.6.m6.1.1.3.2">𝑠</ci><ci
                                id="S3.SS1.SSS1.p2.6.m6.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.6.m6.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.6.m6.1c">X_{sp}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.6.m6.1d">italic_X
                          start_POSTSUBSCRIPT italic_s italic_p
                          end_POSTSUBSCRIPT</annotation></semantics></math>,
                    considering their respective associations with the target
                    variable <math alttext="Y" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.7.m7.1"><semantics
                        id="S3.SS1.SSS1.p2.7.m7.1a"><mi
                          id="S3.SS1.SSS1.p2.7.m7.1.1"
                          xref="S3.SS1.SSS1.p2.7.m7.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.7.m7.1b"><ci
                            id="S3.SS1.SSS1.p2.7.m7.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.7.m7.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.7.m7.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.7.m7.1d">italic_Y</annotation></semantics></math>.
                    Intuitively, a predictor relying on an invariant feature
                    <math alttext="X_{inv}" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.8.m8.1"><semantics
                        id="S3.SS1.SSS1.p2.8.m8.1a"><msub
                          id="S3.SS1.SSS1.p2.8.m8.1.1"
                          xref="S3.SS1.SSS1.p2.8.m8.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.8.m8.1.1.2"
                            xref="S3.SS1.SSS1.p2.8.m8.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.8.m8.1.1.3"
                            xref="S3.SS1.SSS1.p2.8.m8.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.1a"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.4"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.8.m8.1b"><apply
                            id="S3.SS1.SSS1.p2.8.m8.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.8.m8.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p2.8.m8.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.8.m8.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.8.m8.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.8.m8.1.1.3"><times
                                id="S3.SS1.SSS1.p2.8.m8.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.8.m8.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.8.m8.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.8.m8.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p2.8.m8.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.8.m8.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p2.8.m8.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p2.8.m8.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.8.m8.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.8.m8.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math>
                    achieves consistent performance across environments while
                    predicting with a spurious feature <math alttext="X_{sp}"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.9.m9.1"><semantics
                        id="S3.SS1.SSS1.p2.9.m9.1a"><msub
                          id="S3.SS1.SSS1.p2.9.m9.1.1"
                          xref="S3.SS1.SSS1.p2.9.m9.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.9.m9.1.1.2"
                            xref="S3.SS1.SSS1.p2.9.m9.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.9.m9.1.1.3"
                            xref="S3.SS1.SSS1.p2.9.m9.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.9.m9.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1.3.2.cmml">s</mi><mo
                              id="S3.SS1.SSS1.p2.9.m9.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.9.m9.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.9.m9.1b"><apply
                            id="S3.SS1.SSS1.p2.9.m9.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.9.m9.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.9.m9.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.9.m9.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.9.m9.1.1.3"><times
                                id="S3.SS1.SSS1.p2.9.m9.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.9.m9.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.9.m9.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.9.m9.1.1.3.2">𝑠</ci><ci
                                id="S3.SS1.SSS1.p2.9.m9.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.9.m9.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.9.m9.1c">X_{sp}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.9.m9.1d">italic_X
                          start_POSTSUBSCRIPT italic_s italic_p
                          end_POSTSUBSCRIPT</annotation></semantics></math>
                    leads to a performance gap between different environments
                    due to the presence of spurious correlations. Specifically,
                    the correlation between <math alttext="X_{sp}"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.10.m10.1"><semantics
                        id="S3.SS1.SSS1.p2.10.m10.1a"><msub
                          id="S3.SS1.SSS1.p2.10.m10.1.1"
                          xref="S3.SS1.SSS1.p2.10.m10.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.10.m10.1.1.2"
                            xref="S3.SS1.SSS1.p2.10.m10.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.10.m10.1.1.3"
                            xref="S3.SS1.SSS1.p2.10.m10.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.10.m10.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1.3.2.cmml">s</mi><mo
                              id="S3.SS1.SSS1.p2.10.m10.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.10.m10.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.10.m10.1b"><apply
                            id="S3.SS1.SSS1.p2.10.m10.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.10.m10.1.1"><csymbol
                              cd="ambiguous"
                              id="S3.SS1.SSS1.p2.10.m10.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.10.m10.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.10.m10.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.10.m10.1.1.3"><times
                                id="S3.SS1.SSS1.p2.10.m10.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.10.m10.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.10.m10.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.10.m10.1.1.3.2">𝑠</ci><ci
                                id="S3.SS1.SSS1.p2.10.m10.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.10.m10.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.10.m10.1c">X_{sp}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.10.m10.1d">italic_X
                          start_POSTSUBSCRIPT italic_s italic_p
                          end_POSTSUBSCRIPT</annotation></semantics></math> and
                    either <math alttext="Y" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.11.m11.1"><semantics
                        id="S3.SS1.SSS1.p2.11.m11.1a"><mi
                          id="S3.SS1.SSS1.p2.11.m11.1.1"
                          xref="S3.SS1.SSS1.p2.11.m11.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.11.m11.1b"><ci
                            id="S3.SS1.SSS1.p2.11.m11.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.11.m11.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.11.m11.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.11.m11.1d">italic_Y</annotation></semantics></math>
                    or <math alttext="X_{inv}" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.12.m12.1"><semantics
                        id="S3.SS1.SSS1.p2.12.m12.1a"><msub
                          id="S3.SS1.SSS1.p2.12.m12.1.1"
                          xref="S3.SS1.SSS1.p2.12.m12.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p2.12.m12.1.1.2"
                            xref="S3.SS1.SSS1.p2.12.m12.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p2.12.m12.1.1.3"
                            xref="S3.SS1.SSS1.p2.12.m12.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.2"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.1"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.3"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.1a"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.4"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.12.m12.1b"><apply
                            id="S3.SS1.SSS1.p2.12.m12.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.12.m12.1.1"><csymbol
                              cd="ambiguous"
                              id="S3.SS1.SSS1.p2.12.m12.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p2.12.m12.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p2.12.m12.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p2.12.m12.1.1.3"><times
                                id="S3.SS1.SSS1.p2.12.m12.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p2.12.m12.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p2.12.m12.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p2.12.m12.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p2.12.m12.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p2.12.m12.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p2.12.m12.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p2.12.m12.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.12.m12.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.12.m12.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math>
                    could vary due to the intervention of <math alttext="E"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p2.13.m13.1"><semantics
                        id="S3.SS1.SSS1.p2.13.m13.1a"><mi
                          id="S3.SS1.SSS1.p2.13.m13.1.1"
                          xref="S3.SS1.SSS1.p2.13.m13.1.1.cmml">E</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p2.13.m13.1b"><ci
                            id="S3.SS1.SSS1.p2.13.m13.1.1.cmml"
                            xref="S3.SS1.SSS1.p2.13.m13.1.1">𝐸</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p2.13.m13.1c">E</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p2.13.m13.1d">italic_E</annotation></semantics></math>
                    in the causal graph.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS1.p3">
                  <p class="ltx_p" id="S3.SS1.SSS1.p3.1">A causal graph
                    synthesizes a family of data generation processes that
                    adhere to a set of independence conditions based on the
                    <math alttext="d" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.1.m1.1"><semantics
                        id="S3.SS1.SSS1.p3.1.m1.1a"><mi
                          id="S3.SS1.SSS1.p3.1.m1.1.1"
                          xref="S3.SS1.SSS1.p3.1.m1.1.1.cmml">d</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.1.m1.1b"><ci
                            id="S3.SS1.SSS1.p3.1.m1.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.1.m1.1.1">𝑑</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.1.m1.1c">d</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.1.m1.1d">italic_d</annotation></semantics></math>-separation
                    <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib51"
                        title>51</a>]</cite> of the graph. A synthetic dataset
                    is simulated through a unique data generation process, which
                    is further formulated by Structural Equation Models
                    (SEM)<cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib52"
                        title>52</a>]</cite>. For example, Invariant Risk
                    Minimization (IRM) <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                        title>22</a>]</cite> introduces a toy synthetic OOD
                    dataset according to the fourth causal graph in Figure. <a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#S2.F2"
                      title="Figure 2 ‣ OOD Performance Prediction ‣ 2.2 Categorization of OOD Evaluation ‣ 2 Problem setting and categorization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                        class="ltx_text ltx_ref_tag">2</span></a>, whose SEM is
                    given by:</p>
                  <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table"
                    id="S7.EGx1">
                    <tbody id="S3.E2"><tr
                        class="ltx_equation ltx_eqn_row ltx_align_baseline">
                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                            alttext="\displaystyle X_{inv}" class="ltx_Math"
                            display="inline" id="S3.E2.m1.1"><semantics
                              id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1"
                                xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2"
                                  xref="S3.E2.m1.1.1.2.cmml">X</mi><mrow
                                  id="S3.E2.m1.1.1.3"
                                  xref="S3.E2.m1.1.1.3.cmml"><mi
                                    id="S3.E2.m1.1.1.3.2"
                                    xref="S3.E2.m1.1.1.3.2.cmml">i</mi><mo
                                    id="S3.E2.m1.1.1.3.1"
                                    xref="S3.E2.m1.1.1.3.1.cmml">⁢</mo><mi
                                    id="S3.E2.m1.1.1.3.3"
                                    xref="S3.E2.m1.1.1.3.3.cmml">n</mi><mo
                                    id="S3.E2.m1.1.1.3.1a"
                                    xref="S3.E2.m1.1.1.3.1.cmml">⁢</mo><mi
                                    id="S3.E2.m1.1.1.3.4"
                                    xref="S3.E2.m1.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                                encoding="MathML-Content"
                                id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml"
                                  xref="S3.E2.m1.1.1"><csymbol cd="ambiguous"
                                    id="S3.E2.m1.1.1.1.cmml"
                                    xref="S3.E2.m1.1.1">subscript</csymbol><ci
                                    id="S3.E2.m1.1.1.2.cmml"
                                    xref="S3.E2.m1.1.1.2">𝑋</ci><apply
                                    id="S3.E2.m1.1.1.3.cmml"
                                    xref="S3.E2.m1.1.1.3"><times
                                      id="S3.E2.m1.1.1.3.1.cmml"
                                      xref="S3.E2.m1.1.1.3.1"></times><ci
                                      id="S3.E2.m1.1.1.3.2.cmml"
                                      xref="S3.E2.m1.1.1.3.2">𝑖</ci><ci
                                      id="S3.E2.m1.1.1.3.3.cmml"
                                      xref="S3.E2.m1.1.1.3.3">𝑛</ci><ci
                                      id="S3.E2.m1.1.1.3.4.cmml"
                                      xref="S3.E2.m1.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E2.m1.1c">\displaystyle
                                X_{inv}</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E2.m1.1d">italic_X start_POSTSUBSCRIPT
                                italic_i italic_n italic_v
                                end_POSTSUBSCRIPT</annotation></semantics></math></td>
                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                            alttext="\displaystyle\leftarrow\text{Gaussian}(0,E^{2}),"
                            class="ltx_Math" display="inline"
                            id="S3.E2.m2.2"><semantics id="S3.E2.m2.2a"><mrow
                                id="S3.E2.m2.2.2.1"
                                xref="S3.E2.m2.2.2.1.1.cmml"><mrow
                                  id="S3.E2.m2.2.2.1.1"
                                  xref="S3.E2.m2.2.2.1.1.cmml"><mi
                                    id="S3.E2.m2.2.2.1.1.3"
                                    xref="S3.E2.m2.2.2.1.1.3.cmml"></mi><mo
                                    id="S3.E2.m2.2.2.1.1.2" stretchy="false"
                                    xref="S3.E2.m2.2.2.1.1.2.cmml">←</mo><mrow
                                    id="S3.E2.m2.2.2.1.1.1"
                                    xref="S3.E2.m2.2.2.1.1.1.cmml"><mtext
                                      id="S3.E2.m2.2.2.1.1.1.3"
                                      xref="S3.E2.m2.2.2.1.1.1.3a.cmml">Gaussian</mtext><mo
                                      id="S3.E2.m2.2.2.1.1.1.2"
                                      xref="S3.E2.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow
                                      id="S3.E2.m2.2.2.1.1.1.1.1"
                                      xref="S3.E2.m2.2.2.1.1.1.1.2.cmml"><mo
                                        id="S3.E2.m2.2.2.1.1.1.1.1.2"
                                        stretchy="false"
                                        xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">(</mo><mn
                                        id="S3.E2.m2.1.1"
                                        xref="S3.E2.m2.1.1.cmml">0</mn><mo
                                        id="S3.E2.m2.2.2.1.1.1.1.1.3"
                                        xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">,</mo><msup
                                        id="S3.E2.m2.2.2.1.1.1.1.1.1"
                                        xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml"><mi
                                          id="S3.E2.m2.2.2.1.1.1.1.1.1.2"
                                          xref="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml">E</mi><mn
                                          id="S3.E2.m2.2.2.1.1.1.1.1.1.3"
                                          xref="S3.E2.m2.2.2.1.1.1.1.1.1.3.cmml">2</mn></msup><mo
                                        id="S3.E2.m2.2.2.1.1.1.1.1.4"
                                        stretchy="false"
                                        xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo
                                  id="S3.E2.m2.2.2.1.2"
                                  xref="S3.E2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml
                                encoding="MathML-Content"
                                id="S3.E2.m2.2b"><apply
                                  id="S3.E2.m2.2.2.1.1.cmml"
                                  xref="S3.E2.m2.2.2.1"><ci
                                    id="S3.E2.m2.2.2.1.1.2.cmml"
                                    xref="S3.E2.m2.2.2.1.1.2">←</ci><csymbol
                                    cd="latexml" id="S3.E2.m2.2.2.1.1.3.cmml"
                                    xref="S3.E2.m2.2.2.1.1.3">absent</csymbol><apply
                                    id="S3.E2.m2.2.2.1.1.1.cmml"
                                    xref="S3.E2.m2.2.2.1.1.1"><times
                                      id="S3.E2.m2.2.2.1.1.1.2.cmml"
                                      xref="S3.E2.m2.2.2.1.1.1.2"></times><ci
                                      id="S3.E2.m2.2.2.1.1.1.3a.cmml"
                                      xref="S3.E2.m2.2.2.1.1.1.3"><mtext
                                        id="S3.E2.m2.2.2.1.1.1.3.cmml"
                                        xref="S3.E2.m2.2.2.1.1.1.3">Gaussian</mtext></ci><interval
                                      closure="open"
                                      id="S3.E2.m2.2.2.1.1.1.1.2.cmml"
                                      xref="S3.E2.m2.2.2.1.1.1.1.1"><cn
                                        id="S3.E2.m2.1.1.cmml" type="integer"
                                        xref="S3.E2.m2.1.1">0</cn><apply
                                        id="S3.E2.m2.2.2.1.1.1.1.1.1.cmml"
                                        xref="S3.E2.m2.2.2.1.1.1.1.1.1"><csymbol
                                          cd="ambiguous"
                                          id="S3.E2.m2.2.2.1.1.1.1.1.1.1.cmml"
                                          xref="S3.E2.m2.2.2.1.1.1.1.1.1">superscript</csymbol><ci
                                          id="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml"
                                          xref="S3.E2.m2.2.2.1.1.1.1.1.1.2">𝐸</ci><cn
                                          id="S3.E2.m2.2.2.1.1.1.1.1.1.3.cmml"
                                          type="integer"
                                          xref="S3.E2.m2.2.2.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E2.m2.2c">\displaystyle\leftarrow\text{Gaussian}(0,E^{2}),</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E2.m2.2d">← Gaussian ( 0 , italic_E
                                start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )
                                ,</annotation></semantics></math></td>
                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                        <td
                          class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                          rowspan="1"><span
                            class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
                      </tr></tbody>
                    <tbody id="S3.E3"><tr
                        class="ltx_equation ltx_eqn_row ltx_align_baseline">
                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                            alttext="\displaystyle Y" class="ltx_Math"
                            display="inline" id="S3.E3.m1.1"><semantics
                              id="S3.E3.m1.1a"><mi id="S3.E3.m1.1.1"
                                xref="S3.E3.m1.1.1.cmml">Y</mi><annotation-xml
                                encoding="MathML-Content" id="S3.E3.m1.1b"><ci
                                  id="S3.E3.m1.1.1.cmml"
                                  xref="S3.E3.m1.1.1">𝑌</ci></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E3.m1.1c">\displaystyle
                                Y</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E3.m1.1d">italic_Y</annotation></semantics></math></td>
                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                            alttext="\displaystyle\leftarrow X_{inv}+\text{Gaussian}(0,E^{2}),"
                            class="ltx_Math" display="inline"
                            id="S3.E3.m2.2"><semantics id="S3.E3.m2.2a"><mrow
                                id="S3.E3.m2.2.2.1"
                                xref="S3.E3.m2.2.2.1.1.cmml"><mrow
                                  id="S3.E3.m2.2.2.1.1"
                                  xref="S3.E3.m2.2.2.1.1.cmml"><mi
                                    id="S3.E3.m2.2.2.1.1.3"
                                    xref="S3.E3.m2.2.2.1.1.3.cmml"></mi><mo
                                    id="S3.E3.m2.2.2.1.1.2" stretchy="false"
                                    xref="S3.E3.m2.2.2.1.1.2.cmml">←</mo><mrow
                                    id="S3.E3.m2.2.2.1.1.1"
                                    xref="S3.E3.m2.2.2.1.1.1.cmml"><msub
                                      id="S3.E3.m2.2.2.1.1.1.3"
                                      xref="S3.E3.m2.2.2.1.1.1.3.cmml"><mi
                                        id="S3.E3.m2.2.2.1.1.1.3.2"
                                        xref="S3.E3.m2.2.2.1.1.1.3.2.cmml">X</mi><mrow
                                        id="S3.E3.m2.2.2.1.1.1.3.3"
                                        xref="S3.E3.m2.2.2.1.1.1.3.3.cmml"><mi
                                          id="S3.E3.m2.2.2.1.1.1.3.3.2"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.2.cmml">i</mi><mo
                                          id="S3.E3.m2.2.2.1.1.1.3.3.1"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi
                                          id="S3.E3.m2.2.2.1.1.1.3.3.3"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.3.cmml">n</mi><mo
                                          id="S3.E3.m2.2.2.1.1.1.3.3.1a"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi
                                          id="S3.E3.m2.2.2.1.1.1.3.3.4"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.4.cmml">v</mi></mrow></msub><mo
                                      id="S3.E3.m2.2.2.1.1.1.2"
                                      xref="S3.E3.m2.2.2.1.1.1.2.cmml">+</mo><mrow
                                      id="S3.E3.m2.2.2.1.1.1.1"
                                      xref="S3.E3.m2.2.2.1.1.1.1.cmml"><mtext
                                        id="S3.E3.m2.2.2.1.1.1.1.3"
                                        xref="S3.E3.m2.2.2.1.1.1.1.3a.cmml">Gaussian</mtext><mo
                                        id="S3.E3.m2.2.2.1.1.1.1.2"
                                        xref="S3.E3.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow
                                        id="S3.E3.m2.2.2.1.1.1.1.1.1"
                                        xref="S3.E3.m2.2.2.1.1.1.1.1.2.cmml"><mo
                                          id="S3.E3.m2.2.2.1.1.1.1.1.1.2"
                                          stretchy="false"
                                          xref="S3.E3.m2.2.2.1.1.1.1.1.2.cmml">(</mo><mn
                                          id="S3.E3.m2.1.1"
                                          xref="S3.E3.m2.1.1.cmml">0</mn><mo
                                          id="S3.E3.m2.2.2.1.1.1.1.1.1.3"
                                          xref="S3.E3.m2.2.2.1.1.1.1.1.2.cmml">,</mo><msup
                                          id="S3.E3.m2.2.2.1.1.1.1.1.1.1"
                                          xref="S3.E3.m2.2.2.1.1.1.1.1.1.1.cmml"><mi
                                            id="S3.E3.m2.2.2.1.1.1.1.1.1.1.2"
                                            xref="S3.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml">E</mi><mn
                                            id="S3.E3.m2.2.2.1.1.1.1.1.1.1.3"
                                            xref="S3.E3.m2.2.2.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo
                                          id="S3.E3.m2.2.2.1.1.1.1.1.1.4"
                                          stretchy="false"
                                          xref="S3.E3.m2.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo
                                  id="S3.E3.m2.2.2.1.2"
                                  xref="S3.E3.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml
                                encoding="MathML-Content"
                                id="S3.E3.m2.2b"><apply
                                  id="S3.E3.m2.2.2.1.1.cmml"
                                  xref="S3.E3.m2.2.2.1"><ci
                                    id="S3.E3.m2.2.2.1.1.2.cmml"
                                    xref="S3.E3.m2.2.2.1.1.2">←</ci><csymbol
                                    cd="latexml" id="S3.E3.m2.2.2.1.1.3.cmml"
                                    xref="S3.E3.m2.2.2.1.1.3">absent</csymbol><apply
                                    id="S3.E3.m2.2.2.1.1.1.cmml"
                                    xref="S3.E3.m2.2.2.1.1.1"><plus
                                      id="S3.E3.m2.2.2.1.1.1.2.cmml"
                                      xref="S3.E3.m2.2.2.1.1.1.2"></plus><apply
                                      id="S3.E3.m2.2.2.1.1.1.3.cmml"
                                      xref="S3.E3.m2.2.2.1.1.1.3"><csymbol
                                        cd="ambiguous"
                                        id="S3.E3.m2.2.2.1.1.1.3.1.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.3">subscript</csymbol><ci
                                        id="S3.E3.m2.2.2.1.1.1.3.2.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.3.2">𝑋</ci><apply
                                        id="S3.E3.m2.2.2.1.1.1.3.3.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.3.3"><times
                                          id="S3.E3.m2.2.2.1.1.1.3.3.1.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.1"></times><ci
                                          id="S3.E3.m2.2.2.1.1.1.3.3.2.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.2">𝑖</ci><ci
                                          id="S3.E3.m2.2.2.1.1.1.3.3.3.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.3">𝑛</ci><ci
                                          id="S3.E3.m2.2.2.1.1.1.3.3.4.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.3.3.4">𝑣</ci></apply></apply><apply
                                      id="S3.E3.m2.2.2.1.1.1.1.cmml"
                                      xref="S3.E3.m2.2.2.1.1.1.1"><times
                                        id="S3.E3.m2.2.2.1.1.1.1.2.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.1.2"></times><ci
                                        id="S3.E3.m2.2.2.1.1.1.1.3a.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.1.3"><mtext
                                          id="S3.E3.m2.2.2.1.1.1.1.3.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.1.3">Gaussian</mtext></ci><interval
                                        closure="open"
                                        id="S3.E3.m2.2.2.1.1.1.1.1.2.cmml"
                                        xref="S3.E3.m2.2.2.1.1.1.1.1.1"><cn
                                          id="S3.E3.m2.1.1.cmml" type="integer"
                                          xref="S3.E3.m2.1.1">0</cn><apply
                                          id="S3.E3.m2.2.2.1.1.1.1.1.1.1.cmml"
                                          xref="S3.E3.m2.2.2.1.1.1.1.1.1.1"><csymbol
                                            cd="ambiguous"
                                            id="S3.E3.m2.2.2.1.1.1.1.1.1.1.1.cmml"
                                            xref="S3.E3.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci
                                            id="S3.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml"
                                            xref="S3.E3.m2.2.2.1.1.1.1.1.1.1.2">𝐸</ci><cn
                                            id="S3.E3.m2.2.2.1.1.1.1.1.1.1.3.cmml"
                                            type="integer"
                                            xref="S3.E3.m2.2.2.1.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></apply></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E3.m2.2c">\displaystyle\leftarrow
                                X_{inv}+\text{Gaussian}(0,E^{2}),</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E3.m2.2d">← italic_X start_POSTSUBSCRIPT
                                italic_i italic_n italic_v end_POSTSUBSCRIPT +
                                Gaussian ( 0 , italic_E start_POSTSUPERSCRIPT 2
                                end_POSTSUPERSCRIPT )
                                ,</annotation></semantics></math></td>
                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                        <td
                          class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                          rowspan="1"><span
                            class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
                      </tr></tbody>
                    <tbody id="S3.E4"><tr
                        class="ltx_equation ltx_eqn_row ltx_align_baseline">
                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                            alttext="\displaystyle X_{sp}" class="ltx_Math"
                            display="inline" id="S3.E4.m1.1"><semantics
                              id="S3.E4.m1.1a"><msub id="S3.E4.m1.1.1"
                                xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2"
                                  xref="S3.E4.m1.1.1.2.cmml">X</mi><mrow
                                  id="S3.E4.m1.1.1.3"
                                  xref="S3.E4.m1.1.1.3.cmml"><mi
                                    id="S3.E4.m1.1.1.3.2"
                                    xref="S3.E4.m1.1.1.3.2.cmml">s</mi><mo
                                    id="S3.E4.m1.1.1.3.1"
                                    xref="S3.E4.m1.1.1.3.1.cmml">⁢</mo><mi
                                    id="S3.E4.m1.1.1.3.3"
                                    xref="S3.E4.m1.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml
                                encoding="MathML-Content"
                                id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml"
                                  xref="S3.E4.m1.1.1"><csymbol cd="ambiguous"
                                    id="S3.E4.m1.1.1.1.cmml"
                                    xref="S3.E4.m1.1.1">subscript</csymbol><ci
                                    id="S3.E4.m1.1.1.2.cmml"
                                    xref="S3.E4.m1.1.1.2">𝑋</ci><apply
                                    id="S3.E4.m1.1.1.3.cmml"
                                    xref="S3.E4.m1.1.1.3"><times
                                      id="S3.E4.m1.1.1.3.1.cmml"
                                      xref="S3.E4.m1.1.1.3.1"></times><ci
                                      id="S3.E4.m1.1.1.3.2.cmml"
                                      xref="S3.E4.m1.1.1.3.2">𝑠</ci><ci
                                      id="S3.E4.m1.1.1.3.3.cmml"
                                      xref="S3.E4.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E4.m1.1c">\displaystyle
                                X_{sp}</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E4.m1.1d">italic_X start_POSTSUBSCRIPT
                                italic_s italic_p
                                end_POSTSUBSCRIPT</annotation></semantics></math></td>
                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                            alttext="\displaystyle\leftarrow Y+\text{Gaussian}(0,1)."
                            class="ltx_Math" display="inline"
                            id="S3.E4.m2.3"><semantics id="S3.E4.m2.3a"><mrow
                                id="S3.E4.m2.3.3.1"
                                xref="S3.E4.m2.3.3.1.1.cmml"><mrow
                                  id="S3.E4.m2.3.3.1.1"
                                  xref="S3.E4.m2.3.3.1.1.cmml"><mi
                                    id="S3.E4.m2.3.3.1.1.2"
                                    xref="S3.E4.m2.3.3.1.1.2.cmml"></mi><mo
                                    id="S3.E4.m2.3.3.1.1.1" stretchy="false"
                                    xref="S3.E4.m2.3.3.1.1.1.cmml">←</mo><mrow
                                    id="S3.E4.m2.3.3.1.1.3"
                                    xref="S3.E4.m2.3.3.1.1.3.cmml"><mi
                                      id="S3.E4.m2.3.3.1.1.3.2"
                                      xref="S3.E4.m2.3.3.1.1.3.2.cmml">Y</mi><mo
                                      id="S3.E4.m2.3.3.1.1.3.1"
                                      xref="S3.E4.m2.3.3.1.1.3.1.cmml">+</mo><mrow
                                      id="S3.E4.m2.3.3.1.1.3.3"
                                      xref="S3.E4.m2.3.3.1.1.3.3.cmml"><mtext
                                        id="S3.E4.m2.3.3.1.1.3.3.2"
                                        xref="S3.E4.m2.3.3.1.1.3.3.2a.cmml">Gaussian</mtext><mo
                                        id="S3.E4.m2.3.3.1.1.3.3.1"
                                        xref="S3.E4.m2.3.3.1.1.3.3.1.cmml">⁢</mo><mrow
                                        id="S3.E4.m2.3.3.1.1.3.3.3.2"
                                        xref="S3.E4.m2.3.3.1.1.3.3.3.1.cmml"><mo
                                          id="S3.E4.m2.3.3.1.1.3.3.3.2.1"
                                          stretchy="false"
                                          xref="S3.E4.m2.3.3.1.1.3.3.3.1.cmml">(</mo><mn
                                          id="S3.E4.m2.1.1"
                                          xref="S3.E4.m2.1.1.cmml">0</mn><mo
                                          id="S3.E4.m2.3.3.1.1.3.3.3.2.2"
                                          xref="S3.E4.m2.3.3.1.1.3.3.3.1.cmml">,</mo><mn
                                          id="S3.E4.m2.2.2"
                                          xref="S3.E4.m2.2.2.cmml">1</mn><mo
                                          id="S3.E4.m2.3.3.1.1.3.3.3.2.3"
                                          stretchy="false"
                                          xref="S3.E4.m2.3.3.1.1.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo
                                  id="S3.E4.m2.3.3.1.2" lspace="0em"
                                  xref="S3.E4.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml
                                encoding="MathML-Content"
                                id="S3.E4.m2.3b"><apply
                                  id="S3.E4.m2.3.3.1.1.cmml"
                                  xref="S3.E4.m2.3.3.1"><ci
                                    id="S3.E4.m2.3.3.1.1.1.cmml"
                                    xref="S3.E4.m2.3.3.1.1.1">←</ci><csymbol
                                    cd="latexml" id="S3.E4.m2.3.3.1.1.2.cmml"
                                    xref="S3.E4.m2.3.3.1.1.2">absent</csymbol><apply
                                    id="S3.E4.m2.3.3.1.1.3.cmml"
                                    xref="S3.E4.m2.3.3.1.1.3"><plus
                                      id="S3.E4.m2.3.3.1.1.3.1.cmml"
                                      xref="S3.E4.m2.3.3.1.1.3.1"></plus><ci
                                      id="S3.E4.m2.3.3.1.1.3.2.cmml"
                                      xref="S3.E4.m2.3.3.1.1.3.2">𝑌</ci><apply
                                      id="S3.E4.m2.3.3.1.1.3.3.cmml"
                                      xref="S3.E4.m2.3.3.1.1.3.3"><times
                                        id="S3.E4.m2.3.3.1.1.3.3.1.cmml"
                                        xref="S3.E4.m2.3.3.1.1.3.3.1"></times><ci
                                        id="S3.E4.m2.3.3.1.1.3.3.2a.cmml"
                                        xref="S3.E4.m2.3.3.1.1.3.3.2"><mtext
                                          id="S3.E4.m2.3.3.1.1.3.3.2.cmml"
                                          xref="S3.E4.m2.3.3.1.1.3.3.2">Gaussian</mtext></ci><interval
                                        closure="open"
                                        id="S3.E4.m2.3.3.1.1.3.3.3.1.cmml"
                                        xref="S3.E4.m2.3.3.1.1.3.3.3.2"><cn
                                          id="S3.E4.m2.1.1.cmml" type="integer"
                                          xref="S3.E4.m2.1.1">0</cn><cn
                                          id="S3.E4.m2.2.2.cmml" type="integer"
                                          xref="S3.E4.m2.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation
                                encoding="application/x-tex"
                                id="S3.E4.m2.3c">\displaystyle\leftarrow
                                Y+\text{Gaussian}(0,1).</annotation><annotation
                                encoding="application/x-llamapun"
                                id="S3.E4.m2.3d">← italic_Y + Gaussian ( 0 , 1 )
                                .</annotation></semantics></math></td>
                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                        <td
                          class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                          rowspan="1"><span
                            class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
                      </tr></tbody>
                  </table>
                  <p class="ltx_p" id="S3.SS1.SSS1.p3.12">It can be verified
                    that by simply regressing <math alttext="Y" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p3.2.m1.1"><semantics
                        id="S3.SS1.SSS1.p3.2.m1.1a"><mi
                          id="S3.SS1.SSS1.p3.2.m1.1.1"
                          xref="S3.SS1.SSS1.p3.2.m1.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.2.m1.1b"><ci
                            id="S3.SS1.SSS1.p3.2.m1.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.2.m1.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.2.m1.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.2.m1.1d">italic_Y</annotation></semantics></math>
                    on <math alttext="(X_{inv},X_{sp})" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p3.3.m2.2"><semantics
                        id="S3.SS1.SSS1.p3.3.m2.2a"><mrow
                          id="S3.SS1.SSS1.p3.3.m2.2.2.2"
                          xref="S3.SS1.SSS1.p3.3.m2.2.2.3.cmml"><mo
                            id="S3.SS1.SSS1.p3.3.m2.2.2.2.3" stretchy="false"
                            xref="S3.SS1.SSS1.p3.3.m2.2.2.3.cmml">(</mo><msub
                            id="S3.SS1.SSS1.p3.3.m2.1.1.1.1"
                            xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.cmml"><mi
                              id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.2"
                              xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.2.cmml">X</mi><mrow
                              id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3"
                              xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.cmml"><mi
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.2"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.2.cmml">i</mi><mo
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1.cmml">⁢</mo><mi
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.3"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.3.cmml">n</mi><mo
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1a"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1.cmml">⁢</mo><mi
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.4"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.4.cmml">v</mi></mrow></msub><mo
                            id="S3.SS1.SSS1.p3.3.m2.2.2.2.4"
                            xref="S3.SS1.SSS1.p3.3.m2.2.2.3.cmml">,</mo><msub
                            id="S3.SS1.SSS1.p3.3.m2.2.2.2.2"
                            xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.cmml"><mi
                              id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.2"
                              xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.2.cmml">X</mi><mrow
                              id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3"
                              xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.cmml"><mi
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.2"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.2.cmml">s</mi><mo
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.1"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.1.cmml">⁢</mo><mi
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.3"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.3.cmml">p</mi></mrow></msub><mo
                            id="S3.SS1.SSS1.p3.3.m2.2.2.2.5" stretchy="false"
                            xref="S3.SS1.SSS1.p3.3.m2.2.2.3.cmml">)</mo></mrow><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.3.m2.2b"><interval closure="open"
                            id="S3.SS1.SSS1.p3.3.m2.2.2.3.cmml"
                            xref="S3.SS1.SSS1.p3.3.m2.2.2.2"><apply
                              id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1"><csymbol
                                cd="ambiguous"
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.1.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1">subscript</csymbol><ci
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.2.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.2">𝑋</ci><apply
                                id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3"><times
                                  id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.1"></times><ci
                                  id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.2.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.2">𝑖</ci><ci
                                  id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.3.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.3">𝑛</ci><ci
                                  id="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.4.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.1.1.1.1.3.4">𝑣</ci></apply></apply><apply
                              id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.cmml"
                              xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2"><csymbol
                                cd="ambiguous"
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.1.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2">subscript</csymbol><ci
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.2.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.2">𝑋</ci><apply
                                id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.cmml"
                                xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3"><times
                                  id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.1.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.1"></times><ci
                                  id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.2.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.2">𝑠</ci><ci
                                  id="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.3.cmml"
                                  xref="S3.SS1.SSS1.p3.3.m2.2.2.2.2.3.3">𝑝</ci></apply></apply></interval></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.3.m2.2c">(X_{inv},X_{sp})</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.3.m2.2d">( italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT
                          italic_s italic_p end_POSTSUBSCRIPT
                          )</annotation></semantics></math> or <math
                      alttext="X_{sp}" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.4.m3.1"><semantics
                        id="S3.SS1.SSS1.p3.4.m3.1a"><msub
                          id="S3.SS1.SSS1.p3.4.m3.1.1"
                          xref="S3.SS1.SSS1.p3.4.m3.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p3.4.m3.1.1.2"
                            xref="S3.SS1.SSS1.p3.4.m3.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p3.4.m3.1.1.3"
                            xref="S3.SS1.SSS1.p3.4.m3.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p3.4.m3.1.1.3.2"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1.3.2.cmml">s</mi><mo
                              id="S3.SS1.SSS1.p3.4.m3.1.1.3.1"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.4.m3.1.1.3.3"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.4.m3.1b"><apply
                            id="S3.SS1.SSS1.p3.4.m3.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.4.m3.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p3.4.m3.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p3.4.m3.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p3.4.m3.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p3.4.m3.1.1.3"><times
                                id="S3.SS1.SSS1.p3.4.m3.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p3.4.m3.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p3.4.m3.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p3.4.m3.1.1.3.2">𝑠</ci><ci
                                id="S3.SS1.SSS1.p3.4.m3.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p3.4.m3.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.4.m3.1c">X_{sp}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.4.m3.1d">italic_X
                          start_POSTSUBSCRIPT italic_s italic_p
                          end_POSTSUBSCRIPT</annotation></semantics></math>, the
                    estimated coefficients vary with values of <math alttext="E"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.5.m4.1"><semantics
                        id="S3.SS1.SSS1.p3.5.m4.1a"><mi
                          id="S3.SS1.SSS1.p3.5.m4.1.1"
                          xref="S3.SS1.SSS1.p3.5.m4.1.1.cmml">E</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.5.m4.1b"><ci
                            id="S3.SS1.SSS1.p3.5.m4.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.5.m4.1.1">𝐸</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.5.m4.1c">E</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.5.m4.1d">italic_E</annotation></semantics></math>,
                    demonstrating a spurious correlation. In contrast, the
                    coefficients when regressing <math alttext="Y"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.6.m5.1"><semantics
                        id="S3.SS1.SSS1.p3.6.m5.1a"><mi
                          id="S3.SS1.SSS1.p3.6.m5.1.1"
                          xref="S3.SS1.SSS1.p3.6.m5.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.6.m5.1b"><ci
                            id="S3.SS1.SSS1.p3.6.m5.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.6.m5.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.6.m5.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.6.m5.1d">italic_Y</annotation></semantics></math>
                    on <math alttext="X_{inv}" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.7.m6.1"><semantics
                        id="S3.SS1.SSS1.p3.7.m6.1a"><msub
                          id="S3.SS1.SSS1.p3.7.m6.1.1"
                          xref="S3.SS1.SSS1.p3.7.m6.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p3.7.m6.1.1.2"
                            xref="S3.SS1.SSS1.p3.7.m6.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p3.7.m6.1.1.3"
                            xref="S3.SS1.SSS1.p3.7.m6.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.2"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.1"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.3"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.1a"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.4"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.7.m6.1b"><apply
                            id="S3.SS1.SSS1.p3.7.m6.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.7.m6.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p3.7.m6.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p3.7.m6.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p3.7.m6.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p3.7.m6.1.1.3"><times
                                id="S3.SS1.SSS1.p3.7.m6.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p3.7.m6.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p3.7.m6.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p3.7.m6.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p3.7.m6.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p3.7.m6.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p3.7.m6.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p3.7.m6.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.7.m6.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.7.m6.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math> are
                    constantly <math alttext="1" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p3.8.m7.1"><semantics
                        id="S3.SS1.SSS1.p3.8.m7.1a"><mn
                          id="S3.SS1.SSS1.p3.8.m7.1.1"
                          xref="S3.SS1.SSS1.p3.8.m7.1.1.cmml">1</mn><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.8.m7.1b"><cn
                            id="S3.SS1.SSS1.p3.8.m7.1.1.cmml" type="integer"
                            xref="S3.SS1.SSS1.p3.8.m7.1.1">1</cn></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.8.m7.1c">1</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.8.m7.1d">1</annotation></semantics></math>,
                    because <math alttext="X_{inv}" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p3.9.m8.1"><semantics
                        id="S3.SS1.SSS1.p3.9.m8.1a"><msub
                          id="S3.SS1.SSS1.p3.9.m8.1.1"
                          xref="S3.SS1.SSS1.p3.9.m8.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p3.9.m8.1.1.2"
                            xref="S3.SS1.SSS1.p3.9.m8.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p3.9.m8.1.1.3"
                            xref="S3.SS1.SSS1.p3.9.m8.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.2"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.1"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.3"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.1a"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.4"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.9.m8.1b"><apply
                            id="S3.SS1.SSS1.p3.9.m8.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.9.m8.1.1"><csymbol
                              cd="ambiguous" id="S3.SS1.SSS1.p3.9.m8.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p3.9.m8.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p3.9.m8.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p3.9.m8.1.1.3"><times
                                id="S3.SS1.SSS1.p3.9.m8.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p3.9.m8.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p3.9.m8.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p3.9.m8.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p3.9.m8.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p3.9.m8.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p3.9.m8.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p3.9.m8.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.9.m8.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.9.m8.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math> is
                    the cause of <math alttext="Y" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS1.p3.10.m9.1"><semantics
                        id="S3.SS1.SSS1.p3.10.m9.1a"><mi
                          id="S3.SS1.SSS1.p3.10.m9.1.1"
                          xref="S3.SS1.SSS1.p3.10.m9.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.10.m9.1b"><ci
                            id="S3.SS1.SSS1.p3.10.m9.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.10.m9.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.10.m9.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.10.m9.1d">italic_Y</annotation></semantics></math>.
                    Thus it becomes evident that <math alttext="X_{inv}"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.11.m10.1"><semantics
                        id="S3.SS1.SSS1.p3.11.m10.1a"><msub
                          id="S3.SS1.SSS1.p3.11.m10.1.1"
                          xref="S3.SS1.SSS1.p3.11.m10.1.1.cmml"><mi
                            id="S3.SS1.SSS1.p3.11.m10.1.1.2"
                            xref="S3.SS1.SSS1.p3.11.m10.1.1.2.cmml">X</mi><mrow
                            id="S3.SS1.SSS1.p3.11.m10.1.1.3"
                            xref="S3.SS1.SSS1.p3.11.m10.1.1.3.cmml"><mi
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.2"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3.2.cmml">i</mi><mo
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.1"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.3"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3.3.cmml">n</mi><mo
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.1a"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3.1.cmml">⁢</mo><mi
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.4"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.11.m10.1b"><apply
                            id="S3.SS1.SSS1.p3.11.m10.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.11.m10.1.1"><csymbol
                              cd="ambiguous"
                              id="S3.SS1.SSS1.p3.11.m10.1.1.1.cmml"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1">subscript</csymbol><ci
                              id="S3.SS1.SSS1.p3.11.m10.1.1.2.cmml"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.2">𝑋</ci><apply
                              id="S3.SS1.SSS1.p3.11.m10.1.1.3.cmml"
                              xref="S3.SS1.SSS1.p3.11.m10.1.1.3"><times
                                id="S3.SS1.SSS1.p3.11.m10.1.1.3.1.cmml"
                                xref="S3.SS1.SSS1.p3.11.m10.1.1.3.1"></times><ci
                                id="S3.SS1.SSS1.p3.11.m10.1.1.3.2.cmml"
                                xref="S3.SS1.SSS1.p3.11.m10.1.1.3.2">𝑖</ci><ci
                                id="S3.SS1.SSS1.p3.11.m10.1.1.3.3.cmml"
                                xref="S3.SS1.SSS1.p3.11.m10.1.1.3.3">𝑛</ci><ci
                                id="S3.SS1.SSS1.p3.11.m10.1.1.3.4.cmml"
                                xref="S3.SS1.SSS1.p3.11.m10.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.11.m10.1c">X_{inv}</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.11.m10.1d">italic_X
                          start_POSTSUBSCRIPT italic_i italic_n italic_v
                          end_POSTSUBSCRIPT</annotation></semantics></math>
                    stands as the unique predictor of <math alttext="Y"
                      class="ltx_Math" display="inline"
                      id="S3.SS1.SSS1.p3.12.m11.1"><semantics
                        id="S3.SS1.SSS1.p3.12.m11.1a"><mi
                          id="S3.SS1.SSS1.p3.12.m11.1.1"
                          xref="S3.SS1.SSS1.p3.12.m11.1.1.cmml">Y</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS1.p3.12.m11.1b"><ci
                            id="S3.SS1.SSS1.p3.12.m11.1.1.cmml"
                            xref="S3.SS1.SSS1.p3.12.m11.1.1">𝑌</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS1.p3.12.m11.1c">Y</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS1.p3.12.m11.1d">italic_Y</annotation></semantics></math>
                    that performs consistently across different
                    environments.</p>
                </div>
              </section>
              <section class="ltx_subsubsection" id="S3.SS1.SSS2">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.2
                  </span>Visual Datasets</h4>
                <div class="ltx_para" id="S3.SS1.SSS2.p1">
                  <p class="ltx_p" id="S3.SS1.SSS2.p1.1">Visual datasets are the
                    most prevalent real-world datasets when it comes to OOD
                    generalization, where image classification occupies the vast
                    majority. One reason for the popularity of visual OOD
                    datasets is that there naturally exist diverse types of
                    distribution shifts with semantic meanings in computer
                    vision.
                    PACS <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib11"
                        title>11</a>]</cite>, OfficeHome <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib53"
                        title>53</a>]</cite>, and DomainNet <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib54"
                        title>54</a>]</cite> generate shifts via the change of
                    image style.
                    WaterBirds <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib55"
                        title>55</a>]</cite>, MetaShift <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib56"
                        title>56</a>]</cite>, and ImageNetBG <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib57"
                        title>57</a>]</cite> alter the backgrounds.
                    Different locations or views of the taken photos are
                    leveraged by TerraInc <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib58"
                        title>58</a>]</cite> and iWildCam <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib59"
                        title>59</a>]</cite>.
                    Corruptions are used by ImageNet-C and ImageNet-P <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib60"
                        title>60</a>]</cite>.
                    Some also directly collect data from different sources and
                    treat each source as a distinct data distribution like VLCS
                    <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib61"
                        title>61</a>]</cite> and CXRMultisite <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib62"
                        title>62</a>]</cite>.
                    Another common type of shift is generated through
                    demographic attributes like race and gender, e.g. CelebA
                    <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib63"
                        title>63</a>]</cite>, MIMIC-CXR <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib64"
                        title>64</a>]</cite>, and CheXpert <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib65"
                        title>65</a>]</cite>.
                    Note that most datasets cover only one kind of shift,
                    rendering them relatively fixed and limited in testing OOD
                    generalization performance. To promote greater flexibility
                    in testing under various distribution shifts, it is
                    encouraged to incorporate multiple attributes related to
                    distribution shifts within a single dataset, like SVSF <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib66"
                        title>66</a>]</cite>, NICO++ <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib29"
                        title>29</a>]</cite>, and Spawrious <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib67"
                        title>67</a>]</cite>.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS2.p2">
                  <p class="ltx_p" id="S3.SS1.SSS2.p2.1">Apart from the shift
                    type, the focus of visual OOD datasets differs for
                    subpopulation shift <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                        title>68</a>]</cite> and domain generalization <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                        title>18</a>]</cite>. Subpopulation shift datasets
                    typically operate within a domain-imbalanced setting,
                    deliberately creating situations where the majority group
                    incurs an evident spurious correlation between the group
                    label and the category label. These datasets primarily
                    concentrate on evaluating the performance of the worst
                    group, which usually corresponds to the minor group. As for
                    domain generalization datasets, they are designed with
                    relatively balanced data across domains, with a primary
                    focus on the average performance across all test data
                    instances. Both of these settings are common in real
                    scenarios.
                    There are also some datasets without their own training
                    data, like ObjectNet <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib69"
                        title>69</a>]</cite> and the variants of ImageNet <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib70"
                        title>70</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib66"
                        title>66</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib71"
                        title>71</a>]</cite>. They are usually employed to test
                    off-the-shelf models trained on ImageNet since the tested
                    classes are a subset of ImageNet classes.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS2.p3">
                  <p class="ltx_p" id="S3.SS1.SSS2.p3.1">Besides image
                    classification, recently there have been various datasets
                    tailored for other visual tasks.
                    PovertyMap <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib72"
                        title>72</a>]</cite> presents an image regression task
                    in that its outcome label is the real-valued asset wealth
                    index, whose environments are defined by urban or rural
                    areas. Also introduced by Koh et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib72"
                        title>72</a>]</cite>, GlobalWheat aims at object
                    detection to detect wheat heads in the given images in
                    different countries, while COCO-O <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib73"
                        title>73</a>]</cite> targets a more general object
                    detection with 80 object categories. SYNTHIA <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib74"
                        title>74</a>]</cite> and GTA5-Cityscapes <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib75"
                        title>75</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib76"
                        title>76</a>]</cite> serve as datasets for OOD semantic
                    segmentation. For more datasets concerning specific visual
                    tasks, you may refer to the surveys on domain generalization
                    <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib16"
                        title>16</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib17"
                        title>17</a>]</cite>.</p>
                </div>
              </section>
              <section class="ltx_subsubsection" id="S3.SS1.SSS3">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Text
                  Datasets</h4>
                <div class="ltx_para" id="S3.SS1.SSS3.p1">
                  <p class="ltx_p" id="S3.SS1.SSS3.p1.1">Although less
                    investigated than visual tasks, there are also various text
                    datasets for OOD evaluation in NLP. Similar to visual
                    datasets, a common design is to generate spurious
                    correlations between attributes and outcome labels. For
                    example, CivilComments <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib72"
                        title>72</a>]</cite> poses the task of classifying
                    whether the comment is toxic when there are correlations
                    between the outcome and demographic attributes mentioned in
                    the comment, such as gender and race. MultiNLI <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib77"
                        title>77</a>]</cite> takes advantage of the co-existence
                    of negation words and the conclusion of contradiction to
                    conduct natural language inference.
                    Another type of design involves assembling datasets from
                    diverse sources and subsequently dividing them into training
                    and test sets. In Hendrycks et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib78"
                        title>78</a>]</cite>, the authors treat SST-2 <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib79"
                        title>79</a>]</cite> and IMDb <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib80"
                        title>80</a>]</cite>, which contain movie reviews
                    collected either by Stanford University or from IMDb
                    website, as training and test datasets respectively. In Koh
                    et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib72"
                        title>72</a>]</cite>, they partition the dataset Amazon
                    according to the source of the comment, i.e. the reviewer.
                    In the newly released benchmarks GLUE-X <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib81"
                        title>81</a>]</cite> and BOSS <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                        title>82</a>]</cite>, distribution shifts also stem from
                    the variation of collection sources.</p>
                </div>
              </section>
              <section class="ltx_subsubsection" id="S3.SS1.SSS4">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.4
                  </span>Tabular Datasets</h4>
                <div class="ltx_para" id="S3.SS1.SSS4.p1">
                  <p class="ltx_p" id="S3.SS1.SSS4.p1.1">Compared with the
                    growth of visual and text datasets, tabular datasets are
                    much less produced and remain underexplored.
                    Temporal shifts and spatial shifts are commonly used. Shen
                    et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib83"
                        title>83</a>]</cite> and Yu et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib27"
                        title>27</a>]</cite> split the house price dataset <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib84"
                        title>84</a>]</cite> according to the time period of the
                    house built to generate distribution shifts.
                    Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                        title>33</a>]</cite> split the datasets Taxi <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib85"
                        title>85</a>]</cite> and US Accident <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib86"
                        title>86</a>]</cite> according to the state or the year.
                    In addition to spatial-temporal shifts, another natural
                    shift stemming from demographic attributes are also adopted
                    to introduce distribution shifts.
                    In the UCI Adult dataset <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib87"
                        title>87</a>]</cite>, a combination of race and sex can
                    be used to formulate subgroups.
                    Recently, the Bank Account Fraud (BAF) dataset <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib88"
                        title>88</a>]</cite> is generated based on an anonymized
                    dataset with the help of Generative Adversarial Networks
                    (GAN) <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib89"
                        title>89</a>]</cite> and differential privacy techniques
                    and provides challenges concerning temporal shifts and data
                    imbalance. This sheds light on the feasibility of creating
                    larger-scale tabular datasets via data generation to
                    facilitate more comprehensive evaluation.</p>
                </div>
              </section>
              <section class="ltx_subsubsection" id="S3.SS1.SSS5">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.5
                  </span>Benchmarks with Combined Datasets or Settings</h4>
                <div class="ltx_para" id="S3.SS1.SSS5.p1">
                  <p class="ltx_p" id="S3.SS1.SSS5.p1.1">Apart from the
                    aforementioned individual datasets, to further facilitate
                    the development of OOD generalization methods, benchmarks
                    combining these datasets with proper evaluation protocols
                    are required.
                    For most benchmarks, they directly adopt the average
                    performance on the test environments as the evaluation
                    metric. When it comes to subpopulation shift tasks <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                        title>68</a>]</cite>, there is a particular emphasis on
                    assessing the worst group performance.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p2">
                  <p class="ltx_p" id="S3.SS1.SSS5.p2.1">DomainBed <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                        title>18</a>]</cite> currently stands as the widely
                    recognized evaluation protocol and benchmark for domain
                    generalization, whose datasets are all tailored for image
                    classification. It employs a leave-one-domain-out strategy,
                    wherein each domain serves as the test domain while the
                    remainder are utilized as training domains.
                    Not only does it provide a codebase with strong flexibility
                    enabling the implementation of new algorithms and put
                    previous algorithms together for a fair comparison, but it
                    also pioneers the investigation of a pivotal issue in OOD
                    generalization, namely model selection. It shows the
                    performance gain brought by potential information leakage
                    when using test data for hyperparameter tuning, and designs
                    an automatic hyperparameter random search pipeline that
                    greatly helps mitigate this issue. It advocates model
                    selection using validation data that shares the same
                    distribution with the training one, and leaves the pursuit
                    of a better OOD model selection method as an open
                    problem.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p3">
                  <p class="ltx_p" id="S3.SS1.SSS5.p3.1">SubpopBench <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                        title>68</a>]</cite> is a newly released benchmark for
                    subpopulation shift, consisting of both visual and text
                    datasets.
                    Similar to DomainBed, it also integrates an automatic
                    hyperparameter random search to alleviate the test
                    information leakage.
                    Previously, Idrissi et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib90"
                        title>90</a>]</cite> pointed out that model selection
                    utilizing group labels in validation data greatly
                    contributes to performance improvements. SubpopBench also
                    delves into the problem of model selection and discovers
                    that simply using worst-class accuracy is quite effective
                    even without oracle group labels, leaving ample room for
                    designing a better metric without oracle information in the
                    future.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p4">
                  <p class="ltx_p" id="S3.SS1.SSS5.p4.1">WILDS <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib72"
                        title>72</a>]</cite> is another well-known benchmark
                    featuring abundance in its tasks and data sources that cover
                    a broad spectrum.
                    It puts great efforts into the adaptation of previous large
                    datasets to datasets conducive for OOD evaluation instead of
                    directly employing existing datasets.
                    The benchmark comprises 10 tasks of rich categories,
                    including image classification, image regression, object
                    detection, graph prediction, text classification, and code
                    completion. The sources of images for the visual tasks range
                    from camera-taken photos, satellite pictures, to medical
                    imaging.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p5">
                  <p class="ltx_p" id="S3.SS1.SSS5.p5.1">Despite not being as
                    large as the aforementioned three benchmarks, BREEDS <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib91"
                        title>91</a>]</cite> and NICO++ <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib29"
                        title>29</a>]</cite> are visual benchmarks characterized
                    by special design principles supporting rather flexible
                    settings. BREEDS modifies the WordNet hierarchy based on
                    visual characteristics to build a tree whose leaves
                    correspond to ImageNet classes, and the internal nodes at
                    varying depths in the tree correspond to different levels of
                    superclasses. In this way, researchers can easily manipulate
                    the granularity of the subgroup (subclasses) by adjusting
                    the depth of the classes. Thus BREEDS generates 4 sub-tasks.
                    For NICO++, each category is associated with 10 common
                    domains and 10 unique domains. The common domains remain
                    consistent across all categories, making them well-suited
                    for standard domain generalization tasks. Meanwhile, the 10
                    unique domains of each category can be leveraged for more
                    flexible settings. For example, researchers can choose some
                    common domains as the majority domains and incorporate only
                    a small amount of data from other domains to simulate the
                    domain-imbalanced scenarios akin to subpopulation shift. In
                    fact, a similar adaptation strategy has been adopted by
                    SubpopBench <cite class="ltx_cite ltx_citemacro_cite">[<a
                        class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                        title>68</a>]</cite> to craft such a setting.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p6">
                  <p class="ltx_p" id="S3.SS1.SSS5.p6.1">Recently, GLUE-X <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib81"
                        title>81</a>]</cite> and BOSS <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                        title>82</a>]</cite> have emerged as pioneering
                    initiatives in benchmarking OOD generalization with NLP
                    tasks. GLUE-X includes 8 tasks spanning across 15 datasets,
                    and BOSS includes 5 tasks utilizing 20 datasets. Notably,
                    there is limited overlap between the tasks and datasets
                    utilized by these two benchmarks, rendering them highly
                    complementary in nature. Compared with GLUE-X directly
                    picking OOD datasets concerning each task and the
                    corresponding ID dataset, BOSS conducts probing analyses
                    using SimCSE scores <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib92"
                        title>92</a>]</cite> and identifies pairs of datasets
                    exhibiting the lowest semantic similarity, which are then
                    employed as training and test pairs. Besides, GLUE-X focuses
                    on benchmarking the OOD generalization performance of
                    different pretrained models, and only tests three simple
                    fine-tuning strategies. In contrast, more fine-tuning
                    strategies are considered and tested in BOSS. Neither of
                    them delves into the crucial issue of model selection issue,
                    which is a prominent aspect of visual OOD benchmarks.</p>
                </div>
                <div class="ltx_para" id="S3.SS1.SSS5.p7">
                  <p class="ltx_p" id="S3.SS1.SSS5.p7.4">In the realm of tabular
                    data, although different kinds of natural shifts are
                    frequently employed, current tabular datasets do not
                    adequately capture specific distribution shift patterns
                    (e.g, <math alttext="Y|X" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS5.p7.1.m1.1"><semantics
                        id="S3.SS1.SSS5.p7.1.m1.1a"><mrow
                          id="S3.SS1.SSS5.p7.1.m1.1.1"
                          xref="S3.SS1.SSS5.p7.1.m1.1.1.cmml"><mi
                            id="S3.SS1.SSS5.p7.1.m1.1.1.2"
                            xref="S3.SS1.SSS5.p7.1.m1.1.1.2.cmml">Y</mi><mo
                            fence="false" id="S3.SS1.SSS5.p7.1.m1.1.1.1"
                            xref="S3.SS1.SSS5.p7.1.m1.1.1.1.cmml">|</mo><mi
                            id="S3.SS1.SSS5.p7.1.m1.1.1.3"
                            xref="S3.SS1.SSS5.p7.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS5.p7.1.m1.1b"><apply
                            id="S3.SS1.SSS5.p7.1.m1.1.1.cmml"
                            xref="S3.SS1.SSS5.p7.1.m1.1.1"><csymbol cd="latexml"
                              id="S3.SS1.SSS5.p7.1.m1.1.1.1.cmml"
                              xref="S3.SS1.SSS5.p7.1.m1.1.1.1">conditional</csymbol><ci
                              id="S3.SS1.SSS5.p7.1.m1.1.1.2.cmml"
                              xref="S3.SS1.SSS5.p7.1.m1.1.1.2">𝑌</ci><ci
                              id="S3.SS1.SSS5.p7.1.m1.1.1.3.cmml"
                              xref="S3.SS1.SSS5.p7.1.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS5.p7.1.m1.1c">Y|X</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS5.p7.1.m1.1d">italic_Y |
                          italic_X</annotation></semantics></math>-shifts and
                    <math alttext="X" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS5.p7.2.m2.1"><semantics
                        id="S3.SS1.SSS5.p7.2.m2.1a"><mi
                          id="S3.SS1.SSS5.p7.2.m2.1.1"
                          xref="S3.SS1.SSS5.p7.2.m2.1.1.cmml">X</mi><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS5.p7.2.m2.1b"><ci
                            id="S3.SS1.SSS5.p7.2.m2.1.1.cmml"
                            xref="S3.SS1.SSS5.p7.2.m2.1.1">𝑋</ci></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS5.p7.2.m2.1c">X</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS5.p7.2.m2.1d">italic_X</annotation></semantics></math>-shifts),
                    undermining the practical significance of algorithm
                    evaluations.
                    Recently, to remedy this gap, Liu et al. <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                        title>33</a>]</cite> have released WHYSHIFT.
                    Drawing from open-sourced datasets such as Taxi <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib85"
                        title>85</a>]</cite>, US Accident <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib86"
                        title>86</a>]</cite>, and the ACS dataset <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib12"
                        title>12</a>]</cite>, the WHYSHIFT benchmark <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                        title>33</a>]</cite> encompasses 22 settings that
                    exhibit various <em class="ltx_emph ltx_font_italic"
                      id="S3.SS1.SSS5.p7.4.1">defined</em> distribution shift
                    patterns.
                    They conduct extensive experiments and find that different
                    from visual and text data where covariate shifts on <math
                      alttext="P(X)" class="ltx_Math" display="inline"
                      id="S3.SS1.SSS5.p7.3.m3.1"><semantics
                        id="S3.SS1.SSS5.p7.3.m3.1a"><mrow
                          id="S3.SS1.SSS5.p7.3.m3.1.2"
                          xref="S3.SS1.SSS5.p7.3.m3.1.2.cmml"><mi
                            id="S3.SS1.SSS5.p7.3.m3.1.2.2"
                            xref="S3.SS1.SSS5.p7.3.m3.1.2.2.cmml">P</mi><mo
                            id="S3.SS1.SSS5.p7.3.m3.1.2.1"
                            xref="S3.SS1.SSS5.p7.3.m3.1.2.1.cmml">⁢</mo><mrow
                            id="S3.SS1.SSS5.p7.3.m3.1.2.3.2"
                            xref="S3.SS1.SSS5.p7.3.m3.1.2.cmml"><mo
                              id="S3.SS1.SSS5.p7.3.m3.1.2.3.2.1"
                              stretchy="false"
                              xref="S3.SS1.SSS5.p7.3.m3.1.2.cmml">(</mo><mi
                              id="S3.SS1.SSS5.p7.3.m3.1.1"
                              xref="S3.SS1.SSS5.p7.3.m3.1.1.cmml">X</mi><mo
                              id="S3.SS1.SSS5.p7.3.m3.1.2.3.2.2"
                              stretchy="false"
                              xref="S3.SS1.SSS5.p7.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS5.p7.3.m3.1b"><apply
                            id="S3.SS1.SSS5.p7.3.m3.1.2.cmml"
                            xref="S3.SS1.SSS5.p7.3.m3.1.2"><times
                              id="S3.SS1.SSS5.p7.3.m3.1.2.1.cmml"
                              xref="S3.SS1.SSS5.p7.3.m3.1.2.1"></times><ci
                              id="S3.SS1.SSS5.p7.3.m3.1.2.2.cmml"
                              xref="S3.SS1.SSS5.p7.3.m3.1.2.2">𝑃</ci><ci
                              id="S3.SS1.SSS5.p7.3.m3.1.1.cmml"
                              xref="S3.SS1.SSS5.p7.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS5.p7.3.m3.1c">P(X)</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS5.p7.3.m3.1d">italic_P ( italic_X
                          )</annotation></semantics></math> dominate, concept
                    shifts on <math alttext="P(Y|X)" class="ltx_Math"
                      display="inline" id="S3.SS1.SSS5.p7.4.m4.1"><semantics
                        id="S3.SS1.SSS5.p7.4.m4.1a"><mrow
                          id="S3.SS1.SSS5.p7.4.m4.1.1"
                          xref="S3.SS1.SSS5.p7.4.m4.1.1.cmml"><mi
                            id="S3.SS1.SSS5.p7.4.m4.1.1.3"
                            xref="S3.SS1.SSS5.p7.4.m4.1.1.3.cmml">P</mi><mo
                            id="S3.SS1.SSS5.p7.4.m4.1.1.2"
                            xref="S3.SS1.SSS5.p7.4.m4.1.1.2.cmml">⁢</mo><mrow
                            id="S3.SS1.SSS5.p7.4.m4.1.1.1.1"
                            xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.cmml"><mo
                              id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.2"
                              stretchy="false"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.cmml">(</mo><mrow
                              id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.cmml"><mi
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.2"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.2.cmml">Y</mi><mo
                                fence="false"
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.1"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.1.cmml">|</mo><mi
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.3"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.3.cmml">X</mi></mrow><mo
                              id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.3"
                              stretchy="false"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml
                          encoding="MathML-Content"
                          id="S3.SS1.SSS5.p7.4.m4.1b"><apply
                            id="S3.SS1.SSS5.p7.4.m4.1.1.cmml"
                            xref="S3.SS1.SSS5.p7.4.m4.1.1"><times
                              id="S3.SS1.SSS5.p7.4.m4.1.1.2.cmml"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.2"></times><ci
                              id="S3.SS1.SSS5.p7.4.m4.1.1.3.cmml"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.3">𝑃</ci><apply
                              id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.cmml"
                              xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1"><csymbol
                                cd="latexml"
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.1.cmml"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.1">conditional</csymbol><ci
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.2.cmml"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.2">𝑌</ci><ci
                                id="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.3.cmml"
                                xref="S3.SS1.SSS5.p7.4.m4.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation
                          encoding="application/x-tex"
                          id="S3.SS1.SSS5.p7.4.m4.1c">P(Y|X)</annotation><annotation
                          encoding="application/x-llamapun"
                          id="S3.SS1.SSS5.p7.4.m4.1d">italic_P ( italic_Y |
                          italic_X )</annotation></semantics></math> are
                    prevalent among tabular data.
                    This conforms to our intuition since often there are missing
                    variables that are not collected when establishing the
                    tabular dataset.
                    To investigate in-depth the shift pattern, they propose an
                    algorithm to identify the risky regions, which could help to
                    mitigate the effects of distribution shifts in a
                    data-centric way.
                    Different model selection strategies are also studied, and
                    test information is found to be useful in improving OOD
                    performance, sharing a similar conclusion to DomainBed <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                        title>18</a>]</cite> and SubpopBench <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                        title>68</a>]</cite>.</p>
                </div>
              </section>
              <section class="ltx_subsubsection" id="S3.SS1.SSS6">
                <h4 class="ltx_title ltx_title_subsubsection">
                  <span class="ltx_tag ltx_tag_subsubsection">3.1.6
                  </span>Discussion</h4>
                <div class="ltx_para" id="S3.SS1.SSS6.p1">
                  <p class="ltx_p" id="S3.SS1.SSS6.p1.1">It is a delicate
                    process to create OOD datasets or benchmarks, involving
                    various ways of data collection. Some directly combine
                    datasets from disparate sources <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib61"
                        title>61</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                        title>82</a>]</cite>, some partition an existing dataset
                    into different environments <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib63"
                        title>63</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib91"
                        title>91</a>]</cite>, some leverage search engines for
                    data acquisition <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib93"
                        title>93</a>, <a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib29"
                        title>29</a>]</cite>, and some take new photos with
                    required attributes <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib69"
                        title>69</a>]</cite>.
                    Although semantic perturbations are widely adopted for
                    visual datasets to generate distribution shifts, their
                    application to tabular data is notably challenging since it
                    is difficult to ensure that the outcome variable remains
                    constant when perturbing the covariates.
                    Besides, we note that Spawrious <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib67"
                        title>67</a>]</cite> is completely generated through
                    stable diffusion models. It is worth investigating how data
                    generation through SOTA generative models can help in
                    creating OOD datasets.
                    Moreover, despite the richness of shifts that existing
                    datasets can accommodate, it is not clear whether such
                    shifts described by predefined attributes or collection
                    sources can simulate real scenarios well enough. For
                    instance, there may exist more heterogeneous environment
                    partitions that exhibit a larger and more challenging
                    distribution shift than those defined by readily available
                    environment labels <cite
                      class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                        href="https://arxiv.org/html/2403.01874v1#bib.bib23"
                        title>23</a>]</cite>.
                    Overall, much room is left for the design of OOD datasets
                    and benchmarks.</p>
                </div>
              </section>
            </section>
            <section class="ltx_subsection" id="S3.SS2">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">3.2 </span><span
                  class="ltx_text ltx_font_italic" id="S3.SS2.1.1">Analyzing
                  Performance and Shifts</span>
              </h3>
              <div class="ltx_para" id="S3.SS2.p1">
                <p class="ltx_p" id="S3.SS2.p1.1">After benchmarking the
                  performance of OOD generalization algorithms against various
                  distribution shifts, it is natural to take a further step to
                  analyze the underlying reasons behind their performance and
                  interpret these distribution shifts. This endeavor serves to
                  foster a more profound comprehension of the factors that
                  contribute to the success or failure of algorithms, thereby
                  offering valuable insights for future development of OOD
                  generalization algorithms.</p>
              </div>
              <div class="ltx_para" id="S3.SS2.p2">
                <p class="ltx_p" id="S3.SS2.p2.1">In line with this, Budhathoki
                  et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib94"
                      title>94</a>]</cite> incorporate causal graphs to
                  investigate the cause of distribution shifts.
                  They utilize Shapley values to attribute marginal distribution
                  changes to each covariate.
                  As demonstrated in a case study, this approach assists in
                  identifying the driving factors behind differences, such as
                  income prediction disparities between men and women.
                  Similarly, Zhang et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib95"
                      title>95</a>]</cite> employ Shapley values to quantify the
                  contribution of various distributions to the total performance
                  change.
                  In addition to Shapley values, Kulinski and Inouye <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib96"
                      title>96</a>]</cite> frame the distribution shift as a
                  transport problem and derive an interpretable relaxed optimal
                  transport solution to account for the shifts.</p>
              </div>
              <div class="ltx_para" id="S3.SS2.p3">
                <p class="ltx_p" id="S3.SS2.p3.2">Aside from directly analyzing
                  dataset shifts, there have been efforts to dissect performance
                  degradation in a more detailed manner. Cai et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib32"
                      title>32</a>]</cite> introduce the Distribution Shift
                  Decomposition (DISDE) method to attribute performance decline
                  to different types of distribution shifts, including <math
                    alttext="X" class="ltx_Math" display="inline"
                    id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi
                        id="S3.SS2.p3.1.m1.1.1"
                        xref="S3.SS2.p3.1.m1.1.1.cmml">X</mi><annotation-xml
                        encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci
                          id="S3.SS2.p3.1.m1.1.1.cmml"
                          xref="S3.SS2.p3.1.m1.1.1">𝑋</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S3.SS2.p3.1.m1.1c">X</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S3.SS2.p3.1.m1.1d">italic_X</annotation></semantics></math>-shifts
                  and <math alttext="Y|X" class="ltx_Math" display="inline"
                    id="S3.SS2.p3.2.m2.1"><semantics
                      id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1"
                        xref="S3.SS2.p3.2.m2.1.1.cmml"><mi
                          id="S3.SS2.p3.2.m2.1.1.2"
                          xref="S3.SS2.p3.2.m2.1.1.2.cmml">Y</mi><mo
                          fence="false" id="S3.SS2.p3.2.m2.1.1.1"
                          xref="S3.SS2.p3.2.m2.1.1.1.cmml">|</mo><mi
                          id="S3.SS2.p3.2.m2.1.1.3"
                          xref="S3.SS2.p3.2.m2.1.1.3.cmml">X</mi></mrow><annotation-xml
                        encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply
                          id="S3.SS2.p3.2.m2.1.1.cmml"
                          xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="latexml"
                            id="S3.SS2.p3.2.m2.1.1.1.cmml"
                            xref="S3.SS2.p3.2.m2.1.1.1">conditional</csymbol><ci
                            id="S3.SS2.p3.2.m2.1.1.2.cmml"
                            xref="S3.SS2.p3.2.m2.1.1.2">𝑌</ci><ci
                            id="S3.SS2.p3.2.m2.1.1.3.cmml"
                            xref="S3.SS2.p3.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S3.SS2.p3.2.m2.1c">Y|X</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S3.SS2.p3.2.m2.1d">italic_Y |
                        italic_X</annotation></semantics></math>-shifts.
                  Leveraging shared distribution information, this study
                  explicitly quantifies the performance drop caused by each kind
                  of shift.
                  In response to performance degradation, to offer guidance for
                  further improvements, Liu et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                      title>33</a>]</cite> suggest identifying high-risk regions
                  or subpopulations that are prone to misclassification. Based
                  on this identification, effective non-algorithmic
                  interventions could be designed. Furthermore, they introduce
                  the WHYSHIFT benchmark <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                      title>33</a>]</cite> with specified shift patterns to
                  evaluate algorithms designed for different types of
                  distribution shifts.</p>
              </div>
              <div class="ltx_para" id="S3.SS2.p4">
                <p class="ltx_p" id="S3.SS2.p4.1">While there has been growth in
                  the analysis and interpretation of distribution shifts,
                  applying these techniques to visual or text data remains
                  challenging. For these types of data, concrete case analyses
                  of misclassified examples are adopted at an early stage <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib70"
                      title>70</a>]</cite>. Recent efforts have been made to
                  formally describe and calculate such shifts. For instance,
                  NICO++ <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib29"
                      title>29</a>]</cite> proposes to quantify the covariate
                  shift and concept shift. SubpopBench <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib68"
                      title>68</a>]</cite> classifies shifts into four distinct
                  patterns and employs metrics such as mutual information and
                  entropy for further calculation. Besides, OOD-Bench <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib31"
                      title>31</a>]</cite> decomposes shifts into correlation
                  shift and diversity shift. Overall, it is imperative to devote
                  more attention to bridging the gap between shift analysis and
                  real-world data applications.</p>
              </div>
            </section>
          </section>
          <section class="ltx_section" id="S4">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">4 </span><span
                class="ltx_text ltx_font_smallcaps" id="S4.1.1">OOD performance
                prediction</span>
            </h2>
            <div class="ltx_para" id="S4.p1">
              <p class="ltx_p" id="S4.p1.1">Different from OOD performance
                testing where test data is fully accessible, this field
                represents another dimension of research aimed at predicting the
                performance on the provided unlabeled OOD test data.
                We can illustrate this with an example of medical image
                intelligent systems. These systems serve as auxiliary tools to
                help doctors with their diagnoses. Suppose the models deployed
                on these systems are trained on patient data from Beijing and
                Shanghai. Now we want to explore the possibility of deploying
                these models and systems in Guangzhou hospitals.
                Therefore, we need to predict the OOD performance of these
                models when presented with unlabeled image data collected from
                patients in the new scenario.
                Current works attempt to tackle this challenge from two
                perspectives. Some studies directly focus on the properties of
                model output when applied to the test data, without using
                training data. In contrast, other works employ distribution
                discrepancy or model agreement with the help of training data.
                The former is generally more convenient and flexible, yet the
                latter typically yields superior predictions since they take
                advantage of more information.</p>
            </div>
            <section class="ltx_subsection" id="S4.SS1">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">4.1 </span><span
                  class="ltx_text ltx_font_italic" id="S4.SS1.1.1">Performance
                  Prediction using Model Output Properties on Test Data</span>
              </h3>
              <div class="ltx_para" id="S4.SS1.p1">
                <p class="ltx_p" id="S4.SS1.p1.1">Many works primarily center on
                  harnessing the properties of model output on the test data,
                  including model confidence, prediction dispersity, invariance
                  under certain image transformations, etc.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p2">
                <p class="ltx_p" id="S4.SS1.p2.1">Drawn inspirations from
                  research in OOD detection <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib97"
                      title>97</a>]</cite>, some methods propose metrics related
                  to model confidence, a most commonly used property of model
                  output when predicting OOD performance.
                  These methods often operate under the intuitive assumption
                  that a model’s performance is superior in regions
                  characterized by high confidence levels.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p3">
                <p class="ltx_p" id="S4.SS1.p3.1">Garg et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib41"
                      title>41</a>]</cite> estimate the classification error via
                  Average Threshold Confidence (ATC), the expected fraction of
                  test samples for which the model’s scores fall below a
                  threshold <math alttext="t" class="ltx_Math" display="inline"
                    id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi
                        id="S4.SS1.p3.1.m1.1.1"
                        xref="S4.SS1.p3.1.m1.1.1.cmml">t</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci
                          id="S4.SS1.p3.1.m1.1.1.cmml"
                          xref="S4.SS1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p3.1.m1.1c">t</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p3.1.m1.1d">italic_t</annotation></semantics></math>:</p>
                <table class="ltx_equation ltx_eqn_table" id="S4.E5">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="{\rm ATC}_{P_{te}}(s):=\mathop{\mathbb{E}}\limits_{x\sim P_{te}}[\mathbb{I}[s(%
f_{\theta}(x))&lt;t]]" class="ltx_Math" display="block"
                          id="S4.E5.m1.3"><semantics id="S4.E5.m1.3a"><mrow
                              id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml"><mrow
                                id="S4.E5.m1.3.3.3"
                                xref="S4.E5.m1.3.3.3.cmml"><msub
                                  id="S4.E5.m1.3.3.3.2"
                                  xref="S4.E5.m1.3.3.3.2.cmml"><mi
                                    id="S4.E5.m1.3.3.3.2.2"
                                    xref="S4.E5.m1.3.3.3.2.2.cmml">ATC</mi><msub
                                    id="S4.E5.m1.3.3.3.2.3"
                                    xref="S4.E5.m1.3.3.3.2.3.cmml"><mi
                                      id="S4.E5.m1.3.3.3.2.3.2"
                                      xref="S4.E5.m1.3.3.3.2.3.2.cmml">P</mi><mrow
                                      id="S4.E5.m1.3.3.3.2.3.3"
                                      xref="S4.E5.m1.3.3.3.2.3.3.cmml"><mi
                                        id="S4.E5.m1.3.3.3.2.3.3.2"
                                        xref="S4.E5.m1.3.3.3.2.3.3.2.cmml">t</mi><mo
                                        id="S4.E5.m1.3.3.3.2.3.3.1"
                                        xref="S4.E5.m1.3.3.3.2.3.3.1.cmml">⁢</mo><mi
                                        id="S4.E5.m1.3.3.3.2.3.3.3"
                                        xref="S4.E5.m1.3.3.3.2.3.3.3.cmml">e</mi></mrow></msub></msub><mo
                                  id="S4.E5.m1.3.3.3.1"
                                  xref="S4.E5.m1.3.3.3.1.cmml">⁢</mo><mrow
                                  id="S4.E5.m1.3.3.3.3.2"
                                  xref="S4.E5.m1.3.3.3.cmml"><mo
                                    id="S4.E5.m1.3.3.3.3.2.1" stretchy="false"
                                    xref="S4.E5.m1.3.3.3.cmml">(</mo><mi
                                    id="S4.E5.m1.1.1"
                                    xref="S4.E5.m1.1.1.cmml">s</mi><mo
                                    id="S4.E5.m1.3.3.3.3.2.2" rspace="0.278em"
                                    stretchy="false"
                                    xref="S4.E5.m1.3.3.3.cmml">)</mo></mrow></mrow><mo
                                id="S4.E5.m1.3.3.2"
                                xref="S4.E5.m1.3.3.2.cmml">:=</mo><mrow
                                id="S4.E5.m1.3.3.1"
                                xref="S4.E5.m1.3.3.1.cmml"><munder
                                  id="S4.E5.m1.3.3.1.2"
                                  xref="S4.E5.m1.3.3.1.2.cmml"><mo
                                    id="S4.E5.m1.3.3.1.2.2" lspace="0.111em"
                                    movablelimits="false" rspace="0em"
                                    xref="S4.E5.m1.3.3.1.2.2.cmml">𝔼</mo><mrow
                                    id="S4.E5.m1.3.3.1.2.3"
                                    xref="S4.E5.m1.3.3.1.2.3.cmml"><mi
                                      id="S4.E5.m1.3.3.1.2.3.2"
                                      xref="S4.E5.m1.3.3.1.2.3.2.cmml">x</mi><mo
                                      id="S4.E5.m1.3.3.1.2.3.1"
                                      xref="S4.E5.m1.3.3.1.2.3.1.cmml">∼</mo><msub
                                      id="S4.E5.m1.3.3.1.2.3.3"
                                      xref="S4.E5.m1.3.3.1.2.3.3.cmml"><mi
                                        id="S4.E5.m1.3.3.1.2.3.3.2"
                                        xref="S4.E5.m1.3.3.1.2.3.3.2.cmml">P</mi><mrow
                                        id="S4.E5.m1.3.3.1.2.3.3.3"
                                        xref="S4.E5.m1.3.3.1.2.3.3.3.cmml"><mi
                                          id="S4.E5.m1.3.3.1.2.3.3.3.2"
                                          xref="S4.E5.m1.3.3.1.2.3.3.3.2.cmml">t</mi><mo
                                          id="S4.E5.m1.3.3.1.2.3.3.3.1"
                                          xref="S4.E5.m1.3.3.1.2.3.3.3.1.cmml">⁢</mo><mi
                                          id="S4.E5.m1.3.3.1.2.3.3.3.3"
                                          xref="S4.E5.m1.3.3.1.2.3.3.3.3.cmml">e</mi></mrow></msub></mrow></munder><mrow
                                  id="S4.E5.m1.3.3.1.1.1"
                                  xref="S4.E5.m1.3.3.1.1.2.cmml"><mo
                                    id="S4.E5.m1.3.3.1.1.1.2" stretchy="false"
                                    xref="S4.E5.m1.3.3.1.1.2.1.cmml">[</mo><mrow
                                    id="S4.E5.m1.3.3.1.1.1.1"
                                    xref="S4.E5.m1.3.3.1.1.1.1.cmml"><mi
                                      id="S4.E5.m1.3.3.1.1.1.1.3"
                                      xref="S4.E5.m1.3.3.1.1.1.1.3.cmml">𝕀</mi><mo
                                      id="S4.E5.m1.3.3.1.1.1.1.2"
                                      xref="S4.E5.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow
                                      id="S4.E5.m1.3.3.1.1.1.1.1.1"
                                      xref="S4.E5.m1.3.3.1.1.1.1.1.2.cmml"><mo
                                        id="S4.E5.m1.3.3.1.1.1.1.1.1.2"
                                        stretchy="false"
                                        xref="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow
                                        id="S4.E5.m1.3.3.1.1.1.1.1.1.1"
                                        xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow
                                          id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1"
                                          xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.3"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">s</mi><mo
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.2"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"
                                              stretchy="false"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub
                                                id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"
                                                xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo
                                                id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"
                                                xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow
                                                id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2"
                                                xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1"
                                                  stretchy="false"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi
                                                  id="S4.E5.m1.2.2"
                                                  xref="S4.E5.m1.2.2.cmml">x</mi><mo
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2"
                                                  stretchy="false"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"
                                              stretchy="false"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                          id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2"
                                          xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">&lt;</mo><mi
                                          id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3"
                                          xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml">t</mi></mrow><mo
                                        id="S4.E5.m1.3.3.1.1.1.1.1.1.3"
                                        stretchy="false"
                                        xref="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo
                                    id="S4.E5.m1.3.3.1.1.1.3" stretchy="false"
                                    xref="S4.E5.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S4.E5.m1.3b"><apply
                                id="S4.E5.m1.3.3.cmml"
                                xref="S4.E5.m1.3.3"><csymbol cd="latexml"
                                  id="S4.E5.m1.3.3.2.cmml"
                                  xref="S4.E5.m1.3.3.2">assign</csymbol><apply
                                  id="S4.E5.m1.3.3.3.cmml"
                                  xref="S4.E5.m1.3.3.3"><times
                                    id="S4.E5.m1.3.3.3.1.cmml"
                                    xref="S4.E5.m1.3.3.3.1"></times><apply
                                    id="S4.E5.m1.3.3.3.2.cmml"
                                    xref="S4.E5.m1.3.3.3.2"><csymbol
                                      cd="ambiguous"
                                      id="S4.E5.m1.3.3.3.2.1.cmml"
                                      xref="S4.E5.m1.3.3.3.2">subscript</csymbol><ci
                                      id="S4.E5.m1.3.3.3.2.2.cmml"
                                      xref="S4.E5.m1.3.3.3.2.2">ATC</ci><apply
                                      id="S4.E5.m1.3.3.3.2.3.cmml"
                                      xref="S4.E5.m1.3.3.3.2.3"><csymbol
                                        cd="ambiguous"
                                        id="S4.E5.m1.3.3.3.2.3.1.cmml"
                                        xref="S4.E5.m1.3.3.3.2.3">subscript</csymbol><ci
                                        id="S4.E5.m1.3.3.3.2.3.2.cmml"
                                        xref="S4.E5.m1.3.3.3.2.3.2">𝑃</ci><apply
                                        id="S4.E5.m1.3.3.3.2.3.3.cmml"
                                        xref="S4.E5.m1.3.3.3.2.3.3"><times
                                          id="S4.E5.m1.3.3.3.2.3.3.1.cmml"
                                          xref="S4.E5.m1.3.3.3.2.3.3.1"></times><ci
                                          id="S4.E5.m1.3.3.3.2.3.3.2.cmml"
                                          xref="S4.E5.m1.3.3.3.2.3.3.2">𝑡</ci><ci
                                          id="S4.E5.m1.3.3.3.2.3.3.3.cmml"
                                          xref="S4.E5.m1.3.3.3.2.3.3.3">𝑒</ci></apply></apply></apply><ci
                                    id="S4.E5.m1.1.1.cmml"
                                    xref="S4.E5.m1.1.1">𝑠</ci></apply><apply
                                  id="S4.E5.m1.3.3.1.cmml"
                                  xref="S4.E5.m1.3.3.1"><apply
                                    id="S4.E5.m1.3.3.1.2.cmml"
                                    xref="S4.E5.m1.3.3.1.2"><csymbol
                                      cd="ambiguous"
                                      id="S4.E5.m1.3.3.1.2.1.cmml"
                                      xref="S4.E5.m1.3.3.1.2">subscript</csymbol><ci
                                      id="S4.E5.m1.3.3.1.2.2.cmml"
                                      xref="S4.E5.m1.3.3.1.2.2">𝔼</ci><apply
                                      id="S4.E5.m1.3.3.1.2.3.cmml"
                                      xref="S4.E5.m1.3.3.1.2.3"><csymbol
                                        cd="latexml"
                                        id="S4.E5.m1.3.3.1.2.3.1.cmml"
                                        xref="S4.E5.m1.3.3.1.2.3.1">similar-to</csymbol><ci
                                        id="S4.E5.m1.3.3.1.2.3.2.cmml"
                                        xref="S4.E5.m1.3.3.1.2.3.2">𝑥</ci><apply
                                        id="S4.E5.m1.3.3.1.2.3.3.cmml"
                                        xref="S4.E5.m1.3.3.1.2.3.3"><csymbol
                                          cd="ambiguous"
                                          id="S4.E5.m1.3.3.1.2.3.3.1.cmml"
                                          xref="S4.E5.m1.3.3.1.2.3.3">subscript</csymbol><ci
                                          id="S4.E5.m1.3.3.1.2.3.3.2.cmml"
                                          xref="S4.E5.m1.3.3.1.2.3.3.2">𝑃</ci><apply
                                          id="S4.E5.m1.3.3.1.2.3.3.3.cmml"
                                          xref="S4.E5.m1.3.3.1.2.3.3.3"><times
                                            id="S4.E5.m1.3.3.1.2.3.3.3.1.cmml"
                                            xref="S4.E5.m1.3.3.1.2.3.3.3.1"></times><ci
                                            id="S4.E5.m1.3.3.1.2.3.3.3.2.cmml"
                                            xref="S4.E5.m1.3.3.1.2.3.3.3.2">𝑡</ci><ci
                                            id="S4.E5.m1.3.3.1.2.3.3.3.3.cmml"
                                            xref="S4.E5.m1.3.3.1.2.3.3.3.3">𝑒</ci></apply></apply></apply></apply><apply
                                    id="S4.E5.m1.3.3.1.1.2.cmml"
                                    xref="S4.E5.m1.3.3.1.1.1"><csymbol
                                      cd="latexml"
                                      id="S4.E5.m1.3.3.1.1.2.1.cmml"
                                      xref="S4.E5.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply
                                      id="S4.E5.m1.3.3.1.1.1.1.cmml"
                                      xref="S4.E5.m1.3.3.1.1.1.1"><times
                                        id="S4.E5.m1.3.3.1.1.1.1.2.cmml"
                                        xref="S4.E5.m1.3.3.1.1.1.1.2"></times><ci
                                        id="S4.E5.m1.3.3.1.1.1.1.3.cmml"
                                        xref="S4.E5.m1.3.3.1.1.1.1.3">𝕀</ci><apply
                                        id="S4.E5.m1.3.3.1.1.1.1.1.2.cmml"
                                        xref="S4.E5.m1.3.3.1.1.1.1.1.1"><csymbol
                                          cd="latexml"
                                          id="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml"
                                          xref="S4.E5.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply
                                          id="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml"
                                          xref="S4.E5.m1.3.3.1.1.1.1.1.1.1"><lt
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2"></lt><apply
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1"><times
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.3">𝑠</ci><apply
                                              id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times
                                                id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                                xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply
                                                id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                                xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol
                                                  cd="ambiguous"
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci
                                                  id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"
                                                  xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci
                                                id="S4.E5.m1.2.2.cmml"
                                                xref="S4.E5.m1.2.2">𝑥</ci></apply></apply><ci
                                            id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml"
                                            xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex" id="S4.E5.m1.3c">{\rm
                              ATC}_{P_{te}}(s):=\mathop{\mathbb{E}}\limits_{x\sim
                              P_{te}}[\mathbb{I}[s(%
                              f_{\theta}(x))&lt;t]]</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S4.E5.m1.3d">roman_ATC start_POSTSUBSCRIPT
                              italic_P start_POSTSUBSCRIPT italic_t italic_e
                              end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s )
                              := blackboard_E start_POSTSUBSCRIPT italic_x ∼
                              italic_P start_POSTSUBSCRIPT italic_t italic_e
                              end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ blackboard_I
                              [ italic_s ( italic_f start_POSTSUBSCRIPT italic_θ
                              end_POSTSUBSCRIPT ( italic_x ) ) &lt; italic_t ]
                              ]</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S4.SS1.p3.5">Here <math
                    alttext="f_{\theta}" class="ltx_Math" display="inline"
                    id="S4.SS1.p3.2.m1.1"><semantics
                      id="S4.SS1.p3.2.m1.1a"><msub id="S4.SS1.p3.2.m1.1.1"
                        xref="S4.SS1.p3.2.m1.1.1.cmml"><mi
                          id="S4.SS1.p3.2.m1.1.1.2"
                          xref="S4.SS1.p3.2.m1.1.1.2.cmml">f</mi><mi
                          id="S4.SS1.p3.2.m1.1.1.3"
                          xref="S4.SS1.p3.2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p3.2.m1.1b"><apply
                          id="S4.SS1.p3.2.m1.1.1.cmml"
                          xref="S4.SS1.p3.2.m1.1.1"><csymbol cd="ambiguous"
                            id="S4.SS1.p3.2.m1.1.1.1.cmml"
                            xref="S4.SS1.p3.2.m1.1.1">subscript</csymbol><ci
                            id="S4.SS1.p3.2.m1.1.1.2.cmml"
                            xref="S4.SS1.p3.2.m1.1.1.2">𝑓</ci><ci
                            id="S4.SS1.p3.2.m1.1.1.3.cmml"
                            xref="S4.SS1.p3.2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p3.2.m1.1c">f_{\theta}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p3.2.m1.1d">italic_f start_POSTSUBSCRIPT
                        italic_θ
                        end_POSTSUBSCRIPT</annotation></semantics></math>
                  outputs the probability vector corresponding to each category,
                  while <math alttext="s" class="ltx_Math" display="inline"
                    id="S4.SS1.p3.3.m2.1"><semantics id="S4.SS1.p3.3.m2.1a"><mi
                        id="S4.SS1.p3.3.m2.1.1"
                        xref="S4.SS1.p3.3.m2.1.1.cmml">s</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p3.3.m2.1b"><ci
                          id="S4.SS1.p3.3.m2.1.1.cmml"
                          xref="S4.SS1.p3.3.m2.1.1">𝑠</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p3.3.m2.1c">s</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p3.3.m2.1d">italic_s</annotation></semantics></math>
                  is the score function, chosen as either the maximum confidence
                  value in the vector or the negative entropy. The authors
                  determine the threshold <math alttext="t" class="ltx_Math"
                    display="inline" id="S4.SS1.p3.4.m3.1"><semantics
                      id="S4.SS1.p3.4.m3.1a"><mi id="S4.SS1.p3.4.m3.1.1"
                        xref="S4.SS1.p3.4.m3.1.1.cmml">t</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p3.4.m3.1b"><ci
                          id="S4.SS1.p3.4.m3.1.1.cmml"
                          xref="S4.SS1.p3.4.m3.1.1">𝑡</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p3.4.m3.1c">t</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p3.4.m3.1d">italic_t</annotation></semantics></math>
                  that enables <math alttext="{\rm ATC}_{P_{tr}(s)}"
                    class="ltx_Math" display="inline"
                    id="S4.SS1.p3.5.m4.1"><semantics
                      id="S4.SS1.p3.5.m4.1a"><msub id="S4.SS1.p3.5.m4.1.2"
                        xref="S4.SS1.p3.5.m4.1.2.cmml"><mi
                          id="S4.SS1.p3.5.m4.1.2.2"
                          xref="S4.SS1.p3.5.m4.1.2.2.cmml">ATC</mi><mrow
                          id="S4.SS1.p3.5.m4.1.1.1"
                          xref="S4.SS1.p3.5.m4.1.1.1.cmml"><msub
                            id="S4.SS1.p3.5.m4.1.1.1.3"
                            xref="S4.SS1.p3.5.m4.1.1.1.3.cmml"><mi
                              id="S4.SS1.p3.5.m4.1.1.1.3.2"
                              xref="S4.SS1.p3.5.m4.1.1.1.3.2.cmml">P</mi><mrow
                              id="S4.SS1.p3.5.m4.1.1.1.3.3"
                              xref="S4.SS1.p3.5.m4.1.1.1.3.3.cmml"><mi
                                id="S4.SS1.p3.5.m4.1.1.1.3.3.2"
                                xref="S4.SS1.p3.5.m4.1.1.1.3.3.2.cmml">t</mi><mo
                                id="S4.SS1.p3.5.m4.1.1.1.3.3.1"
                                xref="S4.SS1.p3.5.m4.1.1.1.3.3.1.cmml">⁢</mo><mi
                                id="S4.SS1.p3.5.m4.1.1.1.3.3.3"
                                xref="S4.SS1.p3.5.m4.1.1.1.3.3.3.cmml">r</mi></mrow></msub><mo
                            id="S4.SS1.p3.5.m4.1.1.1.2"
                            xref="S4.SS1.p3.5.m4.1.1.1.2.cmml">⁢</mo><mrow
                            id="S4.SS1.p3.5.m4.1.1.1.4.2"
                            xref="S4.SS1.p3.5.m4.1.1.1.cmml"><mo
                              id="S4.SS1.p3.5.m4.1.1.1.4.2.1" stretchy="false"
                              xref="S4.SS1.p3.5.m4.1.1.1.cmml">(</mo><mi
                              id="S4.SS1.p3.5.m4.1.1.1.1"
                              xref="S4.SS1.p3.5.m4.1.1.1.1.cmml">s</mi><mo
                              id="S4.SS1.p3.5.m4.1.1.1.4.2.2" stretchy="false"
                              xref="S4.SS1.p3.5.m4.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p3.5.m4.1b"><apply
                          id="S4.SS1.p3.5.m4.1.2.cmml"
                          xref="S4.SS1.p3.5.m4.1.2"><csymbol cd="ambiguous"
                            id="S4.SS1.p3.5.m4.1.2.1.cmml"
                            xref="S4.SS1.p3.5.m4.1.2">subscript</csymbol><ci
                            id="S4.SS1.p3.5.m4.1.2.2.cmml"
                            xref="S4.SS1.p3.5.m4.1.2.2">ATC</ci><apply
                            id="S4.SS1.p3.5.m4.1.1.1.cmml"
                            xref="S4.SS1.p3.5.m4.1.1.1"><times
                              id="S4.SS1.p3.5.m4.1.1.1.2.cmml"
                              xref="S4.SS1.p3.5.m4.1.1.1.2"></times><apply
                              id="S4.SS1.p3.5.m4.1.1.1.3.cmml"
                              xref="S4.SS1.p3.5.m4.1.1.1.3"><csymbol
                                cd="ambiguous"
                                id="S4.SS1.p3.5.m4.1.1.1.3.1.cmml"
                                xref="S4.SS1.p3.5.m4.1.1.1.3">subscript</csymbol><ci
                                id="S4.SS1.p3.5.m4.1.1.1.3.2.cmml"
                                xref="S4.SS1.p3.5.m4.1.1.1.3.2">𝑃</ci><apply
                                id="S4.SS1.p3.5.m4.1.1.1.3.3.cmml"
                                xref="S4.SS1.p3.5.m4.1.1.1.3.3"><times
                                  id="S4.SS1.p3.5.m4.1.1.1.3.3.1.cmml"
                                  xref="S4.SS1.p3.5.m4.1.1.1.3.3.1"></times><ci
                                  id="S4.SS1.p3.5.m4.1.1.1.3.3.2.cmml"
                                  xref="S4.SS1.p3.5.m4.1.1.1.3.3.2">𝑡</ci><ci
                                  id="S4.SS1.p3.5.m4.1.1.1.3.3.3.cmml"
                                  xref="S4.SS1.p3.5.m4.1.1.1.3.3.3">𝑟</ci></apply></apply><ci
                              id="S4.SS1.p3.5.m4.1.1.1.1.cmml"
                              xref="S4.SS1.p3.5.m4.1.1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex" id="S4.SS1.p3.5.m4.1c">{\rm
                        ATC}_{P_{tr}(s)}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p3.5.m4.1d">roman_ATC start_POSTSUBSCRIPT
                        italic_P start_POSTSUBSCRIPT italic_t italic_r
                        end_POSTSUBSCRIPT ( italic_s )
                        end_POSTSUBSCRIPT</annotation></semantics></math> to be
                  equal to the training error. They also compare with directly
                  averaging model confidence and find that ATC outperforms it by
                  a large margin.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p4">
                <p class="ltx_p" id="S4.SS1.p4.3">Ng et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib98"
                      title>98</a>]</cite> define the concept of manifold
                  smoothness.</p>
                <table class="ltx_equation ltx_eqn_table" id="S4.E6">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="\mu(f_{\theta},x):=\max_{j\in\mathcal{Y}}\frac{|\{x^{\prime}\in N_{\mathcal{M}%
}(x):f_{\theta}(x^{\prime})=j\}|}{|N_{\mathcal{M}}(x)|}" class="ltx_Math"
                          display="block" id="S4.E6.m1.6"><semantics
                            id="S4.E6.m1.6a"><mrow id="S4.E6.m1.6.6"
                              xref="S4.E6.m1.6.6.cmml"><mrow id="S4.E6.m1.6.6.1"
                                xref="S4.E6.m1.6.6.1.cmml"><mi
                                  id="S4.E6.m1.6.6.1.3"
                                  xref="S4.E6.m1.6.6.1.3.cmml">μ</mi><mo
                                  id="S4.E6.m1.6.6.1.2"
                                  xref="S4.E6.m1.6.6.1.2.cmml">⁢</mo><mrow
                                  id="S4.E6.m1.6.6.1.1.1"
                                  xref="S4.E6.m1.6.6.1.1.2.cmml"><mo
                                    id="S4.E6.m1.6.6.1.1.1.2" stretchy="false"
                                    xref="S4.E6.m1.6.6.1.1.2.cmml">(</mo><msub
                                    id="S4.E6.m1.6.6.1.1.1.1"
                                    xref="S4.E6.m1.6.6.1.1.1.1.cmml"><mi
                                      id="S4.E6.m1.6.6.1.1.1.1.2"
                                      xref="S4.E6.m1.6.6.1.1.1.1.2.cmml">f</mi><mi
                                      id="S4.E6.m1.6.6.1.1.1.1.3"
                                      xref="S4.E6.m1.6.6.1.1.1.1.3.cmml">θ</mi></msub><mo
                                    id="S4.E6.m1.6.6.1.1.1.3"
                                    xref="S4.E6.m1.6.6.1.1.2.cmml">,</mo><mi
                                    id="S4.E6.m1.5.5"
                                    xref="S4.E6.m1.5.5.cmml">x</mi><mo
                                    id="S4.E6.m1.6.6.1.1.1.4" rspace="0.278em"
                                    stretchy="false"
                                    xref="S4.E6.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo
                                id="S4.E6.m1.6.6.2" rspace="0.278em"
                                xref="S4.E6.m1.6.6.2.cmml">:=</mo><mrow
                                id="S4.E6.m1.6.6.3"
                                xref="S4.E6.m1.6.6.3.cmml"><munder
                                  id="S4.E6.m1.6.6.3.1"
                                  xref="S4.E6.m1.6.6.3.1.cmml"><mi
                                    id="S4.E6.m1.6.6.3.1.2"
                                    xref="S4.E6.m1.6.6.3.1.2.cmml">max</mi><mrow
                                    id="S4.E6.m1.6.6.3.1.3"
                                    xref="S4.E6.m1.6.6.3.1.3.cmml"><mi
                                      id="S4.E6.m1.6.6.3.1.3.2"
                                      xref="S4.E6.m1.6.6.3.1.3.2.cmml">j</mi><mo
                                      id="S4.E6.m1.6.6.3.1.3.1"
                                      xref="S4.E6.m1.6.6.3.1.3.1.cmml">∈</mo><mi
                                      class="ltx_font_mathcaligraphic"
                                      id="S4.E6.m1.6.6.3.1.3.3"
                                      xref="S4.E6.m1.6.6.3.1.3.3.cmml">𝒴</mi></mrow></munder><mo
                                  id="S4.E6.m1.6.6.3a" lspace="0.167em"
                                  xref="S4.E6.m1.6.6.3.cmml">⁡</mo><mfrac
                                  id="S4.E6.m1.4.4"
                                  xref="S4.E6.m1.4.4.cmml"><mrow
                                    id="S4.E6.m1.2.2.2.2"
                                    xref="S4.E6.m1.2.2.2.3.cmml"><mo
                                      id="S4.E6.m1.2.2.2.2.2" stretchy="false"
                                      xref="S4.E6.m1.2.2.2.3.1.cmml">|</mo><mrow
                                      id="S4.E6.m1.2.2.2.2.1.2"
                                      xref="S4.E6.m1.2.2.2.2.1.3.cmml"><mo
                                        id="S4.E6.m1.2.2.2.2.1.2.3"
                                        stretchy="false"
                                        xref="S4.E6.m1.2.2.2.2.1.3.1.cmml">{</mo><mrow
                                        id="S4.E6.m1.2.2.2.2.1.1.1"
                                        xref="S4.E6.m1.2.2.2.2.1.1.1.cmml"><msup
                                          id="S4.E6.m1.2.2.2.2.1.1.1.2"
                                          xref="S4.E6.m1.2.2.2.2.1.1.1.2.cmml"><mi
                                            id="S4.E6.m1.2.2.2.2.1.1.1.2.2"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.2.2.cmml">x</mi><mo
                                            id="S4.E6.m1.2.2.2.2.1.1.1.2.3"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.2.3.cmml">′</mo></msup><mo
                                          id="S4.E6.m1.2.2.2.2.1.1.1.1"
                                          xref="S4.E6.m1.2.2.2.2.1.1.1.1.cmml">∈</mo><mrow
                                          id="S4.E6.m1.2.2.2.2.1.1.1.3"
                                          xref="S4.E6.m1.2.2.2.2.1.1.1.3.cmml"><msub
                                            id="S4.E6.m1.2.2.2.2.1.1.1.3.2"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.3.2.cmml"><mi
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.2.2"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.2.2.cmml">N</mi><mi
                                              class="ltx_font_mathcaligraphic"
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.2.3"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.2.3.cmml">ℳ</mi></msub><mo
                                            id="S4.E6.m1.2.2.2.2.1.1.1.3.1"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.3.1.cmml">⁢</mo><mrow
                                            id="S4.E6.m1.2.2.2.2.1.1.1.3.3.2"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.3.cmml"><mo
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.3.2.1"
                                              stretchy="false"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.cmml">(</mo><mi
                                              id="S4.E6.m1.1.1.1.1"
                                              xref="S4.E6.m1.1.1.1.1.cmml">x</mi><mo
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.3.2.2"
                                              rspace="0.278em" stretchy="false"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo
                                        id="S4.E6.m1.2.2.2.2.1.2.4"
                                        rspace="0.278em"
                                        xref="S4.E6.m1.2.2.2.2.1.3.1.cmml">:</mo><mrow
                                        id="S4.E6.m1.2.2.2.2.1.2.2"
                                        xref="S4.E6.m1.2.2.2.2.1.2.2.cmml"><mrow
                                          id="S4.E6.m1.2.2.2.2.1.2.2.1"
                                          xref="S4.E6.m1.2.2.2.2.1.2.2.1.cmml"><msub
                                            id="S4.E6.m1.2.2.2.2.1.2.2.1.3"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.1.3.cmml"><mi
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.3.2"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.3.2.cmml">f</mi><mi
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.3.3"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.3.3.cmml">θ</mi></msub><mo
                                            id="S4.E6.m1.2.2.2.2.1.2.2.1.2"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.1.2.cmml">⁢</mo><mrow
                                            id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.cmml"><mo
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.2"
                                              stretchy="false"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.cmml">(</mo><msup
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.cmml"><mi
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.2"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.2.cmml">x</mi><mo
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.3"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.3"
                                              stretchy="false"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                          id="S4.E6.m1.2.2.2.2.1.2.2.2"
                                          xref="S4.E6.m1.2.2.2.2.1.2.2.2.cmml">=</mo><mi
                                          id="S4.E6.m1.2.2.2.2.1.2.2.3"
                                          xref="S4.E6.m1.2.2.2.2.1.2.2.3.cmml">j</mi></mrow><mo
                                        id="S4.E6.m1.2.2.2.2.1.2.5"
                                        stretchy="false"
                                        xref="S4.E6.m1.2.2.2.2.1.3.1.cmml">}</mo></mrow><mo
                                      id="S4.E6.m1.2.2.2.2.3" stretchy="false"
                                      xref="S4.E6.m1.2.2.2.3.1.cmml">|</mo></mrow><mrow
                                    id="S4.E6.m1.4.4.4.2"
                                    xref="S4.E6.m1.4.4.4.3.cmml"><mo
                                      id="S4.E6.m1.4.4.4.2.2" stretchy="false"
                                      xref="S4.E6.m1.4.4.4.3.1.cmml">|</mo><mrow
                                      id="S4.E6.m1.4.4.4.2.1"
                                      xref="S4.E6.m1.4.4.4.2.1.cmml"><msub
                                        id="S4.E6.m1.4.4.4.2.1.2"
                                        xref="S4.E6.m1.4.4.4.2.1.2.cmml"><mi
                                          id="S4.E6.m1.4.4.4.2.1.2.2"
                                          xref="S4.E6.m1.4.4.4.2.1.2.2.cmml">N</mi><mi
                                          class="ltx_font_mathcaligraphic"
                                          id="S4.E6.m1.4.4.4.2.1.2.3"
                                          xref="S4.E6.m1.4.4.4.2.1.2.3.cmml">ℳ</mi></msub><mo
                                        id="S4.E6.m1.4.4.4.2.1.1"
                                        xref="S4.E6.m1.4.4.4.2.1.1.cmml">⁢</mo><mrow
                                        id="S4.E6.m1.4.4.4.2.1.3.2"
                                        xref="S4.E6.m1.4.4.4.2.1.cmml"><mo
                                          id="S4.E6.m1.4.4.4.2.1.3.2.1"
                                          stretchy="false"
                                          xref="S4.E6.m1.4.4.4.2.1.cmml">(</mo><mi
                                          id="S4.E6.m1.3.3.3.1"
                                          xref="S4.E6.m1.3.3.3.1.cmml">x</mi><mo
                                          id="S4.E6.m1.4.4.4.2.1.3.2.2"
                                          stretchy="false"
                                          xref="S4.E6.m1.4.4.4.2.1.cmml">)</mo></mrow></mrow><mo
                                      id="S4.E6.m1.4.4.4.2.3" stretchy="false"
                                      xref="S4.E6.m1.4.4.4.3.1.cmml">|</mo></mrow></mfrac></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S4.E6.m1.6b"><apply
                                id="S4.E6.m1.6.6.cmml"
                                xref="S4.E6.m1.6.6"><csymbol cd="latexml"
                                  id="S4.E6.m1.6.6.2.cmml"
                                  xref="S4.E6.m1.6.6.2">assign</csymbol><apply
                                  id="S4.E6.m1.6.6.1.cmml"
                                  xref="S4.E6.m1.6.6.1"><times
                                    id="S4.E6.m1.6.6.1.2.cmml"
                                    xref="S4.E6.m1.6.6.1.2"></times><ci
                                    id="S4.E6.m1.6.6.1.3.cmml"
                                    xref="S4.E6.m1.6.6.1.3">𝜇</ci><interval
                                    closure="open" id="S4.E6.m1.6.6.1.1.2.cmml"
                                    xref="S4.E6.m1.6.6.1.1.1"><apply
                                      id="S4.E6.m1.6.6.1.1.1.1.cmml"
                                      xref="S4.E6.m1.6.6.1.1.1.1"><csymbol
                                        cd="ambiguous"
                                        id="S4.E6.m1.6.6.1.1.1.1.1.cmml"
                                        xref="S4.E6.m1.6.6.1.1.1.1">subscript</csymbol><ci
                                        id="S4.E6.m1.6.6.1.1.1.1.2.cmml"
                                        xref="S4.E6.m1.6.6.1.1.1.1.2">𝑓</ci><ci
                                        id="S4.E6.m1.6.6.1.1.1.1.3.cmml"
                                        xref="S4.E6.m1.6.6.1.1.1.1.3">𝜃</ci></apply><ci
                                      id="S4.E6.m1.5.5.cmml"
                                      xref="S4.E6.m1.5.5">𝑥</ci></interval></apply><apply
                                  id="S4.E6.m1.6.6.3.cmml"
                                  xref="S4.E6.m1.6.6.3"><apply
                                    id="S4.E6.m1.6.6.3.1.cmml"
                                    xref="S4.E6.m1.6.6.3.1"><csymbol
                                      cd="ambiguous"
                                      id="S4.E6.m1.6.6.3.1.1.cmml"
                                      xref="S4.E6.m1.6.6.3.1">subscript</csymbol><max
                                      id="S4.E6.m1.6.6.3.1.2.cmml"
                                      xref="S4.E6.m1.6.6.3.1.2"></max><apply
                                      id="S4.E6.m1.6.6.3.1.3.cmml"
                                      xref="S4.E6.m1.6.6.3.1.3"><in
                                        id="S4.E6.m1.6.6.3.1.3.1.cmml"
                                        xref="S4.E6.m1.6.6.3.1.3.1"></in><ci
                                        id="S4.E6.m1.6.6.3.1.3.2.cmml"
                                        xref="S4.E6.m1.6.6.3.1.3.2">𝑗</ci><ci
                                        id="S4.E6.m1.6.6.3.1.3.3.cmml"
                                        xref="S4.E6.m1.6.6.3.1.3.3">𝒴</ci></apply></apply><apply
                                    id="S4.E6.m1.4.4.cmml"
                                    xref="S4.E6.m1.4.4"><divide
                                      id="S4.E6.m1.4.4.5.cmml"
                                      xref="S4.E6.m1.4.4"></divide><apply
                                      id="S4.E6.m1.2.2.2.3.cmml"
                                      xref="S4.E6.m1.2.2.2.2"><abs
                                        id="S4.E6.m1.2.2.2.3.1.cmml"
                                        xref="S4.E6.m1.2.2.2.2.2"></abs><apply
                                        id="S4.E6.m1.2.2.2.2.1.3.cmml"
                                        xref="S4.E6.m1.2.2.2.2.1.2"><csymbol
                                          cd="latexml"
                                          id="S4.E6.m1.2.2.2.2.1.3.1.cmml"
                                          xref="S4.E6.m1.2.2.2.2.1.2.3">conditional-set</csymbol><apply
                                          id="S4.E6.m1.2.2.2.2.1.1.1.cmml"
                                          xref="S4.E6.m1.2.2.2.2.1.1.1"><in
                                            id="S4.E6.m1.2.2.2.2.1.1.1.1.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.1"></in><apply
                                            id="S4.E6.m1.2.2.2.2.1.1.1.2.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.2"><csymbol
                                              cd="ambiguous"
                                              id="S4.E6.m1.2.2.2.2.1.1.1.2.1.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci
                                              id="S4.E6.m1.2.2.2.2.1.1.1.2.2.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.2.2">𝑥</ci><ci
                                              id="S4.E6.m1.2.2.2.2.1.1.1.2.3.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.2.3">′</ci></apply><apply
                                            id="S4.E6.m1.2.2.2.2.1.1.1.3.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.1.1.3"><times
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.1.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.1"></times><apply
                                              id="S4.E6.m1.2.2.2.2.1.1.1.3.2.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.1.1.3.2"><csymbol
                                                cd="ambiguous"
                                                id="S4.E6.m1.2.2.2.2.1.1.1.3.2.1.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.1.1.3.2">subscript</csymbol><ci
                                                id="S4.E6.m1.2.2.2.2.1.1.1.3.2.2.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.1.1.3.2.2">𝑁</ci><ci
                                                id="S4.E6.m1.2.2.2.2.1.1.1.3.2.3.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.1.1.3.2.3">ℳ</ci></apply><ci
                                              id="S4.E6.m1.1.1.1.1.cmml"
                                              xref="S4.E6.m1.1.1.1.1">𝑥</ci></apply></apply><apply
                                          id="S4.E6.m1.2.2.2.2.1.2.2.cmml"
                                          xref="S4.E6.m1.2.2.2.2.1.2.2"><eq
                                            id="S4.E6.m1.2.2.2.2.1.2.2.2.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.2"></eq><apply
                                            id="S4.E6.m1.2.2.2.2.1.2.2.1.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.1"><times
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.2.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.2"></times><apply
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.3.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.3"><csymbol
                                                cd="ambiguous"
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.3.1.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.3">subscript</csymbol><ci
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.3.2.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.3.2">𝑓</ci><ci
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.3.3.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.3.3">𝜃</ci></apply><apply
                                              id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.cmml"
                                              xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1"><csymbol
                                                cd="ambiguous"
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.1.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1">superscript</csymbol><ci
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.2.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.2">𝑥</ci><ci
                                                id="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.3.cmml"
                                                xref="S4.E6.m1.2.2.2.2.1.2.2.1.1.1.1.3">′</ci></apply></apply><ci
                                            id="S4.E6.m1.2.2.2.2.1.2.2.3.cmml"
                                            xref="S4.E6.m1.2.2.2.2.1.2.2.3">𝑗</ci></apply></apply></apply><apply
                                      id="S4.E6.m1.4.4.4.3.cmml"
                                      xref="S4.E6.m1.4.4.4.2"><abs
                                        id="S4.E6.m1.4.4.4.3.1.cmml"
                                        xref="S4.E6.m1.4.4.4.2.2"></abs><apply
                                        id="S4.E6.m1.4.4.4.2.1.cmml"
                                        xref="S4.E6.m1.4.4.4.2.1"><times
                                          id="S4.E6.m1.4.4.4.2.1.1.cmml"
                                          xref="S4.E6.m1.4.4.4.2.1.1"></times><apply
                                          id="S4.E6.m1.4.4.4.2.1.2.cmml"
                                          xref="S4.E6.m1.4.4.4.2.1.2"><csymbol
                                            cd="ambiguous"
                                            id="S4.E6.m1.4.4.4.2.1.2.1.cmml"
                                            xref="S4.E6.m1.4.4.4.2.1.2">subscript</csymbol><ci
                                            id="S4.E6.m1.4.4.4.2.1.2.2.cmml"
                                            xref="S4.E6.m1.4.4.4.2.1.2.2">𝑁</ci><ci
                                            id="S4.E6.m1.4.4.4.2.1.2.3.cmml"
                                            xref="S4.E6.m1.4.4.4.2.1.2.3">ℳ</ci></apply><ci
                                          id="S4.E6.m1.3.3.3.1.cmml"
                                          xref="S4.E6.m1.3.3.3.1">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S4.E6.m1.6c">\mu(f_{\theta},x):=\max_{j\in\mathcal{Y}}\frac{|\{x^{\prime}\in
                              N_{\mathcal{M}%
                              }(x):f_{\theta}(x^{\prime})=j\}|}{|N_{\mathcal{M}}(x)|}</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S4.E6.m1.6d">italic_μ ( italic_f
                              start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ,
                              italic_x ) := roman_max start_POSTSUBSCRIPT
                              italic_j ∈ caligraphic_Y end_POSTSUBSCRIPT divide
                              start_ARG | { italic_x start_POSTSUPERSCRIPT ′
                              end_POSTSUPERSCRIPT ∈ italic_N start_POSTSUBSCRIPT
                              caligraphic_M end_POSTSUBSCRIPT ( italic_x ) :
                              italic_f start_POSTSUBSCRIPT italic_θ
                              end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT
                              ′ end_POSTSUPERSCRIPT ) = italic_j } | end_ARG
                              start_ARG | italic_N start_POSTSUBSCRIPT
                              caligraphic_M end_POSTSUBSCRIPT ( italic_x ) |
                              end_ARG</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S4.SS1.p4.2">where <math
                    alttext="N_{\mathcal{M}}" class="ltx_Math" display="inline"
                    id="S4.SS1.p4.1.m1.1"><semantics
                      id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1"
                        xref="S4.SS1.p4.1.m1.1.1.cmml"><mi
                          id="S4.SS1.p4.1.m1.1.1.2"
                          xref="S4.SS1.p4.1.m1.1.1.2.cmml">N</mi><mi
                          class="ltx_font_mathcaligraphic"
                          id="S4.SS1.p4.1.m1.1.1.3"
                          xref="S4.SS1.p4.1.m1.1.1.3.cmml">ℳ</mi></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply
                          id="S4.SS1.p4.1.m1.1.1.cmml"
                          xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous"
                            id="S4.SS1.p4.1.m1.1.1.1.cmml"
                            xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><ci
                            id="S4.SS1.p4.1.m1.1.1.2.cmml"
                            xref="S4.SS1.p4.1.m1.1.1.2">𝑁</ci><ci
                            id="S4.SS1.p4.1.m1.1.1.3.cmml"
                            xref="S4.SS1.p4.1.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p4.1.m1.1c">N_{\mathcal{M}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p4.1.m1.1d">italic_N start_POSTSUBSCRIPT
                        caligraphic_M
                        end_POSTSUBSCRIPT</annotation></semantics></math> refers
                  to the manifold neighborhood of test point <math alttext="x"
                    class="ltx_Math" display="inline"
                    id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mi
                        id="S4.SS1.p4.2.m2.1.1"
                        xref="S4.SS1.p4.2.m2.1.1.cmml">x</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci
                          id="S4.SS1.p4.2.m2.1.1.cmml"
                          xref="S4.SS1.p4.2.m2.1.1">𝑥</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS1.p4.2.m2.1c">x</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS1.p4.2.m2.1d">italic_x</annotation></semantics></math>.
                  This smoothness metric further utilizes model confidence
                  information in the neighborhood of the test point compared
                  with ATC which only utilizes model confidence information of
                  the test point itself. In their paper, they generate the
                  neighborhood in a straightforward way of data augmentations.
                  They empirically show that the smoothness metric outperforms
                  ATC in terms of OOD performance prediction.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p5">
                <p class="ltx_p" id="S4.SS1.p5.1">Guillory et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib99"
                      title>99</a>]</cite> endeavor to predict OOD performance
                  using the first-order information of model confidence, i.e.
                  Difference of Confidence (DOC). Concretely, they calculate the
                  difference between confidence metrics on test data and
                  training data, where the confidence metric can be maximum
                  confidence or negative entropy. Experiments also demonstrate
                  that DOC outperforms methods that only utilize zeroth-order
                  information of model confidence.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p6">
                <p class="ltx_p" id="S4.SS1.p6.1">Different from model
                  confidence, another two works respectively take a view at the
                  prediction dispersity <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib100"
                      title>100</a>]</cite> and model output invariance under
                  certain transformations <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib101"
                      title>101</a>]</cite>.
                  Deng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib100"
                      title>100</a>]</cite> emphasize the usefulness of
                  dispersity, which measures how diverse and well-distributed
                  model predictions are, in making up for the shortcomings of
                  model confidence when predicting OOD performance. They use the
                  nuclear norm to characterize both confidence and dispersity,
                  and show that the nuclear norm correlates well with OOD
                  performance.
                  Deng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib101"
                      title>101</a>]</cite> explore the relationship between
                  invariance of prediction results under certain transformations
                  and the OOD test accuracy. They experiment with the rotation
                  and grayscale transformations, and uncover that both types of
                  invariance show a strong correlation with test accuracy,
                  suggesting their utility in predicting OOD performance.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p7">
                <p class="ltx_p" id="S4.SS1.p7.1">Besides, Liu et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib102"
                      title>102</a>]</cite> examine the neuron behavior when
                  generating the model output on test data. They propose Neural
                  Activation Coverage (NAC) to measure the activation level of
                  neurons given an input sample. Their underlying assumption is
                  that highly activated neurons are less likely to exhibit
                  errors or anomalies, thus reducing the likelihood of
                  encountering bugs.</p>
              </div>
              <div class="ltx_para" id="S4.SS1.p8">
                <p class="ltx_p" id="S4.SS1.p8.1">Despite the demonstrated
                  efficacy of these methods, as discussed by Garg et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib41"
                      title>41</a>]</cite>, they often struggle to effectively
                  address the subpopulation shift. This challenge is
                  particularly pronounced in methods relying on model
                  confidence.
                  When a majority subpopulation in the training data exhibits a
                  strong correlation with the outcome labels, machine learning
                  models are prone to learning these spurious correlations.
                  Consequently, these models may falter when confronted with
                  test data where a minority subpopulation dominates <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib103"
                      title>103</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib104"
                      title>104</a>]</cite>, even if they maintain a high level
                  of confidence in their predictions for the failure cases.
                  A similar phenomenon ”hallucination” is also observed in LLM
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib34"
                      title>34</a>]</cite>, where models may exhibit unwarranted
                  confidence in entirely erroneous or fabricated situations.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S4.SS2">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">4.2 </span><span
                  class="ltx_text ltx_font_italic" id="S4.SS2.1.1">Distribution
                  Discrepancy based Performance Prediction</span>
              </h3>
              <div class="ltx_para" id="S4.SS2.p1">
                <p class="ltx_p" id="S4.SS2.p1.1">Given access to unlabeled test
                  data, a natural thought is to borrow ideas from the field of
                  Domain Adaptation (DA) <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib13"
                      title>13</a>]</cite> by considering the distribution
                  discrepancy between training data and test data in a space
                  induced by the evaluated model.
                  Compared with methods reliant solely on model output
                  properties on test data, these approaches take advantage of
                  more information embedded in the training data, thus showing
                  greater potential.</p>
              </div>
              <div class="ltx_para" id="S4.SS2.p2">
                <p class="ltx_p" id="S4.SS2.p2.5">In one of the earliest works
                  targeting the OOD performance prediction, Deng et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib42"
                      title>42</a>]</cite> employ the Frechet distance as a
                  measure of distribution discrepancy:</p>
                <table class="ltx_equation ltx_eqn_table" id="S4.E7">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="{\rm FD}(\mathcal{D}_{tr},\mathcal{D}_{te}):=\|\boldsymbol{\mu}_{tr}-%
\boldsymbol{\mu}_{te}\|+{\rm Tr}(\boldsymbol{\Sigma}_{tr}+\boldsymbol{\Sigma}_%
{te}-2(\boldsymbol{\Sigma}_{tr}\boldsymbol{\Sigma}_{te})^{\frac{1}{2}})"
                          class="ltx_Math" display="block"
                          id="S4.E7.m1.4"><semantics id="S4.E7.m1.4a"><mrow
                              id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><mrow
                                id="S4.E7.m1.2.2.2"
                                xref="S4.E7.m1.2.2.2.cmml"><mi
                                  id="S4.E7.m1.2.2.2.4"
                                  xref="S4.E7.m1.2.2.2.4.cmml">FD</mi><mo
                                  id="S4.E7.m1.2.2.2.3"
                                  xref="S4.E7.m1.2.2.2.3.cmml">⁢</mo><mrow
                                  id="S4.E7.m1.2.2.2.2.2"
                                  xref="S4.E7.m1.2.2.2.2.3.cmml"><mo
                                    id="S4.E7.m1.2.2.2.2.2.3" stretchy="false"
                                    xref="S4.E7.m1.2.2.2.2.3.cmml">(</mo><msub
                                    id="S4.E7.m1.1.1.1.1.1.1"
                                    xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi
                                      class="ltx_font_mathcaligraphic"
                                      id="S4.E7.m1.1.1.1.1.1.1.2"
                                      xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow
                                      id="S4.E7.m1.1.1.1.1.1.1.3"
                                      xref="S4.E7.m1.1.1.1.1.1.1.3.cmml"><mi
                                        id="S4.E7.m1.1.1.1.1.1.1.3.2"
                                        xref="S4.E7.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo
                                        id="S4.E7.m1.1.1.1.1.1.1.3.1"
                                        xref="S4.E7.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi
                                        id="S4.E7.m1.1.1.1.1.1.1.3.3"
                                        xref="S4.E7.m1.1.1.1.1.1.1.3.3.cmml">r</mi></mrow></msub><mo
                                    id="S4.E7.m1.2.2.2.2.2.4"
                                    xref="S4.E7.m1.2.2.2.2.3.cmml">,</mo><msub
                                    id="S4.E7.m1.2.2.2.2.2.2"
                                    xref="S4.E7.m1.2.2.2.2.2.2.cmml"><mi
                                      class="ltx_font_mathcaligraphic"
                                      id="S4.E7.m1.2.2.2.2.2.2.2"
                                      xref="S4.E7.m1.2.2.2.2.2.2.2.cmml">𝒟</mi><mrow
                                      id="S4.E7.m1.2.2.2.2.2.2.3"
                                      xref="S4.E7.m1.2.2.2.2.2.2.3.cmml"><mi
                                        id="S4.E7.m1.2.2.2.2.2.2.3.2"
                                        xref="S4.E7.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo
                                        id="S4.E7.m1.2.2.2.2.2.2.3.1"
                                        xref="S4.E7.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi
                                        id="S4.E7.m1.2.2.2.2.2.2.3.3"
                                        xref="S4.E7.m1.2.2.2.2.2.2.3.3.cmml">e</mi></mrow></msub><mo
                                    id="S4.E7.m1.2.2.2.2.2.5" rspace="0.278em"
                                    stretchy="false"
                                    xref="S4.E7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo
                                id="S4.E7.m1.4.4.5" rspace="0.278em"
                                xref="S4.E7.m1.4.4.5.cmml">:=</mo><mrow
                                id="S4.E7.m1.4.4.4"
                                xref="S4.E7.m1.4.4.4.cmml"><mrow
                                  id="S4.E7.m1.3.3.3.1.1"
                                  xref="S4.E7.m1.3.3.3.1.2.cmml"><mo
                                    id="S4.E7.m1.3.3.3.1.1.2" stretchy="false"
                                    xref="S4.E7.m1.3.3.3.1.2.1.cmml">‖</mo><mrow
                                    id="S4.E7.m1.3.3.3.1.1.1"
                                    xref="S4.E7.m1.3.3.3.1.1.1.cmml"><msub
                                      id="S4.E7.m1.3.3.3.1.1.1.2"
                                      xref="S4.E7.m1.3.3.3.1.1.1.2.cmml"><mi
                                        id="S4.E7.m1.3.3.3.1.1.1.2.2"
                                        xref="S4.E7.m1.3.3.3.1.1.1.2.2.cmml">𝝁</mi><mrow
                                        id="S4.E7.m1.3.3.3.1.1.1.2.3"
                                        xref="S4.E7.m1.3.3.3.1.1.1.2.3.cmml"><mi
                                          id="S4.E7.m1.3.3.3.1.1.1.2.3.2"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2.3.2.cmml">t</mi><mo
                                          id="S4.E7.m1.3.3.3.1.1.1.2.3.1"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi
                                          id="S4.E7.m1.3.3.3.1.1.1.2.3.3"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2.3.3.cmml">r</mi></mrow></msub><mo
                                      id="S4.E7.m1.3.3.3.1.1.1.1"
                                      xref="S4.E7.m1.3.3.3.1.1.1.1.cmml">−</mo><msub
                                      id="S4.E7.m1.3.3.3.1.1.1.3"
                                      xref="S4.E7.m1.3.3.3.1.1.1.3.cmml"><mi
                                        id="S4.E7.m1.3.3.3.1.1.1.3.2"
                                        xref="S4.E7.m1.3.3.3.1.1.1.3.2.cmml">𝝁</mi><mrow
                                        id="S4.E7.m1.3.3.3.1.1.1.3.3"
                                        xref="S4.E7.m1.3.3.3.1.1.1.3.3.cmml"><mi
                                          id="S4.E7.m1.3.3.3.1.1.1.3.3.2"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3.3.2.cmml">t</mi><mo
                                          id="S4.E7.m1.3.3.3.1.1.1.3.3.1"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3.3.1.cmml">⁢</mo><mi
                                          id="S4.E7.m1.3.3.3.1.1.1.3.3.3"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3.3.3.cmml">e</mi></mrow></msub></mrow><mo
                                    id="S4.E7.m1.3.3.3.1.1.3" stretchy="false"
                                    xref="S4.E7.m1.3.3.3.1.2.1.cmml">‖</mo></mrow><mo
                                  id="S4.E7.m1.4.4.4.3"
                                  xref="S4.E7.m1.4.4.4.3.cmml">+</mo><mrow
                                  id="S4.E7.m1.4.4.4.2"
                                  xref="S4.E7.m1.4.4.4.2.cmml"><mi
                                    id="S4.E7.m1.4.4.4.2.3"
                                    xref="S4.E7.m1.4.4.4.2.3.cmml">Tr</mi><mo
                                    id="S4.E7.m1.4.4.4.2.2"
                                    xref="S4.E7.m1.4.4.4.2.2.cmml">⁢</mo><mrow
                                    id="S4.E7.m1.4.4.4.2.1.1"
                                    xref="S4.E7.m1.4.4.4.2.1.1.1.cmml"><mo
                                      id="S4.E7.m1.4.4.4.2.1.1.2"
                                      stretchy="false"
                                      xref="S4.E7.m1.4.4.4.2.1.1.1.cmml">(</mo><mrow
                                      id="S4.E7.m1.4.4.4.2.1.1.1"
                                      xref="S4.E7.m1.4.4.4.2.1.1.1.cmml"><mrow
                                        id="S4.E7.m1.4.4.4.2.1.1.1.3"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.3.cmml"><msub
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.2"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.cmml"><mi
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.2.2"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.2.cmml">𝚺</mi><mrow
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.cmml"><mi
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.2"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.2.cmml">t</mi><mo
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.1"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.1.cmml">⁢</mo><mi
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.3"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.3.cmml">r</mi></mrow></msub><mo
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.1"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.1.cmml">+</mo><msub
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.3"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.cmml"><mi
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.3.2"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.2.cmml">𝚺</mi><mrow
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.cmml"><mi
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.2"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.2.cmml">t</mi><mo
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.1"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.1.cmml">⁢</mo><mi
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.3"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.3.cmml">e</mi></mrow></msub></mrow><mo
                                        id="S4.E7.m1.4.4.4.2.1.1.1.2"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.2.cmml">−</mo><mrow
                                        id="S4.E7.m1.4.4.4.2.1.1.1.1"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.1.cmml"><mn
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.3"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.3.cmml">2</mn><mo
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.2"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.2.cmml">⁢</mo><msup
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.1"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.cmml"><mrow
                                            id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml"><mo
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.2"
                                              stretchy="false"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml"><msub
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.cmml"><mi
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.2"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.2.cmml">𝚺</mi><mrow
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.2"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.1"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.3"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.3.cmml">r</mi></mrow></msub><mo
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.1"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.cmml"><mi
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.2"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.2.cmml">𝚺</mi><mrow
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.2"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.1"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi
                                                    id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.3"
                                                    xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.3.cmml">e</mi></mrow></msub></mrow><mo
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.3"
                                              stretchy="false"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mfrac
                                            id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mn
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.2"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.2.cmml">1</mn><mn
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.3"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac></msup></mrow></mrow><mo
                                      id="S4.E7.m1.4.4.4.2.1.1.3"
                                      stretchy="false"
                                      xref="S4.E7.m1.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S4.E7.m1.4b"><apply
                                id="S4.E7.m1.4.4.cmml"
                                xref="S4.E7.m1.4.4"><csymbol cd="latexml"
                                  id="S4.E7.m1.4.4.5.cmml"
                                  xref="S4.E7.m1.4.4.5">assign</csymbol><apply
                                  id="S4.E7.m1.2.2.2.cmml"
                                  xref="S4.E7.m1.2.2.2"><times
                                    id="S4.E7.m1.2.2.2.3.cmml"
                                    xref="S4.E7.m1.2.2.2.3"></times><ci
                                    id="S4.E7.m1.2.2.2.4.cmml"
                                    xref="S4.E7.m1.2.2.2.4">FD</ci><interval
                                    closure="open" id="S4.E7.m1.2.2.2.2.3.cmml"
                                    xref="S4.E7.m1.2.2.2.2.2"><apply
                                      id="S4.E7.m1.1.1.1.1.1.1.cmml"
                                      xref="S4.E7.m1.1.1.1.1.1.1"><csymbol
                                        cd="ambiguous"
                                        id="S4.E7.m1.1.1.1.1.1.1.1.cmml"
                                        xref="S4.E7.m1.1.1.1.1.1.1">subscript</csymbol><ci
                                        id="S4.E7.m1.1.1.1.1.1.1.2.cmml"
                                        xref="S4.E7.m1.1.1.1.1.1.1.2">𝒟</ci><apply
                                        id="S4.E7.m1.1.1.1.1.1.1.3.cmml"
                                        xref="S4.E7.m1.1.1.1.1.1.1.3"><times
                                          id="S4.E7.m1.1.1.1.1.1.1.3.1.cmml"
                                          xref="S4.E7.m1.1.1.1.1.1.1.3.1"></times><ci
                                          id="S4.E7.m1.1.1.1.1.1.1.3.2.cmml"
                                          xref="S4.E7.m1.1.1.1.1.1.1.3.2">𝑡</ci><ci
                                          id="S4.E7.m1.1.1.1.1.1.1.3.3.cmml"
                                          xref="S4.E7.m1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply
                                      id="S4.E7.m1.2.2.2.2.2.2.cmml"
                                      xref="S4.E7.m1.2.2.2.2.2.2"><csymbol
                                        cd="ambiguous"
                                        id="S4.E7.m1.2.2.2.2.2.2.1.cmml"
                                        xref="S4.E7.m1.2.2.2.2.2.2">subscript</csymbol><ci
                                        id="S4.E7.m1.2.2.2.2.2.2.2.cmml"
                                        xref="S4.E7.m1.2.2.2.2.2.2.2">𝒟</ci><apply
                                        id="S4.E7.m1.2.2.2.2.2.2.3.cmml"
                                        xref="S4.E7.m1.2.2.2.2.2.2.3"><times
                                          id="S4.E7.m1.2.2.2.2.2.2.3.1.cmml"
                                          xref="S4.E7.m1.2.2.2.2.2.2.3.1"></times><ci
                                          id="S4.E7.m1.2.2.2.2.2.2.3.2.cmml"
                                          xref="S4.E7.m1.2.2.2.2.2.2.3.2">𝑡</ci><ci
                                          id="S4.E7.m1.2.2.2.2.2.2.3.3.cmml"
                                          xref="S4.E7.m1.2.2.2.2.2.2.3.3">𝑒</ci></apply></apply></interval></apply><apply
                                  id="S4.E7.m1.4.4.4.cmml"
                                  xref="S4.E7.m1.4.4.4"><plus
                                    id="S4.E7.m1.4.4.4.3.cmml"
                                    xref="S4.E7.m1.4.4.4.3"></plus><apply
                                    id="S4.E7.m1.3.3.3.1.2.cmml"
                                    xref="S4.E7.m1.3.3.3.1.1"><csymbol
                                      cd="latexml"
                                      id="S4.E7.m1.3.3.3.1.2.1.cmml"
                                      xref="S4.E7.m1.3.3.3.1.1.2">norm</csymbol><apply
                                      id="S4.E7.m1.3.3.3.1.1.1.cmml"
                                      xref="S4.E7.m1.3.3.3.1.1.1"><minus
                                        id="S4.E7.m1.3.3.3.1.1.1.1.cmml"
                                        xref="S4.E7.m1.3.3.3.1.1.1.1"></minus><apply
                                        id="S4.E7.m1.3.3.3.1.1.1.2.cmml"
                                        xref="S4.E7.m1.3.3.3.1.1.1.2"><csymbol
                                          cd="ambiguous"
                                          id="S4.E7.m1.3.3.3.1.1.1.2.1.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2">subscript</csymbol><ci
                                          id="S4.E7.m1.3.3.3.1.1.1.2.2.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2.2">𝝁</ci><apply
                                          id="S4.E7.m1.3.3.3.1.1.1.2.3.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.2.3"><times
                                            id="S4.E7.m1.3.3.3.1.1.1.2.3.1.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.2.3.1"></times><ci
                                            id="S4.E7.m1.3.3.3.1.1.1.2.3.2.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.2.3.2">𝑡</ci><ci
                                            id="S4.E7.m1.3.3.3.1.1.1.2.3.3.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.2.3.3">𝑟</ci></apply></apply><apply
                                        id="S4.E7.m1.3.3.3.1.1.1.3.cmml"
                                        xref="S4.E7.m1.3.3.3.1.1.1.3"><csymbol
                                          cd="ambiguous"
                                          id="S4.E7.m1.3.3.3.1.1.1.3.1.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3">subscript</csymbol><ci
                                          id="S4.E7.m1.3.3.3.1.1.1.3.2.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3.2">𝝁</ci><apply
                                          id="S4.E7.m1.3.3.3.1.1.1.3.3.cmml"
                                          xref="S4.E7.m1.3.3.3.1.1.1.3.3"><times
                                            id="S4.E7.m1.3.3.3.1.1.1.3.3.1.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.3.3.1"></times><ci
                                            id="S4.E7.m1.3.3.3.1.1.1.3.3.2.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.3.3.2">𝑡</ci><ci
                                            id="S4.E7.m1.3.3.3.1.1.1.3.3.3.cmml"
                                            xref="S4.E7.m1.3.3.3.1.1.1.3.3.3">𝑒</ci></apply></apply></apply></apply><apply
                                    id="S4.E7.m1.4.4.4.2.cmml"
                                    xref="S4.E7.m1.4.4.4.2"><times
                                      id="S4.E7.m1.4.4.4.2.2.cmml"
                                      xref="S4.E7.m1.4.4.4.2.2"></times><ci
                                      id="S4.E7.m1.4.4.4.2.3.cmml"
                                      xref="S4.E7.m1.4.4.4.2.3">Tr</ci><apply
                                      id="S4.E7.m1.4.4.4.2.1.1.1.cmml"
                                      xref="S4.E7.m1.4.4.4.2.1.1"><minus
                                        id="S4.E7.m1.4.4.4.2.1.1.1.2.cmml"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.2"></minus><apply
                                        id="S4.E7.m1.4.4.4.2.1.1.1.3.cmml"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.3"><plus
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.1.cmml"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.1"></plus><apply
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.2.cmml"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.2"><csymbol
                                            cd="ambiguous"
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.2.1.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.2">subscript</csymbol><ci
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.2.2.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.2">𝚺</ci><apply
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3"><times
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.1.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.1"></times><ci
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.2.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.2">𝑡</ci><ci
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.3.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.2.3.3">𝑟</ci></apply></apply><apply
                                          id="S4.E7.m1.4.4.4.2.1.1.1.3.3.cmml"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.3.3"><csymbol
                                            cd="ambiguous"
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.3.1.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.3">subscript</csymbol><ci
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.3.2.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.2">𝚺</ci><apply
                                            id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3"><times
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.1.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.1"></times><ci
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.2.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.2">𝑡</ci><ci
                                              id="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.3.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.3.3.3.3">𝑒</ci></apply></apply></apply><apply
                                        id="S4.E7.m1.4.4.4.2.1.1.1.1.cmml"
                                        xref="S4.E7.m1.4.4.4.2.1.1.1.1"><times
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.2.cmml"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.2"></times><cn
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.3.cmml"
                                          type="integer"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.3">2</cn><apply
                                          id="S4.E7.m1.4.4.4.2.1.1.1.1.1.cmml"
                                          xref="S4.E7.m1.4.4.4.2.1.1.1.1.1"><csymbol
                                            cd="ambiguous"
                                            id="S4.E7.m1.4.4.4.2.1.1.1.1.1.2.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.1.1">superscript</csymbol><apply
                                            id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1"><times
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.1"></times><apply
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2"><csymbol
                                                cd="ambiguous"
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.1.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.2.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.2">𝚺</ci><apply
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3"><times
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.1.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.2.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><ci
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.3.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.2.3.3">𝑟</ci></apply></apply><apply
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3"><csymbol
                                                cd="ambiguous"
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.1.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.2.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.2">𝚺</ci><apply
                                                id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.cmml"
                                                xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3"><times
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.1.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.1"></times><ci
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.2.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci
                                                  id="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.3.cmml"
                                                  xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.1.1.1.3.3.3">𝑒</ci></apply></apply></apply><apply
                                            id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.cmml"
                                            xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3"><divide
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.1.cmml"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3"></divide><cn
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.2.cmml"
                                              type="integer"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.2">1</cn><cn
                                              id="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.3.cmml"
                                              type="integer"
                                              xref="S4.E7.m1.4.4.4.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex" id="S4.E7.m1.4c">{\rm
                              FD}(\mathcal{D}_{tr},\mathcal{D}_{te}):=\|\boldsymbol{\mu}_{tr}-%
                              \boldsymbol{\mu}_{te}\|+{\rm
                              Tr}(\boldsymbol{\Sigma}_{tr}+\boldsymbol{\Sigma}_%
                              {te}-2(\boldsymbol{\Sigma}_{tr}\boldsymbol{\Sigma}_{te})^{\frac{1}{2}})</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S4.E7.m1.4d">roman_FD ( caligraphic_D
                              start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT , caligraphic_D
                              start_POSTSUBSCRIPT italic_t italic_e
                              end_POSTSUBSCRIPT ) := ∥ bold_italic_μ
                              start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT - bold_italic_μ
                              start_POSTSUBSCRIPT italic_t italic_e
                              end_POSTSUBSCRIPT ∥ + roman_Tr ( bold_Σ
                              start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT + bold_Σ start_POSTSUBSCRIPT
                              italic_t italic_e end_POSTSUBSCRIPT - 2 ( bold_Σ
                              start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT bold_Σ start_POSTSUBSCRIPT
                              italic_t italic_e end_POSTSUBSCRIPT )
                              start_POSTSUPERSCRIPT divide start_ARG 1 end_ARG
                              start_ARG 2 end_ARG end_POSTSUPERSCRIPT
                              )</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S4.SS2.p2.4">Here <math
                    alttext="\mathcal{D}_{tr}" class="ltx_Math" display="inline"
                    id="S4.SS2.p2.1.m1.1"><semantics
                      id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1"
                        xref="S4.SS2.p2.1.m1.1.1.cmml"><mi
                          class="ltx_font_mathcaligraphic"
                          id="S4.SS2.p2.1.m1.1.1.2"
                          xref="S4.SS2.p2.1.m1.1.1.2.cmml">𝒟</mi><mrow
                          id="S4.SS2.p2.1.m1.1.1.3"
                          xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi
                            id="S4.SS2.p2.1.m1.1.1.3.2"
                            xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">t</mi><mo
                            id="S4.SS2.p2.1.m1.1.1.3.1"
                            xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi
                            id="S4.SS2.p2.1.m1.1.1.3.3"
                            xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply
                          id="S4.SS2.p2.1.m1.1.1.cmml"
                          xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p2.1.m1.1.1.1.cmml"
                            xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci
                            id="S4.SS2.p2.1.m1.1.1.2.cmml"
                            xref="S4.SS2.p2.1.m1.1.1.2">𝒟</ci><apply
                            id="S4.SS2.p2.1.m1.1.1.3.cmml"
                            xref="S4.SS2.p2.1.m1.1.1.3"><times
                              id="S4.SS2.p2.1.m1.1.1.3.1.cmml"
                              xref="S4.SS2.p2.1.m1.1.1.3.1"></times><ci
                              id="S4.SS2.p2.1.m1.1.1.3.2.cmml"
                              xref="S4.SS2.p2.1.m1.1.1.3.2">𝑡</ci><ci
                              id="S4.SS2.p2.1.m1.1.1.3.3.cmml"
                              xref="S4.SS2.p2.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p2.1.m1.1c">\mathcal{D}_{tr}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT
                        italic_t italic_r
                        end_POSTSUBSCRIPT</annotation></semantics></math> and
                  <math alttext="\mathcal{D}_{te}" class="ltx_Math"
                    display="inline" id="S4.SS2.p2.2.m2.1"><semantics
                      id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1"
                        xref="S4.SS2.p2.2.m2.1.1.cmml"><mi
                          class="ltx_font_mathcaligraphic"
                          id="S4.SS2.p2.2.m2.1.1.2"
                          xref="S4.SS2.p2.2.m2.1.1.2.cmml">𝒟</mi><mrow
                          id="S4.SS2.p2.2.m2.1.1.3"
                          xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi
                            id="S4.SS2.p2.2.m2.1.1.3.2"
                            xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">t</mi><mo
                            id="S4.SS2.p2.2.m2.1.1.3.1"
                            xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi
                            id="S4.SS2.p2.2.m2.1.1.3.3"
                            xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply
                          id="S4.SS2.p2.2.m2.1.1.cmml"
                          xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p2.2.m2.1.1.1.cmml"
                            xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci
                            id="S4.SS2.p2.2.m2.1.1.2.cmml"
                            xref="S4.SS2.p2.2.m2.1.1.2">𝒟</ci><apply
                            id="S4.SS2.p2.2.m2.1.1.3.cmml"
                            xref="S4.SS2.p2.2.m2.1.1.3"><times
                              id="S4.SS2.p2.2.m2.1.1.3.1.cmml"
                              xref="S4.SS2.p2.2.m2.1.1.3.1"></times><ci
                              id="S4.SS2.p2.2.m2.1.1.3.2.cmml"
                              xref="S4.SS2.p2.2.m2.1.1.3.2">𝑡</ci><ci
                              id="S4.SS2.p2.2.m2.1.1.3.3.cmml"
                              xref="S4.SS2.p2.2.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p2.2.m2.1c">\mathcal{D}_{te}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT
                        italic_t italic_e
                        end_POSTSUBSCRIPT</annotation></semantics></math>
                  represent the covariate distributions of training and test
                  data, while <math alttext="\boldsymbol{\mu}" class="ltx_Math"
                    display="inline" id="S4.SS2.p2.3.m3.1"><semantics
                      id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1"
                        xref="S4.SS2.p2.3.m3.1.1.cmml">𝝁</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci
                          id="S4.SS2.p2.3.m3.1.1.cmml"
                          xref="S4.SS2.p2.3.m3.1.1">𝝁</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p2.3.m3.1c">\boldsymbol{\mu}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p2.3.m3.1d">bold_italic_μ</annotation></semantics></math>
                  and <math alttext="\boldsymbol{\Sigma}" class="ltx_Math"
                    display="inline" id="S4.SS2.p2.4.m4.1"><semantics
                      id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1"
                        xref="S4.SS2.p2.4.m4.1.1.cmml">𝚺</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci
                          id="S4.SS2.p2.4.m4.1.1.cmml"
                          xref="S4.SS2.p2.4.m4.1.1">𝚺</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p2.4.m4.1c">\boldsymbol{\Sigma}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p2.4.m4.1d">bold_Σ</annotation></semantics></math>
                  denote the corresponding mean vector and the covariance
                  matrix. This equation is applicable when the covariates are
                  assumed to follow Gaussian distributions. Authors empirically
                  demonstrate that this method outperforms baselines using a
                  confidence threshold.</p>
              </div>
              <div class="ltx_para" id="S4.SS2.p3">
                <p class="ltx_p" id="S4.SS2.p3.8">Yu et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib105"
                      title>105</a>]</cite> depict the distribution discrepancy
                  differently. Given a trained model <math
                    alttext="f_{\hat{\theta}}" class="ltx_Math" display="inline"
                    id="S4.SS2.p3.1.m1.1"><semantics
                      id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1"
                        xref="S4.SS2.p3.1.m1.1.1.cmml"><mi
                          id="S4.SS2.p3.1.m1.1.1.2"
                          xref="S4.SS2.p3.1.m1.1.1.2.cmml">f</mi><mover
                          accent="true" id="S4.SS2.p3.1.m1.1.1.3"
                          xref="S4.SS2.p3.1.m1.1.1.3.cmml"><mi
                            id="S4.SS2.p3.1.m1.1.1.3.2"
                            xref="S4.SS2.p3.1.m1.1.1.3.2.cmml">θ</mi><mo
                            id="S4.SS2.p3.1.m1.1.1.3.1"
                            xref="S4.SS2.p3.1.m1.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply
                          id="S4.SS2.p3.1.m1.1.1.cmml"
                          xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.1.m1.1.1.1.cmml"
                            xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.1.m1.1.1.2.cmml"
                            xref="S4.SS2.p3.1.m1.1.1.2">𝑓</ci><apply
                            id="S4.SS2.p3.1.m1.1.1.3.cmml"
                            xref="S4.SS2.p3.1.m1.1.1.3"><ci
                              id="S4.SS2.p3.1.m1.1.1.3.1.cmml"
                              xref="S4.SS2.p3.1.m1.1.1.3.1">^</ci><ci
                              id="S4.SS2.p3.1.m1.1.1.3.2.cmml"
                              xref="S4.SS2.p3.1.m1.1.1.3.2">𝜃</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.1.m1.1c">f_{\hat{\theta}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT
                        over^ start_ARG italic_θ end_ARG
                        end_POSTSUBSCRIPT</annotation></semantics></math>
                  parameterized by <math alttext="\boldsymbol{\hat{\theta}}"
                    class="ltx_Math" display="inline"
                    id="S4.SS2.p3.2.m2.1"><semantics
                      id="S4.SS2.p3.2.m2.1a"><mover accent="true"
                        id="S4.SS2.p3.2.m2.1.1"
                        xref="S4.SS2.p3.2.m2.1.1.cmml"><mi
                          id="S4.SS2.p3.2.m2.1.1.2"
                          xref="S4.SS2.p3.2.m2.1.1.2.cmml">𝜽</mi><mo
                          id="S4.SS2.p3.2.m2.1.1.1" mathvariant="bold"
                          xref="S4.SS2.p3.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply
                          id="S4.SS2.p3.2.m2.1.1.cmml"
                          xref="S4.SS2.p3.2.m2.1.1"><ci
                            id="S4.SS2.p3.2.m2.1.1.1.cmml"
                            xref="S4.SS2.p3.2.m2.1.1.1">bold-^</ci><ci
                            id="S4.SS2.p3.2.m2.1.1.2.cmml"
                            xref="S4.SS2.p3.2.m2.1.1.2">𝜽</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.2.m2.1c">\boldsymbol{\hat{\theta}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.2.m2.1d">overbold_^ start_ARG
                        bold_italic_θ end_ARG</annotation></semantics></math>,
                  first they assign pseudo labels to the OOD test data via the
                  predictions of <math alttext="f_{\hat{\theta}}"
                    class="ltx_Math" display="inline"
                    id="S4.SS2.p3.3.m3.1"><semantics
                      id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1"
                        xref="S4.SS2.p3.3.m3.1.1.cmml"><mi
                          id="S4.SS2.p3.3.m3.1.1.2"
                          xref="S4.SS2.p3.3.m3.1.1.2.cmml">f</mi><mover
                          accent="true" id="S4.SS2.p3.3.m3.1.1.3"
                          xref="S4.SS2.p3.3.m3.1.1.3.cmml"><mi
                            id="S4.SS2.p3.3.m3.1.1.3.2"
                            xref="S4.SS2.p3.3.m3.1.1.3.2.cmml">θ</mi><mo
                            id="S4.SS2.p3.3.m3.1.1.3.1"
                            xref="S4.SS2.p3.3.m3.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply
                          id="S4.SS2.p3.3.m3.1.1.cmml"
                          xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.3.m3.1.1.1.cmml"
                            xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.3.m3.1.1.2.cmml"
                            xref="S4.SS2.p3.3.m3.1.1.2">𝑓</ci><apply
                            id="S4.SS2.p3.3.m3.1.1.3.cmml"
                            xref="S4.SS2.p3.3.m3.1.1.3"><ci
                              id="S4.SS2.p3.3.m3.1.1.3.1.cmml"
                              xref="S4.SS2.p3.3.m3.1.1.3.1">^</ci><ci
                              id="S4.SS2.p3.3.m3.1.1.3.2.cmml"
                              xref="S4.SS2.p3.3.m3.1.1.3.2">𝜃</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.3.m3.1c">f_{\hat{\theta}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.3.m3.1d">italic_f start_POSTSUBSCRIPT
                        over^ start_ARG italic_θ end_ARG
                        end_POSTSUBSCRIPT</annotation></semantics></math>, then
                  they train a new model <math alttext="f_{\tilde{\theta}}"
                    class="ltx_Math" display="inline"
                    id="S4.SS2.p3.4.m4.1"><semantics
                      id="S4.SS2.p3.4.m4.1a"><msub id="S4.SS2.p3.4.m4.1.1"
                        xref="S4.SS2.p3.4.m4.1.1.cmml"><mi
                          id="S4.SS2.p3.4.m4.1.1.2"
                          xref="S4.SS2.p3.4.m4.1.1.2.cmml">f</mi><mover
                          accent="true" id="S4.SS2.p3.4.m4.1.1.3"
                          xref="S4.SS2.p3.4.m4.1.1.3.cmml"><mi
                            id="S4.SS2.p3.4.m4.1.1.3.2"
                            xref="S4.SS2.p3.4.m4.1.1.3.2.cmml">θ</mi><mo
                            id="S4.SS2.p3.4.m4.1.1.3.1"
                            xref="S4.SS2.p3.4.m4.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply
                          id="S4.SS2.p3.4.m4.1.1.cmml"
                          xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.4.m4.1.1.1.cmml"
                            xref="S4.SS2.p3.4.m4.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.4.m4.1.1.2.cmml"
                            xref="S4.SS2.p3.4.m4.1.1.2">𝑓</ci><apply
                            id="S4.SS2.p3.4.m4.1.1.3.cmml"
                            xref="S4.SS2.p3.4.m4.1.1.3"><ci
                              id="S4.SS2.p3.4.m4.1.1.3.1.cmml"
                              xref="S4.SS2.p3.4.m4.1.1.3.1">~</ci><ci
                              id="S4.SS2.p3.4.m4.1.1.3.2.cmml"
                              xref="S4.SS2.p3.4.m4.1.1.3.2">𝜃</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.4.m4.1c">f_{\tilde{\theta}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.4.m4.1d">italic_f start_POSTSUBSCRIPT
                        over~ start_ARG italic_θ end_ARG
                        end_POSTSUBSCRIPT</annotation></semantics></math> on the
                  pseudo-labeled test data which is initialized from <math
                    alttext="\boldsymbol{\theta_{0}}" class="ltx_Math"
                    display="inline" id="S4.SS2.p3.5.m5.1"><semantics
                      id="S4.SS2.p3.5.m5.1a"><msub id="S4.SS2.p3.5.m5.1.1"
                        xref="S4.SS2.p3.5.m5.1.1.cmml"><mi
                          id="S4.SS2.p3.5.m5.1.1.2"
                          xref="S4.SS2.p3.5.m5.1.1.2.cmml">𝜽</mi><mn
                          id="S4.SS2.p3.5.m5.1.1.3"
                          xref="S4.SS2.p3.5.m5.1.1.3.cmml">𝟎</mn></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply
                          id="S4.SS2.p3.5.m5.1.1.cmml"
                          xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.5.m5.1.1.1.cmml"
                            xref="S4.SS2.p3.5.m5.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.5.m5.1.1.2.cmml"
                            xref="S4.SS2.p3.5.m5.1.1.2">𝜽</ci><cn
                            id="S4.SS2.p3.5.m5.1.1.3.cmml" type="integer"
                            xref="S4.SS2.p3.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.5.m5.1c">\boldsymbol{\theta_{0}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.5.m5.1d">bold_italic_θ start_POSTSUBSCRIPT
                        bold_0
                        end_POSTSUBSCRIPT</annotation></semantics></math>.
                  Finally they train another reference model parameterized by
                  <math alttext="\boldsymbol{\theta_{\rm ref}}" class="ltx_Math"
                    display="inline" id="S4.SS2.p3.6.m6.1"><semantics
                      id="S4.SS2.p3.6.m6.1a"><msub id="S4.SS2.p3.6.m6.1.1"
                        xref="S4.SS2.p3.6.m6.1.1.cmml"><mi
                          id="S4.SS2.p3.6.m6.1.1.2"
                          xref="S4.SS2.p3.6.m6.1.1.2.cmml">𝜽</mi><mi
                          id="S4.SS2.p3.6.m6.1.1.3"
                          xref="S4.SS2.p3.6.m6.1.1.3.cmml">𝐫𝐞𝐟</mi></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply
                          id="S4.SS2.p3.6.m6.1.1.cmml"
                          xref="S4.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.6.m6.1.1.1.cmml"
                            xref="S4.SS2.p3.6.m6.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.6.m6.1.1.2.cmml"
                            xref="S4.SS2.p3.6.m6.1.1.2">𝜽</ci><ci
                            id="S4.SS2.p3.6.m6.1.1.3.cmml"
                            xref="S4.SS2.p3.6.m6.1.1.3">𝐫𝐞𝐟</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.6.m6.1c">\boldsymbol{\theta_{\rm
                        ref}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.6.m6.1d">bold_italic_θ start_POSTSUBSCRIPT
                        bold_ref
                        end_POSTSUBSCRIPT</annotation></semantics></math> using
                  training data, also initialized from <math
                    alttext="\boldsymbol{\theta_{0}}" class="ltx_Math"
                    display="inline" id="S4.SS2.p3.7.m7.1"><semantics
                      id="S4.SS2.p3.7.m7.1a"><msub id="S4.SS2.p3.7.m7.1.1"
                        xref="S4.SS2.p3.7.m7.1.1.cmml"><mi
                          id="S4.SS2.p3.7.m7.1.1.2"
                          xref="S4.SS2.p3.7.m7.1.1.2.cmml">𝜽</mi><mn
                          id="S4.SS2.p3.7.m7.1.1.3"
                          xref="S4.SS2.p3.7.m7.1.1.3.cmml">𝟎</mn></msub><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><apply
                          id="S4.SS2.p3.7.m7.1.1.cmml"
                          xref="S4.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous"
                            id="S4.SS2.p3.7.m7.1.1.1.cmml"
                            xref="S4.SS2.p3.7.m7.1.1">subscript</csymbol><ci
                            id="S4.SS2.p3.7.m7.1.1.2.cmml"
                            xref="S4.SS2.p3.7.m7.1.1.2">𝜽</ci><cn
                            id="S4.SS2.p3.7.m7.1.1.3.cmml" type="integer"
                            xref="S4.SS2.p3.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.7.m7.1c">\boldsymbol{\theta_{0}}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.7.m7.1d">bold_italic_θ start_POSTSUBSCRIPT
                        bold_0
                        end_POSTSUBSCRIPT</annotation></semantics></math>, and
                  they calculate <math
                    alttext="\|\boldsymbol{\tilde{\theta}}-\boldsymbol{\theta_{\rm ref}}\|"
                    class="ltx_Math" display="inline"
                    id="S4.SS2.p3.8.m8.1"><semantics
                      id="S4.SS2.p3.8.m8.1a"><mrow id="S4.SS2.p3.8.m8.1.1.1"
                        xref="S4.SS2.p3.8.m8.1.1.2.cmml"><mo
                          id="S4.SS2.p3.8.m8.1.1.1.2" stretchy="false"
                          xref="S4.SS2.p3.8.m8.1.1.2.1.cmml">‖</mo><mrow
                          id="S4.SS2.p3.8.m8.1.1.1.1"
                          xref="S4.SS2.p3.8.m8.1.1.1.1.cmml"><mover
                            accent="true" id="S4.SS2.p3.8.m8.1.1.1.1.2"
                            xref="S4.SS2.p3.8.m8.1.1.1.1.2.cmml"><mi
                              id="S4.SS2.p3.8.m8.1.1.1.1.2.2"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.2.2.cmml">𝜽</mi><mo
                              id="S4.SS2.p3.8.m8.1.1.1.1.2.1" mathvariant="bold"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.2.1.cmml">~</mo></mover><mo
                            id="S4.SS2.p3.8.m8.1.1.1.1.1"
                            xref="S4.SS2.p3.8.m8.1.1.1.1.1.cmml">−</mo><msub
                            id="S4.SS2.p3.8.m8.1.1.1.1.3"
                            xref="S4.SS2.p3.8.m8.1.1.1.1.3.cmml"><mi
                              id="S4.SS2.p3.8.m8.1.1.1.1.3.2"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.3.2.cmml">𝜽</mi><mi
                              id="S4.SS2.p3.8.m8.1.1.1.1.3.3"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.3.3.cmml">𝐫𝐞𝐟</mi></msub></mrow><mo
                          id="S4.SS2.p3.8.m8.1.1.1.3" stretchy="false"
                          xref="S4.SS2.p3.8.m8.1.1.2.1.cmml">‖</mo></mrow><annotation-xml
                        encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><apply
                          id="S4.SS2.p3.8.m8.1.1.2.cmml"
                          xref="S4.SS2.p3.8.m8.1.1.1"><csymbol cd="latexml"
                            id="S4.SS2.p3.8.m8.1.1.2.1.cmml"
                            xref="S4.SS2.p3.8.m8.1.1.1.2">norm</csymbol><apply
                            id="S4.SS2.p3.8.m8.1.1.1.1.cmml"
                            xref="S4.SS2.p3.8.m8.1.1.1.1"><minus
                              id="S4.SS2.p3.8.m8.1.1.1.1.1.cmml"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.1"></minus><apply
                              id="S4.SS2.p3.8.m8.1.1.1.1.2.cmml"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.2"><ci
                                id="S4.SS2.p3.8.m8.1.1.1.1.2.1.cmml"
                                xref="S4.SS2.p3.8.m8.1.1.1.1.2.1">bold-~</ci><ci
                                id="S4.SS2.p3.8.m8.1.1.1.1.2.2.cmml"
                                xref="S4.SS2.p3.8.m8.1.1.1.1.2.2">𝜽</ci></apply><apply
                              id="S4.SS2.p3.8.m8.1.1.1.1.3.cmml"
                              xref="S4.SS2.p3.8.m8.1.1.1.1.3"><csymbol
                                cd="ambiguous"
                                id="S4.SS2.p3.8.m8.1.1.1.1.3.1.cmml"
                                xref="S4.SS2.p3.8.m8.1.1.1.1.3">subscript</csymbol><ci
                                id="S4.SS2.p3.8.m8.1.1.1.1.3.2.cmml"
                                xref="S4.SS2.p3.8.m8.1.1.1.1.3.2">𝜽</ci><ci
                                id="S4.SS2.p3.8.m8.1.1.1.1.3.3.cmml"
                                xref="S4.SS2.p3.8.m8.1.1.1.1.3.3">𝐫𝐞𝐟</ci></apply></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS2.p3.8.m8.1c">\|\boldsymbol{\tilde{\theta}}-\boldsymbol{\theta_{\rm
                        ref}}\|</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS2.p3.8.m8.1d">∥ overbold_~ start_ARG
                        bold_italic_θ end_ARG - bold_italic_θ
                        start_POSTSUBSCRIPT bold_ref end_POSTSUBSCRIPT
                        ∥</annotation></semantics></math> as the projection
                  norm.
                  Intuitively, the projection norm signifies the norm of the
                  disparity between two sets of parameters that have been
                  trained on training data and test data respectively, thereby
                  assessing the distribution discrepancy to some extent. In
                  fact, in the regime of overparameterized linear models, they
                  theoretically prove that projection norm captures more
                  comprehensive information regarding the covariate shift than
                  the confidence score, playing a similar role as a better
                  discrepancy metric does.</p>
              </div>
              <div class="ltx_para" id="S4.SS2.p4">
                <p class="ltx_p" id="S4.SS2.p4.1">Chuang et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib106"
                      title>106</a>]</cite> employ a two-stage approach. They
                  train a new domain-invariant classifier by aligning the
                  representation of training and test data, and then finetune
                  this classifier by maximizing the disagreement between the new
                  classifier and the model to be evaluated while still
                  preserving the domain-invariant property.
                  A recent work <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib107"
                      title>107</a>]</cite> also predicts OOD performance from
                  the angle of distribution discrepancy. Instead of the
                  covariate shift, the authors focus on pseudo-label shift, i.e.
                  the distance between the predicted label distribution and the
                  ground truth test label distribution.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S4.SS3">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">4.3 </span><span
                  class="ltx_text ltx_font_italic" id="S4.SS3.1.1">Model
                  Agreement based Performance Prediction</span>
              </h3>
              <div class="ltx_para" id="S4.SS3.p1">
                <p class="ltx_p" id="S4.SS3.p1.1">Model agreement was applied in
                  model selection with the help of unlabeled data in binary
                  classification tasks approximately two decades ago <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib108"
                      title>108</a>]</cite>.
                  More recently, a surprising and interesting connection between
                  model agreement and the generalization abilities has come to
                  light in Nakkiran et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib109"
                      title>109</a>]</cite> and Jiang et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib110"
                      title>110</a>]</cite>, while the latter presents a
                  stronger version:
                  For classification tasks, when two models sharing the same
                  network architecture are independently trained on identical
                  datasets with identical sets of hyperparameters, but with
                  variations in random initialization or training batch order,
                  the agreement in their output predictions on In-Distribution
                  (ID) test data approximately equals the test accuracy.
                  Jiang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib110"
                      title>110</a>]</cite> provide theoretical substantiation
                  for this observation. They demonstrate that if the ensemble
                  model is well-calibrated, the aforementioned equality holds,
                  and they empirically confirm that the calibration condition
                  can indeed be satisfied in practical scenarios.</p>
              </div>
              <div class="ltx_para" id="S4.SS3.p2">
                <p class="ltx_p" id="S4.SS3.p2.1">While model agreement has
                  traditionally been explored within the ID context, several
                  works follow up by extending it to the OOD performance
                  prediction. Baek et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib43"
                      title>43</a>]</cite> combine model agreement and the
                  observation of accuracy-on-the-line <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib111"
                      title>111</a>]</cite>. They observe that OOD agreement
                  strongly correlates with ID agreement, i.e.
                  agreement-on-the-line, and the line even shares approximately
                  the same slope and bias with that of OOD accuracy and ID
                  accuracy. Therefore, by fitting a linear regression model
                  between OOD and ID agreement, they can use it to predict OOD
                  accuracy from ID accuracy. They empirically show that this
                  prediction algorithm outperforms some other types of methods
                  like ATC <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib41"
                      title>41</a>]</cite> and projection norm <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib105"
                      title>105</a>]</cite>.</p>
              </div>
              <div class="ltx_para" id="S4.SS3.p3">
                <p class="ltx_p" id="S4.SS3.p3.11">Chen et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib112"
                      title>112</a>]</cite> take advantage of model agreement in
                  an iterative framework. Given the model <math alttext="f"
                    class="ltx_Math" display="inline"
                    id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi
                        id="S4.SS3.p3.1.m1.1.1"
                        xref="S4.SS3.p3.1.m1.1.1.cmml">f</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci
                          id="S4.SS3.p3.1.m1.1.1.cmml"
                          xref="S4.SS3.p3.1.m1.1.1">𝑓</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.1.m1.1c">f</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.1.m1.1d">italic_f</annotation></semantics></math>
                  to be predicted, in each iteration, it learns an ensemble of
                  <math alttext="N" class="ltx_Math" display="inline"
                    id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mi
                        id="S4.SS3.p3.2.m2.1.1"
                        xref="S4.SS3.p3.2.m2.1.1.cmml">N</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci
                          id="S4.SS3.p3.2.m2.1.1.cmml"
                          xref="S4.SS3.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.2.m2.1c">N</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.2.m2.1d">italic_N</annotation></semantics></math>
                  auxiliary models <math alttext="\{h_{i}\}_{i=1}^{N}"
                    class="ltx_Math" display="inline"
                    id="S4.SS3.p3.3.m3.1"><semantics
                      id="S4.SS3.p3.3.m3.1a"><msubsup id="S4.SS3.p3.3.m3.1.1"
                        xref="S4.SS3.p3.3.m3.1.1.cmml"><mrow
                          id="S4.SS3.p3.3.m3.1.1.1.1.1"
                          xref="S4.SS3.p3.3.m3.1.1.1.1.2.cmml"><mo
                            id="S4.SS3.p3.3.m3.1.1.1.1.1.2" stretchy="false"
                            xref="S4.SS3.p3.3.m3.1.1.1.1.2.cmml">{</mo><msub
                            id="S4.SS3.p3.3.m3.1.1.1.1.1.1"
                            xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.cmml"><mi
                              id="S4.SS3.p3.3.m3.1.1.1.1.1.1.2"
                              xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.2.cmml">h</mi><mi
                              id="S4.SS3.p3.3.m3.1.1.1.1.1.1.3"
                              xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo
                            id="S4.SS3.p3.3.m3.1.1.1.1.1.3" stretchy="false"
                            xref="S4.SS3.p3.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow
                          id="S4.SS3.p3.3.m3.1.1.1.3"
                          xref="S4.SS3.p3.3.m3.1.1.1.3.cmml"><mi
                            id="S4.SS3.p3.3.m3.1.1.1.3.2"
                            xref="S4.SS3.p3.3.m3.1.1.1.3.2.cmml">i</mi><mo
                            id="S4.SS3.p3.3.m3.1.1.1.3.1"
                            xref="S4.SS3.p3.3.m3.1.1.1.3.1.cmml">=</mo><mn
                            id="S4.SS3.p3.3.m3.1.1.1.3.3"
                            xref="S4.SS3.p3.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi
                          id="S4.SS3.p3.3.m3.1.1.3"
                          xref="S4.SS3.p3.3.m3.1.1.3.cmml">N</mi></msubsup><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply
                          id="S4.SS3.p3.3.m3.1.1.cmml"
                          xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous"
                            id="S4.SS3.p3.3.m3.1.1.2.cmml"
                            xref="S4.SS3.p3.3.m3.1.1">superscript</csymbol><apply
                            id="S4.SS3.p3.3.m3.1.1.1.cmml"
                            xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous"
                              id="S4.SS3.p3.3.m3.1.1.1.2.cmml"
                              xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><set
                              id="S4.SS3.p3.3.m3.1.1.1.1.2.cmml"
                              xref="S4.SS3.p3.3.m3.1.1.1.1.1"><apply
                                id="S4.SS3.p3.3.m3.1.1.1.1.1.1.cmml"
                                xref="S4.SS3.p3.3.m3.1.1.1.1.1.1"><csymbol
                                  cd="ambiguous"
                                  id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml"
                                  xref="S4.SS3.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci
                                  id="S4.SS3.p3.3.m3.1.1.1.1.1.1.2.cmml"
                                  xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.2">ℎ</ci><ci
                                  id="S4.SS3.p3.3.m3.1.1.1.1.1.1.3.cmml"
                                  xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply
                              id="S4.SS3.p3.3.m3.1.1.1.3.cmml"
                              xref="S4.SS3.p3.3.m3.1.1.1.3"><eq
                                id="S4.SS3.p3.3.m3.1.1.1.3.1.cmml"
                                xref="S4.SS3.p3.3.m3.1.1.1.3.1"></eq><ci
                                id="S4.SS3.p3.3.m3.1.1.1.3.2.cmml"
                                xref="S4.SS3.p3.3.m3.1.1.1.3.2">𝑖</ci><cn
                                id="S4.SS3.p3.3.m3.1.1.1.3.3.cmml"
                                type="integer"
                                xref="S4.SS3.p3.3.m3.1.1.1.3.3">1</cn></apply></apply><ci
                            id="S4.SS3.p3.3.m3.1.1.3.cmml"
                            xref="S4.SS3.p3.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.3.m3.1c">\{h_{i}\}_{i=1}^{N}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.3.m3.1d">{ italic_h start_POSTSUBSCRIPT
                        italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT
                        italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
                        italic_N
                        end_POSTSUPERSCRIPT</annotation></semantics></math> that
                  are trained on the original training set <math alttext="D"
                    class="ltx_Math" display="inline"
                    id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi
                        id="S4.SS3.p3.4.m4.1.1"
                        xref="S4.SS3.p3.4.m4.1.1.cmml">D</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci
                          id="S4.SS3.p3.4.m4.1.1.cmml"
                          xref="S4.SS3.p3.4.m4.1.1">𝐷</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.4.m4.1c">D</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.4.m4.1d">italic_D</annotation></semantics></math>
                  and the pseudo-labeled potentially misclassified test set
                  <math alttext="R" class="ltx_Math" display="inline"
                    id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mi
                        id="S4.SS3.p3.5.m5.1.1"
                        xref="S4.SS3.p3.5.m5.1.1.cmml">R</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci
                          id="S4.SS3.p3.5.m5.1.1.cmml"
                          xref="S4.SS3.p3.5.m5.1.1">𝑅</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.5.m5.1c">R</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.5.m5.1d">italic_R</annotation></semantics></math>,
                  and then pick the data points as <math alttext="R"
                    class="ltx_Math" display="inline"
                    id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mi
                        id="S4.SS3.p3.6.m6.1.1"
                        xref="S4.SS3.p3.6.m6.1.1.cmml">R</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><ci
                          id="S4.SS3.p3.6.m6.1.1.cmml"
                          xref="S4.SS3.p3.6.m6.1.1">𝑅</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.6.m6.1c">R</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.6.m6.1d">italic_R</annotation></semantics></math>
                  on which the trained model <math alttext="f" class="ltx_Math"
                    display="inline" id="S4.SS3.p3.7.m7.1"><semantics
                      id="S4.SS3.p3.7.m7.1a"><mi id="S4.SS3.p3.7.m7.1.1"
                        xref="S4.SS3.p3.7.m7.1.1.cmml">f</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><ci
                          id="S4.SS3.p3.7.m7.1.1.cmml"
                          xref="S4.SS3.p3.7.m7.1.1">𝑓</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.7.m7.1c">f</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.7.m7.1d">italic_f</annotation></semantics></math>
                  and the ensemble model <math alttext="h" class="ltx_Math"
                    display="inline" id="S4.SS3.p3.8.m8.1"><semantics
                      id="S4.SS3.p3.8.m8.1a"><mi id="S4.SS3.p3.8.m8.1.1"
                        xref="S4.SS3.p3.8.m8.1.1.cmml">h</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><ci
                          id="S4.SS3.p3.8.m8.1.1.cmml"
                          xref="S4.SS3.p3.8.m8.1.1">ℎ</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.8.m8.1c">h</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.8.m8.1d">italic_h</annotation></semantics></math>
                  disagrees. The new <math alttext="R" class="ltx_Math"
                    display="inline" id="S4.SS3.p3.9.m9.1"><semantics
                      id="S4.SS3.p3.9.m9.1a"><mi id="S4.SS3.p3.9.m9.1.1"
                        xref="S4.SS3.p3.9.m9.1.1.cmml">R</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><ci
                          id="S4.SS3.p3.9.m9.1.1.cmml"
                          xref="S4.SS3.p3.9.m9.1.1">𝑅</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.9.m9.1c">R</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.9.m9.1d">italic_R</annotation></semantics></math>
                  is labeled as the output of <math alttext="h" class="ltx_Math"
                    display="inline" id="S4.SS3.p3.10.m10.1"><semantics
                      id="S4.SS3.p3.10.m10.1a"><mi id="S4.SS3.p3.10.m10.1.1"
                        xref="S4.SS3.p3.10.m10.1.1.cmml">h</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><ci
                          id="S4.SS3.p3.10.m10.1.1.cmml"
                          xref="S4.SS3.p3.10.m10.1.1">ℎ</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.10.m10.1c">h</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.10.m10.1d">italic_h</annotation></semantics></math>,
                  i.e. the majority vote of the <math alttext="N"
                    class="ltx_Math" display="inline"
                    id="S4.SS3.p3.11.m11.1"><semantics
                      id="S4.SS3.p3.11.m11.1a"><mi id="S4.SS3.p3.11.m11.1.1"
                        xref="S4.SS3.p3.11.m11.1.1.cmml">N</mi><annotation-xml
                        encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><ci
                          id="S4.SS3.p3.11.m11.1.1.cmml"
                          xref="S4.SS3.p3.11.m11.1.1">𝑁</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S4.SS3.p3.11.m11.1c">N</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S4.SS3.p3.11.m11.1d">italic_N</annotation></semantics></math>
                  auxiliary models. This iterative approach not only enables the
                  estimation of OOD accuracy, but can also output the potential
                  misclassified data points. However, this method bears larger
                  computational burdens due to the necessity of training
                  multiple auxiliary models.</p>
              </div>
              <div class="ltx_para" id="S4.SS3.p4">
                <p class="ltx_p" id="S4.SS3.p4.1">Though powerful and effective,
                  neither accuracy-on-the-line nor agreement-on-the-line hold
                  under all kinds of OOD scenarios, and Baek et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib43"
                      title>43</a>]</cite> do not consider such agreement-based
                  methods as universally applicable.
                  In Kirsch et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib113"
                      title>113</a>]</cite>, authors question the satisfaction
                  of the ensemble model’s calibration when the disagreement
                  increases, and they modify the theoretical analysis in a
                  Bayesian probabilistic context.
                  In Jiang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib114"
                      title>114</a>]</cite>, authors propose a new theoretical
                  framework of feature learning and apply it to explore the
                  boundary of agreement-based methods. They re-partition the
                  data by the proportion of blue intensity to change the ratio
                  of the number of rare features to that of dominant features,
                  which in their theory will lead to the inconsistency between
                  model agreement and test accuracy.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S4.SS4">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">4.4 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S4.SS4.1.1">Discussion</span>
              </h3>
              <div class="ltx_para" id="S4.SS4.p1">
                <p class="ltx_p" id="S4.SS4.p1.1">OOD performance prediction is
                  an important paradigm for evaluating the OOD generalization
                  ability without doubt, and much improvement has been made in
                  existing works from various perspectives.
                  However, there have been few works discussing the relationship
                  and difference between various types of methods. Trivedi et
                  al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib115"
                      title>115</a>]</cite> empirically show the advantages of
                  agreement-based methods compared with confidence-based ones.
                  Other types of methods have not been fully discussed.
                  Also, few works have well characterized the application range,
                  i.e. the type of distribution shift under which the proposed
                  method can exhibit a good OOD prediction performance. Most
                  works implicitly address the covariate-shift setting, while
                  Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib116"
                      title>116</a>]</cite> study the case where both label
                  shift and sparse covariate shift exist.
                  Besides, we note that current works focus on evaluating models
                  of different network architectures with ERM training. It would
                  be beneficial to explore the application of OOD performance
                  prediction techniques to existing OOD generalization
                  algorithms beyond the scope of ERM.</p>
              </div>
            </section>
          </section>
          <section class="ltx_section" id="S5">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">5 </span><span
                class="ltx_text ltx_font_smallcaps" id="S5.1.1">OOD intrinsic
                property characterization</span>
            </h2>
            <div class="ltx_para" id="S5.p1">
              <p class="ltx_p" id="S5.p1.1">In high-stakes applications like
                healthcare, understanding an algorithm or model’s limitations in
                advance is of utmost importance.
                For instance, when deploying a model for autonomous driving, it
                is critical for ML researchers to anticipate its performance
                across different road conditions, weather conditions, traffic
                rules, etc.
                The challenge lies in the fact that typically, only historical
                data is available, with limited insight into prospective driving
                environments (the test data).
                This circumstance introduces an even more complex problem
                compared to the aforementioned OOD performance testing and
                prediction.
                The pressing question thus becomes: how can we comprehend the
                <em class="ltx_emph ltx_font_italic"
                  id="S5.p1.1.1">inherent</em> characteristics of ML models in
                such a way that facilitates generalization under potential
                distribution shifts? We introduce from four perspectives:
                Distributional robustness, stability, invariance, and flatness.
                These perspectives connect closely to existing OOD
                generalization algorithms, like DRO, invariant learning, and
                flatness-aware optimizers, while their mutual connections are
                still under investigation.</p>
            </div>
            <section class="ltx_subsection" id="S5.SS1">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">5.1 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S5.SS1.1.1">Distributional Robustness</span>
              </h3>
              <div class="ltx_para" id="S5.SS1.p1">
                <p class="ltx_p" id="S5.SS1.p1.5">Emerging from the field of
                  operations research, distributionally robust optimization
                  (DRO) has attracted increased research attention in machine
                  learning, which addresses the worst-case risk within a
                  pre-defined uncertainty set.
                  The risk objective of DRO usually takes the form of</p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E8">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="\mathcal{R}(\theta):=\sup_{Q\in\mathcal{P}(P_{tr})}\mathbb{E}_{X,Y\sim Q}[\ell%
(f_{\theta}(X),Y)]," class="ltx_Math" display="block" id="S5.E8.m1.7"><semantics
                            id="S5.E8.m1.7a"><mrow id="S5.E8.m1.7.7.1"
                              xref="S5.E8.m1.7.7.1.1.cmml"><mrow
                                id="S5.E8.m1.7.7.1.1"
                                xref="S5.E8.m1.7.7.1.1.cmml"><mrow
                                  id="S5.E8.m1.7.7.1.1.3"
                                  xref="S5.E8.m1.7.7.1.1.3.cmml"><mi
                                    class="ltx_font_mathcaligraphic"
                                    id="S5.E8.m1.7.7.1.1.3.2"
                                    xref="S5.E8.m1.7.7.1.1.3.2.cmml">ℛ</mi><mo
                                    id="S5.E8.m1.7.7.1.1.3.1"
                                    xref="S5.E8.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow
                                    id="S5.E8.m1.7.7.1.1.3.3.2"
                                    xref="S5.E8.m1.7.7.1.1.3.cmml"><mo
                                      id="S5.E8.m1.7.7.1.1.3.3.2.1"
                                      stretchy="false"
                                      xref="S5.E8.m1.7.7.1.1.3.cmml">(</mo><mi
                                      id="S5.E8.m1.4.4"
                                      xref="S5.E8.m1.4.4.cmml">θ</mi><mo
                                      id="S5.E8.m1.7.7.1.1.3.3.2.2"
                                      rspace="0.278em" stretchy="false"
                                      xref="S5.E8.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo
                                  id="S5.E8.m1.7.7.1.1.2"
                                  xref="S5.E8.m1.7.7.1.1.2.cmml">:=</mo><mrow
                                  id="S5.E8.m1.7.7.1.1.1"
                                  xref="S5.E8.m1.7.7.1.1.1.cmml"><munder
                                    id="S5.E8.m1.7.7.1.1.1.2"
                                    xref="S5.E8.m1.7.7.1.1.1.2.cmml"><mo
                                      id="S5.E8.m1.7.7.1.1.1.2.2"
                                      lspace="0.111em" movablelimits="false"
                                      rspace="0.167em"
                                      xref="S5.E8.m1.7.7.1.1.1.2.2.cmml">sup</mo><mrow
                                      id="S5.E8.m1.1.1.1"
                                      xref="S5.E8.m1.1.1.1.cmml"><mi
                                        id="S5.E8.m1.1.1.1.3"
                                        xref="S5.E8.m1.1.1.1.3.cmml">Q</mi><mo
                                        id="S5.E8.m1.1.1.1.2"
                                        xref="S5.E8.m1.1.1.1.2.cmml">∈</mo><mrow
                                        id="S5.E8.m1.1.1.1.1"
                                        xref="S5.E8.m1.1.1.1.1.cmml"><mi
                                          class="ltx_font_mathcaligraphic"
                                          id="S5.E8.m1.1.1.1.1.3"
                                          xref="S5.E8.m1.1.1.1.1.3.cmml">𝒫</mi><mo
                                          id="S5.E8.m1.1.1.1.1.2"
                                          xref="S5.E8.m1.1.1.1.1.2.cmml">⁢</mo><mrow
                                          id="S5.E8.m1.1.1.1.1.1.1"
                                          xref="S5.E8.m1.1.1.1.1.1.1.1.cmml"><mo
                                            id="S5.E8.m1.1.1.1.1.1.1.2"
                                            stretchy="false"
                                            xref="S5.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><msub
                                            id="S5.E8.m1.1.1.1.1.1.1.1"
                                            xref="S5.E8.m1.1.1.1.1.1.1.1.cmml"><mi
                                              id="S5.E8.m1.1.1.1.1.1.1.1.2"
                                              xref="S5.E8.m1.1.1.1.1.1.1.1.2.cmml">P</mi><mrow
                                              id="S5.E8.m1.1.1.1.1.1.1.1.3"
                                              xref="S5.E8.m1.1.1.1.1.1.1.1.3.cmml"><mi
                                                id="S5.E8.m1.1.1.1.1.1.1.1.3.2"
                                                xref="S5.E8.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo
                                                id="S5.E8.m1.1.1.1.1.1.1.1.3.1"
                                                xref="S5.E8.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi
                                                id="S5.E8.m1.1.1.1.1.1.1.1.3.3"
                                                xref="S5.E8.m1.1.1.1.1.1.1.1.3.3.cmml">r</mi></mrow></msub><mo
                                            id="S5.E8.m1.1.1.1.1.1.1.3"
                                            stretchy="false"
                                            xref="S5.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow
                                    id="S5.E8.m1.7.7.1.1.1.1"
                                    xref="S5.E8.m1.7.7.1.1.1.1.cmml"><msub
                                      id="S5.E8.m1.7.7.1.1.1.1.3"
                                      xref="S5.E8.m1.7.7.1.1.1.1.3.cmml"><mi
                                        id="S5.E8.m1.7.7.1.1.1.1.3.2"
                                        xref="S5.E8.m1.7.7.1.1.1.1.3.2.cmml">𝔼</mi><mrow
                                        id="S5.E8.m1.3.3.2"
                                        xref="S5.E8.m1.3.3.2.cmml"><mrow
                                          id="S5.E8.m1.3.3.2.4.2"
                                          xref="S5.E8.m1.3.3.2.4.1.cmml"><mi
                                            id="S5.E8.m1.2.2.1.1"
                                            xref="S5.E8.m1.2.2.1.1.cmml">X</mi><mo
                                            id="S5.E8.m1.3.3.2.4.2.1"
                                            xref="S5.E8.m1.3.3.2.4.1.cmml">,</mo><mi
                                            id="S5.E8.m1.3.3.2.2"
                                            xref="S5.E8.m1.3.3.2.2.cmml">Y</mi></mrow><mo
                                          id="S5.E8.m1.3.3.2.3"
                                          xref="S5.E8.m1.3.3.2.3.cmml">∼</mo><mi
                                          id="S5.E8.m1.3.3.2.5"
                                          xref="S5.E8.m1.3.3.2.5.cmml">Q</mi></mrow></msub><mo
                                      id="S5.E8.m1.7.7.1.1.1.1.2"
                                      xref="S5.E8.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow
                                      id="S5.E8.m1.7.7.1.1.1.1.1.1"
                                      xref="S5.E8.m1.7.7.1.1.1.1.1.2.cmml"><mo
                                        id="S5.E8.m1.7.7.1.1.1.1.1.1.2"
                                        stretchy="false"
                                        xref="S5.E8.m1.7.7.1.1.1.1.1.2.1.cmml">[</mo><mrow
                                        id="S5.E8.m1.7.7.1.1.1.1.1.1.1"
                                        xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.cmml"><mi
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.3"
                                          mathvariant="normal"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.3.cmml">ℓ</mi><mo
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.2"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo
                                            id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2"
                                            stretchy="false"
                                            xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow
                                            id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1"
                                            xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msub
                                              id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"
                                              xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo
                                              id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"
                                              xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow
                                              id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"
                                              xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1"
                                                stretchy="false"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi
                                                id="S5.E8.m1.5.5"
                                                xref="S5.E8.m1.5.5.cmml">X</mi><mo
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2"
                                                stretchy="false"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                            id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.3"
                                            xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi
                                            id="S5.E8.m1.6.6"
                                            xref="S5.E8.m1.6.6.cmml">Y</mi><mo
                                            id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.4"
                                            stretchy="false"
                                            xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo
                                        id="S5.E8.m1.7.7.1.1.1.1.1.1.3"
                                        stretchy="false"
                                        xref="S5.E8.m1.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo
                                id="S5.E8.m1.7.7.1.2"
                                xref="S5.E8.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml
                              encoding="MathML-Content" id="S5.E8.m1.7b"><apply
                                id="S5.E8.m1.7.7.1.1.cmml"
                                xref="S5.E8.m1.7.7.1"><csymbol cd="latexml"
                                  id="S5.E8.m1.7.7.1.1.2.cmml"
                                  xref="S5.E8.m1.7.7.1.1.2">assign</csymbol><apply
                                  id="S5.E8.m1.7.7.1.1.3.cmml"
                                  xref="S5.E8.m1.7.7.1.1.3"><times
                                    id="S5.E8.m1.7.7.1.1.3.1.cmml"
                                    xref="S5.E8.m1.7.7.1.1.3.1"></times><ci
                                    id="S5.E8.m1.7.7.1.1.3.2.cmml"
                                    xref="S5.E8.m1.7.7.1.1.3.2">ℛ</ci><ci
                                    id="S5.E8.m1.4.4.cmml"
                                    xref="S5.E8.m1.4.4">𝜃</ci></apply><apply
                                  id="S5.E8.m1.7.7.1.1.1.cmml"
                                  xref="S5.E8.m1.7.7.1.1.1"><apply
                                    id="S5.E8.m1.7.7.1.1.1.2.cmml"
                                    xref="S5.E8.m1.7.7.1.1.1.2"><csymbol
                                      cd="ambiguous"
                                      id="S5.E8.m1.7.7.1.1.1.2.1.cmml"
                                      xref="S5.E8.m1.7.7.1.1.1.2">subscript</csymbol><csymbol
                                      cd="latexml"
                                      id="S5.E8.m1.7.7.1.1.1.2.2.cmml"
                                      xref="S5.E8.m1.7.7.1.1.1.2.2">supremum</csymbol><apply
                                      id="S5.E8.m1.1.1.1.cmml"
                                      xref="S5.E8.m1.1.1.1"><in
                                        id="S5.E8.m1.1.1.1.2.cmml"
                                        xref="S5.E8.m1.1.1.1.2"></in><ci
                                        id="S5.E8.m1.1.1.1.3.cmml"
                                        xref="S5.E8.m1.1.1.1.3">𝑄</ci><apply
                                        id="S5.E8.m1.1.1.1.1.cmml"
                                        xref="S5.E8.m1.1.1.1.1"><times
                                          id="S5.E8.m1.1.1.1.1.2.cmml"
                                          xref="S5.E8.m1.1.1.1.1.2"></times><ci
                                          id="S5.E8.m1.1.1.1.1.3.cmml"
                                          xref="S5.E8.m1.1.1.1.1.3">𝒫</ci><apply
                                          id="S5.E8.m1.1.1.1.1.1.1.1.cmml"
                                          xref="S5.E8.m1.1.1.1.1.1.1"><csymbol
                                            cd="ambiguous"
                                            id="S5.E8.m1.1.1.1.1.1.1.1.1.cmml"
                                            xref="S5.E8.m1.1.1.1.1.1.1">subscript</csymbol><ci
                                            id="S5.E8.m1.1.1.1.1.1.1.1.2.cmml"
                                            xref="S5.E8.m1.1.1.1.1.1.1.1.2">𝑃</ci><apply
                                            id="S5.E8.m1.1.1.1.1.1.1.1.3.cmml"
                                            xref="S5.E8.m1.1.1.1.1.1.1.1.3"><times
                                              id="S5.E8.m1.1.1.1.1.1.1.1.3.1.cmml"
                                              xref="S5.E8.m1.1.1.1.1.1.1.1.3.1"></times><ci
                                              id="S5.E8.m1.1.1.1.1.1.1.1.3.2.cmml"
                                              xref="S5.E8.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci
                                              id="S5.E8.m1.1.1.1.1.1.1.1.3.3.cmml"
                                              xref="S5.E8.m1.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></apply></apply><apply
                                    id="S5.E8.m1.7.7.1.1.1.1.cmml"
                                    xref="S5.E8.m1.7.7.1.1.1.1"><times
                                      id="S5.E8.m1.7.7.1.1.1.1.2.cmml"
                                      xref="S5.E8.m1.7.7.1.1.1.1.2"></times><apply
                                      id="S5.E8.m1.7.7.1.1.1.1.3.cmml"
                                      xref="S5.E8.m1.7.7.1.1.1.1.3"><csymbol
                                        cd="ambiguous"
                                        id="S5.E8.m1.7.7.1.1.1.1.3.1.cmml"
                                        xref="S5.E8.m1.7.7.1.1.1.1.3">subscript</csymbol><ci
                                        id="S5.E8.m1.7.7.1.1.1.1.3.2.cmml"
                                        xref="S5.E8.m1.7.7.1.1.1.1.3.2">𝔼</ci><apply
                                        id="S5.E8.m1.3.3.2.cmml"
                                        xref="S5.E8.m1.3.3.2"><csymbol
                                          cd="latexml"
                                          id="S5.E8.m1.3.3.2.3.cmml"
                                          xref="S5.E8.m1.3.3.2.3">similar-to</csymbol><list
                                          id="S5.E8.m1.3.3.2.4.1.cmml"
                                          xref="S5.E8.m1.3.3.2.4.2"><ci
                                            id="S5.E8.m1.2.2.1.1.cmml"
                                            xref="S5.E8.m1.2.2.1.1">𝑋</ci><ci
                                            id="S5.E8.m1.3.3.2.2.cmml"
                                            xref="S5.E8.m1.3.3.2.2">𝑌</ci></list><ci
                                          id="S5.E8.m1.3.3.2.5.cmml"
                                          xref="S5.E8.m1.3.3.2.5">𝑄</ci></apply></apply><apply
                                      id="S5.E8.m1.7.7.1.1.1.1.1.2.cmml"
                                      xref="S5.E8.m1.7.7.1.1.1.1.1.1"><csymbol
                                        cd="latexml"
                                        id="S5.E8.m1.7.7.1.1.1.1.1.2.1.cmml"
                                        xref="S5.E8.m1.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply
                                        id="S5.E8.m1.7.7.1.1.1.1.1.1.1.cmml"
                                        xref="S5.E8.m1.7.7.1.1.1.1.1.1.1"><times
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.2"></times><ci
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.3.cmml"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.3">ℓ</ci><interval
                                          closure="open"
                                          id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1"><apply
                                            id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"
                                            xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1"><times
                                              id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></times><apply
                                              id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><csymbol
                                                cd="ambiguous"
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci
                                                id="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml"
                                                xref="S5.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci
                                              id="S5.E8.m1.5.5.cmml"
                                              xref="S5.E8.m1.5.5">𝑋</ci></apply><ci
                                            id="S5.E8.m1.6.6.cmml"
                                            xref="S5.E8.m1.6.6">𝑌</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E8.m1.7c">\mathcal{R}(\theta):=\sup_{Q\in\mathcal{P}(P_{tr})}\mathbb{E}_{X,Y\sim
                              Q}[\ell%
                              (f_{\theta}(X),Y)],</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E8.m1.7d">caligraphic_R ( italic_θ ) :=
                              roman_sup start_POSTSUBSCRIPT italic_Q ∈
                              caligraphic_P ( italic_P start_POSTSUBSCRIPT
                              italic_t italic_r end_POSTSUBSCRIPT )
                              end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT
                              italic_X , italic_Y ∼ italic_Q end_POSTSUBSCRIPT [
                              roman_ℓ ( italic_f start_POSTSUBSCRIPT italic_θ
                              end_POSTSUBSCRIPT ( italic_X ) , italic_Y ) ]
                              ,</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS1.p1.4">where <math
                    alttext="\mathcal{P}(P_{tr})=\{Q:\text{Dist}(Q,P_{tr})\leq\rho\}"
                    class="ltx_Math" display="inline"
                    id="S5.SS1.p1.1.m1.4"><semantics
                      id="S5.SS1.p1.1.m1.4a"><mrow id="S5.SS1.p1.1.m1.4.4"
                        xref="S5.SS1.p1.1.m1.4.4.cmml"><mrow
                          id="S5.SS1.p1.1.m1.3.3.1"
                          xref="S5.SS1.p1.1.m1.3.3.1.cmml"><mi
                            class="ltx_font_mathcaligraphic"
                            id="S5.SS1.p1.1.m1.3.3.1.3"
                            xref="S5.SS1.p1.1.m1.3.3.1.3.cmml">𝒫</mi><mo
                            id="S5.SS1.p1.1.m1.3.3.1.2"
                            xref="S5.SS1.p1.1.m1.3.3.1.2.cmml">⁢</mo><mrow
                            id="S5.SS1.p1.1.m1.3.3.1.1.1"
                            xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.cmml"><mo
                              id="S5.SS1.p1.1.m1.3.3.1.1.1.2" stretchy="false"
                              xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><msub
                              id="S5.SS1.p1.1.m1.3.3.1.1.1.1"
                              xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.cmml"><mi
                                id="S5.SS1.p1.1.m1.3.3.1.1.1.1.2"
                                xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.2.cmml">P</mi><mrow
                                id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3"
                                xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.cmml"><mi
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.2"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.2.cmml">t</mi><mo
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.1"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.3"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.3.cmml">r</mi></mrow></msub><mo
                              id="S5.SS1.p1.1.m1.3.3.1.1.1.3" stretchy="false"
                              xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                          id="S5.SS1.p1.1.m1.4.4.3"
                          xref="S5.SS1.p1.1.m1.4.4.3.cmml">=</mo><mrow
                          id="S5.SS1.p1.1.m1.4.4.2.1"
                          xref="S5.SS1.p1.1.m1.4.4.2.2.cmml"><mo
                            id="S5.SS1.p1.1.m1.4.4.2.1.2" stretchy="false"
                            xref="S5.SS1.p1.1.m1.4.4.2.2.1.cmml">{</mo><mi
                            id="S5.SS1.p1.1.m1.2.2"
                            xref="S5.SS1.p1.1.m1.2.2.cmml">Q</mi><mo
                            id="S5.SS1.p1.1.m1.4.4.2.1.3" lspace="0.278em"
                            rspace="0.278em"
                            xref="S5.SS1.p1.1.m1.4.4.2.2.1.cmml">:</mo><mrow
                            id="S5.SS1.p1.1.m1.4.4.2.1.1"
                            xref="S5.SS1.p1.1.m1.4.4.2.1.1.cmml"><mrow
                              id="S5.SS1.p1.1.m1.4.4.2.1.1.1"
                              xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.cmml"><mtext
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.1.3"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.3a.cmml">Dist</mtext><mo
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.1.2"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.2.cmml">⁢</mo><mrow
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.2.cmml"><mo
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.2"
                                  stretchy="false"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.2.cmml">(</mo><mi
                                  id="S5.SS1.p1.1.m1.1.1"
                                  xref="S5.SS1.p1.1.m1.1.1.cmml">Q</mi><mo
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.3"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.2.cmml">,</mo><msub
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml"><mi
                                    id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.2"
                                    xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.2.cmml">P</mi><mrow
                                    id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3"
                                    xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml"><mi
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml">r</mi></mrow></msub><mo
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.4"
                                  stretchy="false"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo
                              id="S5.SS1.p1.1.m1.4.4.2.1.1.2"
                              xref="S5.SS1.p1.1.m1.4.4.2.1.1.2.cmml">≤</mo><mi
                              id="S5.SS1.p1.1.m1.4.4.2.1.1.3"
                              xref="S5.SS1.p1.1.m1.4.4.2.1.1.3.cmml">ρ</mi></mrow><mo
                            id="S5.SS1.p1.1.m1.4.4.2.1.4" stretchy="false"
                            xref="S5.SS1.p1.1.m1.4.4.2.2.1.cmml">}</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p1.1.m1.4b"><apply
                          id="S5.SS1.p1.1.m1.4.4.cmml"
                          xref="S5.SS1.p1.1.m1.4.4"><eq
                            id="S5.SS1.p1.1.m1.4.4.3.cmml"
                            xref="S5.SS1.p1.1.m1.4.4.3"></eq><apply
                            id="S5.SS1.p1.1.m1.3.3.1.cmml"
                            xref="S5.SS1.p1.1.m1.3.3.1"><times
                              id="S5.SS1.p1.1.m1.3.3.1.2.cmml"
                              xref="S5.SS1.p1.1.m1.3.3.1.2"></times><ci
                              id="S5.SS1.p1.1.m1.3.3.1.3.cmml"
                              xref="S5.SS1.p1.1.m1.3.3.1.3">𝒫</ci><apply
                              id="S5.SS1.p1.1.m1.3.3.1.1.1.1.cmml"
                              xref="S5.SS1.p1.1.m1.3.3.1.1.1"><csymbol
                                cd="ambiguous"
                                id="S5.SS1.p1.1.m1.3.3.1.1.1.1.1.cmml"
                                xref="S5.SS1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci
                                id="S5.SS1.p1.1.m1.3.3.1.1.1.1.2.cmml"
                                xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.2">𝑃</ci><apply
                                id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.cmml"
                                xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3"><times
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.1.cmml"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.1"></times><ci
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.2.cmml"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.2">𝑡</ci><ci
                                  id="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.3.cmml"
                                  xref="S5.SS1.p1.1.m1.3.3.1.1.1.1.3.3">𝑟</ci></apply></apply></apply><apply
                            id="S5.SS1.p1.1.m1.4.4.2.2.cmml"
                            xref="S5.SS1.p1.1.m1.4.4.2.1"><csymbol cd="latexml"
                              id="S5.SS1.p1.1.m1.4.4.2.2.1.cmml"
                              xref="S5.SS1.p1.1.m1.4.4.2.1.2">conditional-set</csymbol><ci
                              id="S5.SS1.p1.1.m1.2.2.cmml"
                              xref="S5.SS1.p1.1.m1.2.2">𝑄</ci><apply
                              id="S5.SS1.p1.1.m1.4.4.2.1.1.cmml"
                              xref="S5.SS1.p1.1.m1.4.4.2.1.1"><leq
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.2.cmml"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.2"></leq><apply
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.1.cmml"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.1"><times
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.2.cmml"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.2"></times><ci
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.3a.cmml"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.3"><mtext
                                    id="S5.SS1.p1.1.m1.4.4.2.1.1.1.3.cmml"
                                    xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.3">Dist</mtext></ci><interval
                                  closure="open"
                                  id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.2.cmml"
                                  xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1"><ci
                                    id="S5.SS1.p1.1.m1.1.1.cmml"
                                    xref="S5.SS1.p1.1.m1.1.1">𝑄</ci><apply
                                    id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml"
                                    xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1"><csymbol
                                      cd="ambiguous"
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.2.cmml"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.2">𝑃</ci><apply
                                      id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml"
                                      xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3"><times
                                        id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml"
                                        xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1"></times><ci
                                        id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml"
                                        xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2">𝑡</ci><ci
                                        id="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml"
                                        xref="S5.SS1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply></interval></apply><ci
                                id="S5.SS1.p1.1.m1.4.4.2.1.1.3.cmml"
                                xref="S5.SS1.p1.1.m1.4.4.2.1.1.3">𝜌</ci></apply></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p1.1.m1.4c">\mathcal{P}(P_{tr})=\{Q:\text{Dist}(Q,P_{tr})\leq\rho\}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p1.1.m1.4d">caligraphic_P ( italic_P
                        start_POSTSUBSCRIPT italic_t italic_r end_POSTSUBSCRIPT
                        ) = { italic_Q : Dist ( italic_Q , italic_P
                        start_POSTSUBSCRIPT italic_t italic_r end_POSTSUBSCRIPT
                        ) ≤ italic_ρ }</annotation></semantics></math> denotes
                  the uncertainty set surrounding the training distribution
                  <math alttext="P_{tr}" class="ltx_Math" display="inline"
                    id="S5.SS1.p1.2.m2.1"><semantics
                      id="S5.SS1.p1.2.m2.1a"><msub id="S5.SS1.p1.2.m2.1.1"
                        xref="S5.SS1.p1.2.m2.1.1.cmml"><mi
                          id="S5.SS1.p1.2.m2.1.1.2"
                          xref="S5.SS1.p1.2.m2.1.1.2.cmml">P</mi><mrow
                          id="S5.SS1.p1.2.m2.1.1.3"
                          xref="S5.SS1.p1.2.m2.1.1.3.cmml"><mi
                            id="S5.SS1.p1.2.m2.1.1.3.2"
                            xref="S5.SS1.p1.2.m2.1.1.3.2.cmml">t</mi><mo
                            id="S5.SS1.p1.2.m2.1.1.3.1"
                            xref="S5.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi
                            id="S5.SS1.p1.2.m2.1.1.3.3"
                            xref="S5.SS1.p1.2.m2.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply
                          id="S5.SS1.p1.2.m2.1.1.cmml"
                          xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous"
                            id="S5.SS1.p1.2.m2.1.1.1.cmml"
                            xref="S5.SS1.p1.2.m2.1.1">subscript</csymbol><ci
                            id="S5.SS1.p1.2.m2.1.1.2.cmml"
                            xref="S5.SS1.p1.2.m2.1.1.2">𝑃</ci><apply
                            id="S5.SS1.p1.2.m2.1.1.3.cmml"
                            xref="S5.SS1.p1.2.m2.1.1.3"><times
                              id="S5.SS1.p1.2.m2.1.1.3.1.cmml"
                              xref="S5.SS1.p1.2.m2.1.1.3.1"></times><ci
                              id="S5.SS1.p1.2.m2.1.1.3.2.cmml"
                              xref="S5.SS1.p1.2.m2.1.1.3.2">𝑡</ci><ci
                              id="S5.SS1.p1.2.m2.1.1.3.3.cmml"
                              xref="S5.SS1.p1.2.m2.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p1.2.m2.1c">P_{tr}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_r
                        end_POSTSUBSCRIPT</annotation></semantics></math>.
                  Note that no test information is used in the objective.
                  The distribution-wise distance metric, denoted as <math
                    alttext="\text{Dist}(\cdot,\cdot)" class="ltx_Math"
                    display="inline" id="S5.SS1.p1.3.m3.2"><semantics
                      id="S5.SS1.p1.3.m3.2a"><mrow id="S5.SS1.p1.3.m3.2.3"
                        xref="S5.SS1.p1.3.m3.2.3.cmml"><mtext
                          id="S5.SS1.p1.3.m3.2.3.2"
                          xref="S5.SS1.p1.3.m3.2.3.2a.cmml">Dist</mtext><mo
                          id="S5.SS1.p1.3.m3.2.3.1"
                          xref="S5.SS1.p1.3.m3.2.3.1.cmml">⁢</mo><mrow
                          id="S5.SS1.p1.3.m3.2.3.3.2"
                          xref="S5.SS1.p1.3.m3.2.3.3.1.cmml"><mo
                            id="S5.SS1.p1.3.m3.2.3.3.2.1" stretchy="false"
                            xref="S5.SS1.p1.3.m3.2.3.3.1.cmml">(</mo><mo
                            id="S5.SS1.p1.3.m3.1.1" lspace="0em" rspace="0em"
                            xref="S5.SS1.p1.3.m3.1.1.cmml">⋅</mo><mo
                            id="S5.SS1.p1.3.m3.2.3.3.2.2" rspace="0em"
                            xref="S5.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mo
                            id="S5.SS1.p1.3.m3.2.2" lspace="0em" rspace="0em"
                            xref="S5.SS1.p1.3.m3.2.2.cmml">⋅</mo><mo
                            id="S5.SS1.p1.3.m3.2.3.3.2.3" stretchy="false"
                            xref="S5.SS1.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p1.3.m3.2b"><apply
                          id="S5.SS1.p1.3.m3.2.3.cmml"
                          xref="S5.SS1.p1.3.m3.2.3"><times
                            id="S5.SS1.p1.3.m3.2.3.1.cmml"
                            xref="S5.SS1.p1.3.m3.2.3.1"></times><ci
                            id="S5.SS1.p1.3.m3.2.3.2a.cmml"
                            xref="S5.SS1.p1.3.m3.2.3.2"><mtext
                              id="S5.SS1.p1.3.m3.2.3.2.cmml"
                              xref="S5.SS1.p1.3.m3.2.3.2">Dist</mtext></ci><interval
                            closure="open" id="S5.SS1.p1.3.m3.2.3.3.1.cmml"
                            xref="S5.SS1.p1.3.m3.2.3.3.2"><ci
                              id="S5.SS1.p1.3.m3.1.1.cmml"
                              xref="S5.SS1.p1.3.m3.1.1">⋅</ci><ci
                              id="S5.SS1.p1.3.m3.2.2.cmml"
                              xref="S5.SS1.p1.3.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p1.3.m3.2c">\text{Dist}(\cdot,\cdot)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p1.3.m3.2d">Dist ( ⋅ , ⋅
                        )</annotation></semantics></math>, offers multiple
                  choices such as <math alttext="f" class="ltx_Math"
                    display="inline" id="S5.SS1.p1.4.m4.1"><semantics
                      id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1"
                        xref="S5.SS1.p1.4.m4.1.1.cmml">f</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci
                          id="S5.SS1.p1.4.m4.1.1.cmml"
                          xref="S5.SS1.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p1.4.m4.1c">f</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p1.4.m4.1d">italic_f</annotation></semantics></math>-divergence,
                  Wasserstein distance, or Maximum Mean Discrepancy (MMD)
                  distance.
                  Each choice corresponds to different DRO algorithms and
                  theoretical guarantees.
                  Intuitively, if the test distribution is encapsulated within
                  the uncertainty set, it is plausible to assure the model’s
                  generalization performance.</p>
              </div>
              <div class="ltx_para" id="S5.SS1.p2">
                <p class="ltx_p" id="S5.SS1.p2.2">In a parallel context, the
                  principle of distributional robustness is leveraged to
                  estimate the generalization potential of specific models.
                  Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib45"
                      title>45</a>]</cite> evaluate model robustness against
                  distribution shifts in a set of covariates <math alttext="Z"
                    class="ltx_Math" display="inline"
                    id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mi
                        id="S5.SS1.p2.1.m1.1.1"
                        xref="S5.SS1.p2.1.m1.1.1.cmml">Z</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci
                          id="S5.SS1.p2.1.m1.1.1.cmml"
                          xref="S5.SS1.p2.1.m1.1.1">𝑍</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.1.m1.1c">Z</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.1.m1.1d">italic_Z</annotation></semantics></math>
                  by examining the worst sub-population performance across all
                  subpopulations of a given size.
                  Considering a given model <math alttext="f_{\theta}"
                    class="ltx_Math" display="inline"
                    id="S5.SS1.p2.2.m2.1"><semantics
                      id="S5.SS1.p2.2.m2.1a"><msub id="S5.SS1.p2.2.m2.1.1"
                        xref="S5.SS1.p2.2.m2.1.1.cmml"><mi
                          id="S5.SS1.p2.2.m2.1.1.2"
                          xref="S5.SS1.p2.2.m2.1.1.2.cmml">f</mi><mi
                          id="S5.SS1.p2.2.m2.1.1.3"
                          xref="S5.SS1.p2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply
                          id="S5.SS1.p2.2.m2.1.1.cmml"
                          xref="S5.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous"
                            id="S5.SS1.p2.2.m2.1.1.1.cmml"
                            xref="S5.SS1.p2.2.m2.1.1">subscript</csymbol><ci
                            id="S5.SS1.p2.2.m2.1.1.2.cmml"
                            xref="S5.SS1.p2.2.m2.1.1.2">𝑓</ci><ci
                            id="S5.SS1.p2.2.m2.1.1.3.cmml"
                            xref="S5.SS1.p2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.2.m2.1c">f_{\theta}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.2.m2.1d">italic_f start_POSTSUBSCRIPT
                        italic_θ
                        end_POSTSUBSCRIPT</annotation></semantics></math> that
                  derives from marginal DRO <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib49"
                      title>49</a>]</cite>, they formulate their measure as
                  follows:</p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E9">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="W_{\alpha}:=\sup_{Q_{Z}\in\mathcal{Q}_{\alpha}}\mathbb{E}_{Z\sim Q_{Z}}\bigg{[%
}\mathbb{E}[\ell(f_{\theta}(X),Y)|Z]\bigg{]}," class="ltx_Math" display="block"
                          id="S5.E9.m1.3"><semantics id="S5.E9.m1.3a"><mrow
                              id="S5.E9.m1.3.3.1"
                              xref="S5.E9.m1.3.3.1.1.cmml"><mrow
                                id="S5.E9.m1.3.3.1.1"
                                xref="S5.E9.m1.3.3.1.1.cmml"><msub
                                  id="S5.E9.m1.3.3.1.1.3"
                                  xref="S5.E9.m1.3.3.1.1.3.cmml"><mi
                                    id="S5.E9.m1.3.3.1.1.3.2"
                                    xref="S5.E9.m1.3.3.1.1.3.2.cmml">W</mi><mi
                                    id="S5.E9.m1.3.3.1.1.3.3"
                                    xref="S5.E9.m1.3.3.1.1.3.3.cmml">α</mi></msub><mo
                                  id="S5.E9.m1.3.3.1.1.2" lspace="0.278em"
                                  xref="S5.E9.m1.3.3.1.1.2.cmml">:=</mo><mrow
                                  id="S5.E9.m1.3.3.1.1.1"
                                  xref="S5.E9.m1.3.3.1.1.1.cmml"><munder
                                    id="S5.E9.m1.3.3.1.1.1.2"
                                    xref="S5.E9.m1.3.3.1.1.1.2.cmml"><mo
                                      id="S5.E9.m1.3.3.1.1.1.2.2"
                                      lspace="0.111em" movablelimits="false"
                                      rspace="0.167em"
                                      xref="S5.E9.m1.3.3.1.1.1.2.2.cmml">sup</mo><mrow
                                      id="S5.E9.m1.3.3.1.1.1.2.3"
                                      xref="S5.E9.m1.3.3.1.1.1.2.3.cmml"><msub
                                        id="S5.E9.m1.3.3.1.1.1.2.3.2"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.2.cmml"><mi
                                          id="S5.E9.m1.3.3.1.1.1.2.3.2.2"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.2.2.cmml">Q</mi><mi
                                          id="S5.E9.m1.3.3.1.1.1.2.3.2.3"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.2.3.cmml">Z</mi></msub><mo
                                        id="S5.E9.m1.3.3.1.1.1.2.3.1"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.1.cmml">∈</mo><msub
                                        id="S5.E9.m1.3.3.1.1.1.2.3.3"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.3.cmml"><mi
                                          class="ltx_font_mathcaligraphic"
                                          id="S5.E9.m1.3.3.1.1.1.2.3.3.2"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.3.2.cmml">𝒬</mi><mi
                                          id="S5.E9.m1.3.3.1.1.1.2.3.3.3"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.3.3.cmml">α</mi></msub></mrow></munder><mrow
                                    id="S5.E9.m1.3.3.1.1.1.1"
                                    xref="S5.E9.m1.3.3.1.1.1.1.cmml"><msub
                                      id="S5.E9.m1.3.3.1.1.1.1.3"
                                      xref="S5.E9.m1.3.3.1.1.1.1.3.cmml"><mi
                                        id="S5.E9.m1.3.3.1.1.1.1.3.2"
                                        xref="S5.E9.m1.3.3.1.1.1.1.3.2.cmml">𝔼</mi><mrow
                                        id="S5.E9.m1.3.3.1.1.1.1.3.3"
                                        xref="S5.E9.m1.3.3.1.1.1.1.3.3.cmml"><mi
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.2"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.2.cmml">Z</mi><mo
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.1"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.1.cmml">∼</mo><msub
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.3"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.3.cmml"><mi
                                            id="S5.E9.m1.3.3.1.1.1.1.3.3.3.2"
                                            xref="S5.E9.m1.3.3.1.1.1.1.3.3.3.2.cmml">Q</mi><mi
                                            id="S5.E9.m1.3.3.1.1.1.1.3.3.3.3"
                                            xref="S5.E9.m1.3.3.1.1.1.1.3.3.3.3.cmml">Z</mi></msub></mrow></msub><mo
                                      id="S5.E9.m1.3.3.1.1.1.1.2"
                                      xref="S5.E9.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow
                                      id="S5.E9.m1.3.3.1.1.1.1.1.1"
                                      xref="S5.E9.m1.3.3.1.1.1.1.1.2.cmml"><mo
                                        id="S5.E9.m1.3.3.1.1.1.1.1.1.2"
                                        maxsize="210%" minsize="210%"
                                        xref="S5.E9.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow
                                        id="S5.E9.m1.3.3.1.1.1.1.1.1.1"
                                        xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mi
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.3"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝔼</mi><mo
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.2"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo
                                            id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2"
                                            stretchy="false"
                                            xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow
                                            id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1"
                                            xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"
                                                mathvariant="normal"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ℓ</mi><mo
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo
                                                  id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2"
                                                  stretchy="false"
                                                  xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow
                                                  id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1"
                                                  xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub
                                                    id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"
                                                    xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo
                                                    id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"
                                                    xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow
                                                    id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"
                                                    xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"
                                                      stretchy="false"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi
                                                      id="S5.E9.m1.1.1"
                                                      xref="S5.E9.m1.1.1.cmml">X</mi><mo
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2"
                                                      stretchy="false"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                                  id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3"
                                                  xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi
                                                  id="S5.E9.m1.2.2"
                                                  xref="S5.E9.m1.2.2.cmml">Y</mi><mo
                                                  id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.4"
                                                  stretchy="false"
                                                  xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo
                                              fence="false"
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mi
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo
                                            id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3"
                                            stretchy="false"
                                            xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo
                                        id="S5.E9.m1.3.3.1.1.1.1.1.1.3"
                                        maxsize="210%" minsize="210%"
                                        xref="S5.E9.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo
                                id="S5.E9.m1.3.3.1.2"
                                xref="S5.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml
                              encoding="MathML-Content" id="S5.E9.m1.3b"><apply
                                id="S5.E9.m1.3.3.1.1.cmml"
                                xref="S5.E9.m1.3.3.1"><csymbol cd="latexml"
                                  id="S5.E9.m1.3.3.1.1.2.cmml"
                                  xref="S5.E9.m1.3.3.1.1.2">assign</csymbol><apply
                                  id="S5.E9.m1.3.3.1.1.3.cmml"
                                  xref="S5.E9.m1.3.3.1.1.3"><csymbol
                                    cd="ambiguous"
                                    id="S5.E9.m1.3.3.1.1.3.1.cmml"
                                    xref="S5.E9.m1.3.3.1.1.3">subscript</csymbol><ci
                                    id="S5.E9.m1.3.3.1.1.3.2.cmml"
                                    xref="S5.E9.m1.3.3.1.1.3.2">𝑊</ci><ci
                                    id="S5.E9.m1.3.3.1.1.3.3.cmml"
                                    xref="S5.E9.m1.3.3.1.1.3.3">𝛼</ci></apply><apply
                                  id="S5.E9.m1.3.3.1.1.1.cmml"
                                  xref="S5.E9.m1.3.3.1.1.1"><apply
                                    id="S5.E9.m1.3.3.1.1.1.2.cmml"
                                    xref="S5.E9.m1.3.3.1.1.1.2"><csymbol
                                      cd="ambiguous"
                                      id="S5.E9.m1.3.3.1.1.1.2.1.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.2">subscript</csymbol><csymbol
                                      cd="latexml"
                                      id="S5.E9.m1.3.3.1.1.1.2.2.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.2.2">supremum</csymbol><apply
                                      id="S5.E9.m1.3.3.1.1.1.2.3.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.2.3"><in
                                        id="S5.E9.m1.3.3.1.1.1.2.3.1.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.1"></in><apply
                                        id="S5.E9.m1.3.3.1.1.1.2.3.2.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.2"><csymbol
                                          cd="ambiguous"
                                          id="S5.E9.m1.3.3.1.1.1.2.3.2.1.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.2">subscript</csymbol><ci
                                          id="S5.E9.m1.3.3.1.1.1.2.3.2.2.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.2.2">𝑄</ci><ci
                                          id="S5.E9.m1.3.3.1.1.1.2.3.2.3.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.2.3">𝑍</ci></apply><apply
                                        id="S5.E9.m1.3.3.1.1.1.2.3.3.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.2.3.3"><csymbol
                                          cd="ambiguous"
                                          id="S5.E9.m1.3.3.1.1.1.2.3.3.1.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.3">subscript</csymbol><ci
                                          id="S5.E9.m1.3.3.1.1.1.2.3.3.2.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.3.2">𝒬</ci><ci
                                          id="S5.E9.m1.3.3.1.1.1.2.3.3.3.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.2.3.3.3">𝛼</ci></apply></apply></apply><apply
                                    id="S5.E9.m1.3.3.1.1.1.1.cmml"
                                    xref="S5.E9.m1.3.3.1.1.1.1"><times
                                      id="S5.E9.m1.3.3.1.1.1.1.2.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.1.2"></times><apply
                                      id="S5.E9.m1.3.3.1.1.1.1.3.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.1.3"><csymbol
                                        cd="ambiguous"
                                        id="S5.E9.m1.3.3.1.1.1.1.3.1.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.1.3">subscript</csymbol><ci
                                        id="S5.E9.m1.3.3.1.1.1.1.3.2.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.1.3.2">𝔼</ci><apply
                                        id="S5.E9.m1.3.3.1.1.1.1.3.3.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.1.3.3"><csymbol
                                          cd="latexml"
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.1.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.1">similar-to</csymbol><ci
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.2.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.2">𝑍</ci><apply
                                          id="S5.E9.m1.3.3.1.1.1.1.3.3.3.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.3.3.3"><csymbol
                                            cd="ambiguous"
                                            id="S5.E9.m1.3.3.1.1.1.1.3.3.3.1.cmml"
                                            xref="S5.E9.m1.3.3.1.1.1.1.3.3.3">subscript</csymbol><ci
                                            id="S5.E9.m1.3.3.1.1.1.1.3.3.3.2.cmml"
                                            xref="S5.E9.m1.3.3.1.1.1.1.3.3.3.2">𝑄</ci><ci
                                            id="S5.E9.m1.3.3.1.1.1.1.3.3.3.3.cmml"
                                            xref="S5.E9.m1.3.3.1.1.1.1.3.3.3.3">𝑍</ci></apply></apply></apply><apply
                                      id="S5.E9.m1.3.3.1.1.1.1.1.2.cmml"
                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1"><csymbol
                                        cd="latexml"
                                        id="S5.E9.m1.3.3.1.1.1.1.1.2.1.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply
                                        id="S5.E9.m1.3.3.1.1.1.1.1.1.1.cmml"
                                        xref="S5.E9.m1.3.3.1.1.1.1.1.1.1"><times
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.2"></times><ci
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.3">𝔼</ci><apply
                                          id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol
                                            cd="latexml"
                                            id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml"
                                            xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply
                                            id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"
                                            xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol
                                              cd="latexml"
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><times
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">ℓ</ci><interval
                                                closure="open"
                                                id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                                xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply
                                                  id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                                  xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times
                                                    id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                                    xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply
                                                    id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                                    xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol
                                                      cd="ambiguous"
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci
                                                      id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"
                                                      xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci
                                                    id="S5.E9.m1.1.1.cmml"
                                                    xref="S5.E9.m1.1.1">𝑋</ci></apply><ci
                                                  id="S5.E9.m1.2.2.cmml"
                                                  xref="S5.E9.m1.2.2">𝑌</ci></interval></apply><ci
                                              id="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"
                                              xref="S5.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑍</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E9.m1.3c">W_{\alpha}:=\sup_{Q_{Z}\in\mathcal{Q}_{\alpha}}\mathbb{E}_{Z\sim
                              Q_{Z}}\bigg{[%
                              }\mathbb{E}[\ell(f_{\theta}(X),Y)|Z]\bigg{]},</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E9.m1.3d">italic_W start_POSTSUBSCRIPT
                              italic_α end_POSTSUBSCRIPT := roman_sup
                              start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT
                              italic_Z end_POSTSUBSCRIPT ∈ caligraphic_Q
                              start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT
                              end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT
                              italic_Z ∼ italic_Q start_POSTSUBSCRIPT italic_Z
                              end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ blackboard_E
                              [ roman_ℓ ( italic_f start_POSTSUBSCRIPT italic_θ
                              end_POSTSUBSCRIPT ( italic_X ) , italic_Y ) |
                              italic_Z ] ]
                              ,</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS1.p2.4">Here, <math
                    alttext="\mathcal{Q}_{\alpha}" class="ltx_Math"
                    display="inline" id="S5.SS1.p2.3.m1.1"><semantics
                      id="S5.SS1.p2.3.m1.1a"><msub id="S5.SS1.p2.3.m1.1.1"
                        xref="S5.SS1.p2.3.m1.1.1.cmml"><mi
                          class="ltx_font_mathcaligraphic"
                          id="S5.SS1.p2.3.m1.1.1.2"
                          xref="S5.SS1.p2.3.m1.1.1.2.cmml">𝒬</mi><mi
                          id="S5.SS1.p2.3.m1.1.1.3"
                          xref="S5.SS1.p2.3.m1.1.1.3.cmml">α</mi></msub><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.3.m1.1b"><apply
                          id="S5.SS1.p2.3.m1.1.1.cmml"
                          xref="S5.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous"
                            id="S5.SS1.p2.3.m1.1.1.1.cmml"
                            xref="S5.SS1.p2.3.m1.1.1">subscript</csymbol><ci
                            id="S5.SS1.p2.3.m1.1.1.2.cmml"
                            xref="S5.SS1.p2.3.m1.1.1.2">𝒬</ci><ci
                            id="S5.SS1.p2.3.m1.1.1.3.cmml"
                            xref="S5.SS1.p2.3.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.3.m1.1c">\mathcal{Q}_{\alpha}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.3.m1.1d">caligraphic_Q start_POSTSUBSCRIPT
                        italic_α
                        end_POSTSUBSCRIPT</annotation></semantics></math>
                  encompasses all the subpopulations with a proportion exceeding
                  <math alttext="\alpha" class="ltx_Math" display="inline"
                    id="S5.SS1.p2.4.m2.1"><semantics id="S5.SS1.p2.4.m2.1a"><mi
                        id="S5.SS1.p2.4.m2.1.1"
                        xref="S5.SS1.p2.4.m2.1.1.cmml">α</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.4.m2.1b"><ci
                          id="S5.SS1.p2.4.m2.1.1.cmml"
                          xref="S5.SS1.p2.4.m2.1.1">𝛼</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.4.m2.1c">\alpha</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.4.m2.1d">italic_α</annotation></semantics></math>:</p>
                <table class="ltx_equationgroup ltx_eqn_table" id="S5.E10">
                  <tbody>
                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline"
                      id="S5.E10X">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                          alttext="\displaystyle Q_{\alpha}:=\{Q_{Z}:P_{Z}"
                          class="ltx_math_unparsed" display="inline"
                          id="S5.E10X.2.1.1.m1.1"><semantics
                            id="S5.E10X.2.1.1.m1.1a"><mrow
                              id="S5.E10X.2.1.1.m1.1b"><msub
                                id="S5.E10X.2.1.1.m1.1.1"><mi
                                  id="S5.E10X.2.1.1.m1.1.1.2">Q</mi><mi
                                  id="S5.E10X.2.1.1.m1.1.1.3">α</mi></msub><mo
                                id="S5.E10X.2.1.1.m1.1.2" lspace="0.278em"
                                rspace="0.278em">:=</mo><mrow
                                id="S5.E10X.2.1.1.m1.1.3"><mo
                                  id="S5.E10X.2.1.1.m1.1.3.1"
                                  stretchy="false">{</mo><msub
                                  id="S5.E10X.2.1.1.m1.1.3.2"><mi
                                    id="S5.E10X.2.1.1.m1.1.3.2.2">Q</mi><mi
                                    id="S5.E10X.2.1.1.m1.1.3.2.3">Z</mi></msub><mo
                                  id="S5.E10X.2.1.1.m1.1.3.3" lspace="0.278em"
                                  rspace="0.278em">:</mo><msub
                                  id="S5.E10X.2.1.1.m1.1.3.4"><mi
                                    id="S5.E10X.2.1.1.m1.1.3.4.2">P</mi><mi
                                    id="S5.E10X.2.1.1.m1.1.3.4.3">Z</mi></msub></mrow></mrow><annotation
                              encoding="application/x-tex"
                              id="S5.E10X.2.1.1.m1.1c">\displaystyle
                              Q_{\alpha}:=\{Q_{Z}:P_{Z}</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E10X.2.1.1.m1.1d">italic_Q
                              start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT :=
                              { italic_Q start_POSTSUBSCRIPT italic_Z
                              end_POSTSUBSCRIPT : italic_P start_POSTSUBSCRIPT
                              italic_Z
                              end_POSTSUBSCRIPT</annotation></semantics></math></td>
                      <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                          alttext="\displaystyle=aQ_{Z}+(1-a)Q_{Z}^{{}^{\prime}}\text{ for some }a\geq\alpha"
                          class="ltx_Math" display="inline"
                          id="S5.E10X.3.2.2.m1.1"><semantics
                            id="S5.E10X.3.2.2.m1.1a"><mrow
                              id="S5.E10X.3.2.2.m1.1.1"
                              xref="S5.E10X.3.2.2.m1.1.1.cmml"><mi
                                id="S5.E10X.3.2.2.m1.1.1.3"
                                xref="S5.E10X.3.2.2.m1.1.1.3.cmml"></mi><mo
                                id="S5.E10X.3.2.2.m1.1.1.4"
                                xref="S5.E10X.3.2.2.m1.1.1.4.cmml">=</mo><mrow
                                id="S5.E10X.3.2.2.m1.1.1.1"
                                xref="S5.E10X.3.2.2.m1.1.1.1.cmml"><mrow
                                  id="S5.E10X.3.2.2.m1.1.1.1.3"
                                  xref="S5.E10X.3.2.2.m1.1.1.1.3.cmml"><mi
                                    id="S5.E10X.3.2.2.m1.1.1.1.3.2"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.3.2.cmml">a</mi><mo
                                    id="S5.E10X.3.2.2.m1.1.1.1.3.1"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.3.1.cmml">⁢</mo><msub
                                    id="S5.E10X.3.2.2.m1.1.1.1.3.3"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.3.3.cmml"><mi
                                      id="S5.E10X.3.2.2.m1.1.1.1.3.3.2"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.3.3.2.cmml">Q</mi><mi
                                      id="S5.E10X.3.2.2.m1.1.1.1.3.3.3"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.3.3.3.cmml">Z</mi></msub></mrow><mo
                                  id="S5.E10X.3.2.2.m1.1.1.1.2"
                                  xref="S5.E10X.3.2.2.m1.1.1.1.2.cmml">+</mo><mrow
                                  id="S5.E10X.3.2.2.m1.1.1.1.1"
                                  xref="S5.E10X.3.2.2.m1.1.1.1.1.cmml"><mrow
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.1.1"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.2"
                                      stretchy="false"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mn
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.2"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.1"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.3"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">a</mi></mrow><mo
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.3"
                                      stretchy="false"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.2"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><msubsup
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.3"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.3.cmml"><mi
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.2"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.3.2.2.cmml">Q</mi><mi
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.3"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.3.2.3.cmml">Z</mi><msup
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.3.3"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1.3.3.cmml"><mi
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.3.3a"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.3.3.cmml"></mi><mo
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.3.3.1"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.3.3.1.cmml">′</mo></msup></msubsup><mo
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.2a"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><mtext
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.4"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.4a.cmml"> for
                                    some </mtext><mo
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.2b"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><mi
                                    id="S5.E10X.3.2.2.m1.1.1.1.1.5"
                                    xref="S5.E10X.3.2.2.m1.1.1.1.1.5.cmml">a</mi></mrow></mrow><mo
                                id="S5.E10X.3.2.2.m1.1.1.5"
                                xref="S5.E10X.3.2.2.m1.1.1.5.cmml">≥</mo><mi
                                id="S5.E10X.3.2.2.m1.1.1.6"
                                xref="S5.E10X.3.2.2.m1.1.1.6.cmml">α</mi></mrow><annotation-xml
                              encoding="MathML-Content"
                              id="S5.E10X.3.2.2.m1.1b"><apply
                                id="S5.E10X.3.2.2.m1.1.1.cmml"
                                xref="S5.E10X.3.2.2.m1.1.1"><and
                                  id="S5.E10X.3.2.2.m1.1.1a.cmml"
                                  xref="S5.E10X.3.2.2.m1.1.1"></and><apply
                                  id="S5.E10X.3.2.2.m1.1.1b.cmml"
                                  xref="S5.E10X.3.2.2.m1.1.1"><eq
                                    id="S5.E10X.3.2.2.m1.1.1.4.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1.4"></eq><csymbol
                                    cd="latexml"
                                    id="S5.E10X.3.2.2.m1.1.1.3.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1.3">absent</csymbol><apply
                                    id="S5.E10X.3.2.2.m1.1.1.1.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1.1"><plus
                                      id="S5.E10X.3.2.2.m1.1.1.1.2.cmml"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.2"></plus><apply
                                      id="S5.E10X.3.2.2.m1.1.1.1.3.cmml"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.3"><times
                                        id="S5.E10X.3.2.2.m1.1.1.1.3.1.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.3.1"></times><ci
                                        id="S5.E10X.3.2.2.m1.1.1.1.3.2.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.3.2">𝑎</ci><apply
                                        id="S5.E10X.3.2.2.m1.1.1.1.3.3.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.3.3"><csymbol
                                          cd="ambiguous"
                                          id="S5.E10X.3.2.2.m1.1.1.1.3.3.1.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.3.3">subscript</csymbol><ci
                                          id="S5.E10X.3.2.2.m1.1.1.1.3.3.2.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.3.3.2">𝑄</ci><ci
                                          id="S5.E10X.3.2.2.m1.1.1.1.3.3.3.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.3.3.3">𝑍</ci></apply></apply><apply
                                      id="S5.E10X.3.2.2.m1.1.1.1.1.cmml"
                                      xref="S5.E10X.3.2.2.m1.1.1.1.1"><times
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.2.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.2"></times><apply
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1"><minus
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><cn
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"
                                          type="integer"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.2">1</cn><ci
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.3.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.3"><csymbol
                                          cd="ambiguous"
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.3.1.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.3">superscript</csymbol><apply
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.3"><csymbol
                                            cd="ambiguous"
                                            id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.1.cmml"
                                            xref="S5.E10X.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci
                                            id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.2.cmml"
                                            xref="S5.E10X.3.2.2.m1.1.1.1.1.3.2.2">𝑄</ci><ci
                                            id="S5.E10X.3.2.2.m1.1.1.1.1.3.2.3.cmml"
                                            xref="S5.E10X.3.2.2.m1.1.1.1.1.3.2.3">𝑍</ci></apply><apply
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.3.3.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.3.3"><ci
                                            id="S5.E10X.3.2.2.m1.1.1.1.1.3.3.1.cmml"
                                            xref="S5.E10X.3.2.2.m1.1.1.1.1.3.3.1">′</ci></apply></apply><ci
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.4a.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.4"><mtext
                                          id="S5.E10X.3.2.2.m1.1.1.1.1.4.cmml"
                                          xref="S5.E10X.3.2.2.m1.1.1.1.1.4"> for
                                          some </mtext></ci><ci
                                        id="S5.E10X.3.2.2.m1.1.1.1.1.5.cmml"
                                        xref="S5.E10X.3.2.2.m1.1.1.1.1.5">𝑎</ci></apply></apply></apply><apply
                                  id="S5.E10X.3.2.2.m1.1.1c.cmml"
                                  xref="S5.E10X.3.2.2.m1.1.1"><geq
                                    id="S5.E10X.3.2.2.m1.1.1.5.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1.5"></geq><share
                                    href="#S5.E10X.3.2.2.m1.1.1.1.cmml"
                                    id="S5.E10X.3.2.2.m1.1.1d.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1"></share><ci
                                    id="S5.E10X.3.2.2.m1.1.1.6.cmml"
                                    xref="S5.E10X.3.2.2.m1.1.1.6">𝛼</ci></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E10X.3.2.2.m1.1c">\displaystyle=aQ_{Z}+(1-a)Q_{Z}^{{}^{\prime}}\text{
                              for some }a\geq\alpha</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E10X.3.2.2.m1.1d">= italic_a italic_Q
                              start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT + (
                              1 - italic_a ) italic_Q start_POSTSUBSCRIPT
                              italic_Z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
                              start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT
                              end_POSTSUPERSCRIPT for some italic_a ≥
                              italic_α</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="2"><span
                          class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
                    </tr>
                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline"
                      id="S5.E10Xa">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_td ltx_eqn_cell"></td>
                      <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                          alttext="\displaystyle\text{and subpopulations }Q_{Z}^{{}^{\prime}}\}."
                          class="ltx_math_unparsed" display="inline"
                          id="S5.E10Xa.2.1.1.m1.1"><semantics
                            id="S5.E10Xa.2.1.1.m1.1a"><mrow
                              id="S5.E10Xa.2.1.1.m1.1b"><mtext
                                id="S5.E10Xa.2.1.1.m1.1.1">and subpopulations
                              </mtext><msubsup id="S5.E10Xa.2.1.1.m1.1.2"><mi
                                  id="S5.E10Xa.2.1.1.m1.1.2.2.2">Q</mi><mi
                                  id="S5.E10Xa.2.1.1.m1.1.2.2.3">Z</mi><msup
                                  id="S5.E10Xa.2.1.1.m1.1.2.3"><mi
                                    id="S5.E10Xa.2.1.1.m1.1.2.3a"></mi><mo
                                    id="S5.E10Xa.2.1.1.m1.1.2.3.1">′</mo></msup></msubsup><mo
                                id="S5.E10Xa.2.1.1.m1.1.3"
                                stretchy="false">}</mo><mo
                                id="S5.E10Xa.2.1.1.m1.1.4"
                                lspace="0em">.</mo></mrow><annotation
                              encoding="application/x-tex"
                              id="S5.E10Xa.2.1.1.m1.1c">\displaystyle\text{and
                              subpopulations
                              }Q_{Z}^{{}^{\prime}}\}.</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E10Xa.2.1.1.m1.1d">and subpopulations
                              italic_Q start_POSTSUBSCRIPT italic_Z
                              end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
                              start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT
                              end_POSTSUPERSCRIPT }
                              .</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                    </tr>
                  </tbody>
                </table>
                <p class="ltx_p" id="S5.SS1.p2.8">This proposed metric provides
                  a means to assess robustness against <em
                    class="ltx_emph ltx_font_italic"
                    id="S5.SS1.p2.8.1">covariate shifts</em> in any covariates
                  of interest. The resulting worst-case subpopulation could
                  thereby offer machine learning researchers guidance for
                  further model improvement.
                  Building upon this, Subbaswamy and Saria <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib117"
                      title>117</a>]</cite> explore distribution shifts with
                  more intricate covariate structures.
                  They maintain the marginal distribution of immutable variables
                  <math alttext="Z\subset\{X,Y\}" class="ltx_Math"
                    display="inline" id="S5.SS1.p2.5.m1.2"><semantics
                      id="S5.SS1.p2.5.m1.2a"><mrow id="S5.SS1.p2.5.m1.2.3"
                        xref="S5.SS1.p2.5.m1.2.3.cmml"><mi
                          id="S5.SS1.p2.5.m1.2.3.2"
                          xref="S5.SS1.p2.5.m1.2.3.2.cmml">Z</mi><mo
                          id="S5.SS1.p2.5.m1.2.3.1"
                          xref="S5.SS1.p2.5.m1.2.3.1.cmml">⊂</mo><mrow
                          id="S5.SS1.p2.5.m1.2.3.3.2"
                          xref="S5.SS1.p2.5.m1.2.3.3.1.cmml"><mo
                            id="S5.SS1.p2.5.m1.2.3.3.2.1" stretchy="false"
                            xref="S5.SS1.p2.5.m1.2.3.3.1.cmml">{</mo><mi
                            id="S5.SS1.p2.5.m1.1.1"
                            xref="S5.SS1.p2.5.m1.1.1.cmml">X</mi><mo
                            id="S5.SS1.p2.5.m1.2.3.3.2.2"
                            xref="S5.SS1.p2.5.m1.2.3.3.1.cmml">,</mo><mi
                            id="S5.SS1.p2.5.m1.2.2"
                            xref="S5.SS1.p2.5.m1.2.2.cmml">Y</mi><mo
                            id="S5.SS1.p2.5.m1.2.3.3.2.3" stretchy="false"
                            xref="S5.SS1.p2.5.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.5.m1.2b"><apply
                          id="S5.SS1.p2.5.m1.2.3.cmml"
                          xref="S5.SS1.p2.5.m1.2.3"><subset
                            id="S5.SS1.p2.5.m1.2.3.1.cmml"
                            xref="S5.SS1.p2.5.m1.2.3.1"></subset><ci
                            id="S5.SS1.p2.5.m1.2.3.2.cmml"
                            xref="S5.SS1.p2.5.m1.2.3.2">𝑍</ci><set
                            id="S5.SS1.p2.5.m1.2.3.3.1.cmml"
                            xref="S5.SS1.p2.5.m1.2.3.3.2"><ci
                              id="S5.SS1.p2.5.m1.1.1.cmml"
                              xref="S5.SS1.p2.5.m1.1.1">𝑋</ci><ci
                              id="S5.SS1.p2.5.m1.2.2.cmml"
                              xref="S5.SS1.p2.5.m1.2.2">𝑌</ci></set></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.5.m1.2c">Z\subset\{X,Y\}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.5.m1.2d">italic_Z ⊂ { italic_X , italic_Y
                        }</annotation></semantics></math> constant during
                  covariate shifts, introducing distribution shifts solely to
                  mutable variables <math alttext="W\subset\{X,Y\}/Z"
                    class="ltx_Math" display="inline"
                    id="S5.SS1.p2.6.m2.2"><semantics
                      id="S5.SS1.p2.6.m2.2a"><mrow id="S5.SS1.p2.6.m2.2.3"
                        xref="S5.SS1.p2.6.m2.2.3.cmml"><mi
                          id="S5.SS1.p2.6.m2.2.3.2"
                          xref="S5.SS1.p2.6.m2.2.3.2.cmml">W</mi><mo
                          id="S5.SS1.p2.6.m2.2.3.1"
                          xref="S5.SS1.p2.6.m2.2.3.1.cmml">⊂</mo><mrow
                          id="S5.SS1.p2.6.m2.2.3.3"
                          xref="S5.SS1.p2.6.m2.2.3.3.cmml"><mrow
                            id="S5.SS1.p2.6.m2.2.3.3.2.2"
                            xref="S5.SS1.p2.6.m2.2.3.3.2.1.cmml"><mo
                              id="S5.SS1.p2.6.m2.2.3.3.2.2.1" stretchy="false"
                              xref="S5.SS1.p2.6.m2.2.3.3.2.1.cmml">{</mo><mi
                              id="S5.SS1.p2.6.m2.1.1"
                              xref="S5.SS1.p2.6.m2.1.1.cmml">X</mi><mo
                              id="S5.SS1.p2.6.m2.2.3.3.2.2.2"
                              xref="S5.SS1.p2.6.m2.2.3.3.2.1.cmml">,</mo><mi
                              id="S5.SS1.p2.6.m2.2.2"
                              xref="S5.SS1.p2.6.m2.2.2.cmml">Y</mi><mo
                              id="S5.SS1.p2.6.m2.2.3.3.2.2.3" stretchy="false"
                              xref="S5.SS1.p2.6.m2.2.3.3.2.1.cmml">}</mo></mrow><mo
                            id="S5.SS1.p2.6.m2.2.3.3.1"
                            xref="S5.SS1.p2.6.m2.2.3.3.1.cmml">/</mo><mi
                            id="S5.SS1.p2.6.m2.2.3.3.3"
                            xref="S5.SS1.p2.6.m2.2.3.3.3.cmml">Z</mi></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.6.m2.2b"><apply
                          id="S5.SS1.p2.6.m2.2.3.cmml"
                          xref="S5.SS1.p2.6.m2.2.3"><subset
                            id="S5.SS1.p2.6.m2.2.3.1.cmml"
                            xref="S5.SS1.p2.6.m2.2.3.1"></subset><ci
                            id="S5.SS1.p2.6.m2.2.3.2.cmml"
                            xref="S5.SS1.p2.6.m2.2.3.2">𝑊</ci><apply
                            id="S5.SS1.p2.6.m2.2.3.3.cmml"
                            xref="S5.SS1.p2.6.m2.2.3.3"><divide
                              id="S5.SS1.p2.6.m2.2.3.3.1.cmml"
                              xref="S5.SS1.p2.6.m2.2.3.3.1"></divide><set
                              id="S5.SS1.p2.6.m2.2.3.3.2.1.cmml"
                              xref="S5.SS1.p2.6.m2.2.3.3.2.2"><ci
                                id="S5.SS1.p2.6.m2.1.1.cmml"
                                xref="S5.SS1.p2.6.m2.1.1">𝑋</ci><ci
                                id="S5.SS1.p2.6.m2.2.2.cmml"
                                xref="S5.SS1.p2.6.m2.2.2">𝑌</ci></set><ci
                              id="S5.SS1.p2.6.m2.2.3.3.3.cmml"
                              xref="S5.SS1.p2.6.m2.2.3.3.3">𝑍</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.6.m2.2c">W\subset\{X,Y\}/Z</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.6.m2.2d">italic_W ⊂ { italic_X , italic_Y
                        } / italic_Z</annotation></semantics></math>.
                  Compared with the measure in <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib45"
                      title>45</a>]</cite>, an additional constraint is
                  introduced to preserve <math alttext="P(Z)" class="ltx_Math"
                    display="inline" id="S5.SS1.p2.7.m3.1"><semantics
                      id="S5.SS1.p2.7.m3.1a"><mrow id="S5.SS1.p2.7.m3.1.2"
                        xref="S5.SS1.p2.7.m3.1.2.cmml"><mi
                          id="S5.SS1.p2.7.m3.1.2.2"
                          xref="S5.SS1.p2.7.m3.1.2.2.cmml">P</mi><mo
                          id="S5.SS1.p2.7.m3.1.2.1"
                          xref="S5.SS1.p2.7.m3.1.2.1.cmml">⁢</mo><mrow
                          id="S5.SS1.p2.7.m3.1.2.3.2"
                          xref="S5.SS1.p2.7.m3.1.2.cmml"><mo
                            id="S5.SS1.p2.7.m3.1.2.3.2.1" stretchy="false"
                            xref="S5.SS1.p2.7.m3.1.2.cmml">(</mo><mi
                            id="S5.SS1.p2.7.m3.1.1"
                            xref="S5.SS1.p2.7.m3.1.1.cmml">Z</mi><mo
                            id="S5.SS1.p2.7.m3.1.2.3.2.2" stretchy="false"
                            xref="S5.SS1.p2.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.7.m3.1b"><apply
                          id="S5.SS1.p2.7.m3.1.2.cmml"
                          xref="S5.SS1.p2.7.m3.1.2"><times
                            id="S5.SS1.p2.7.m3.1.2.1.cmml"
                            xref="S5.SS1.p2.7.m3.1.2.1"></times><ci
                            id="S5.SS1.p2.7.m3.1.2.2.cmml"
                            xref="S5.SS1.p2.7.m3.1.2.2">𝑃</ci><ci
                            id="S5.SS1.p2.7.m3.1.1.cmml"
                            xref="S5.SS1.p2.7.m3.1.1">𝑍</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.7.m3.1c">P(Z)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.7.m3.1d">italic_P ( italic_Z
                        )</annotation></semantics></math> unchanged.
                  Addressing the conservatism problem associated with the
                  uncertainty set, Thams et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib118"
                      title>118</a>]</cite> incorporate a causal structure to
                  parameterize the uncertainty set.
                  This approach extends beyond covariate shifts, also
                  accommodating shifts in conditional distributions <math
                    alttext="Y|X" class="ltx_Math" display="inline"
                    id="S5.SS1.p2.8.m4.1"><semantics
                      id="S5.SS1.p2.8.m4.1a"><mrow id="S5.SS1.p2.8.m4.1.1"
                        xref="S5.SS1.p2.8.m4.1.1.cmml"><mi
                          id="S5.SS1.p2.8.m4.1.1.2"
                          xref="S5.SS1.p2.8.m4.1.1.2.cmml">Y</mi><mo
                          fence="false" id="S5.SS1.p2.8.m4.1.1.1"
                          xref="S5.SS1.p2.8.m4.1.1.1.cmml">|</mo><mi
                          id="S5.SS1.p2.8.m4.1.1.3"
                          xref="S5.SS1.p2.8.m4.1.1.3.cmml">X</mi></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS1.p2.8.m4.1b"><apply
                          id="S5.SS1.p2.8.m4.1.1.cmml"
                          xref="S5.SS1.p2.8.m4.1.1"><csymbol cd="latexml"
                            id="S5.SS1.p2.8.m4.1.1.1.cmml"
                            xref="S5.SS1.p2.8.m4.1.1.1">conditional</csymbol><ci
                            id="S5.SS1.p2.8.m4.1.1.2.cmml"
                            xref="S5.SS1.p2.8.m4.1.1.2">𝑌</ci><ci
                            id="S5.SS1.p2.8.m4.1.1.3.cmml"
                            xref="S5.SS1.p2.8.m4.1.1.3">𝑋</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS1.p2.8.m4.1c">Y|X</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS1.p2.8.m4.1d">italic_Y |
                        italic_X</annotation></semantics></math>.
                  By means of a pre-defined causal structure, they are able to
                  specifically consider distribution shifts pertaining to the
                  specific edges of interest on the causal graph.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S5.SS2">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">5.2 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S5.SS2.1.1">Stability</span>
              </h3>
              <div class="ltx_para" id="S5.SS2.p1">
                <p class="ltx_p" id="S5.SS2.p1.1">In conventional statistical
                  analysis, a substantial body of literature is dedicated to
                  sensitivity analysis.
                  This field of study explores the stability of estimations
                  under the influence of minor data perturbations.
                  Recently, there have been works <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib46"
                      title>46</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib119"
                      title>119</a>]</cite> adapting this concept to assess
                  model stability in the face of distribution shifts.</p>
              </div>
              <div class="ltx_para" id="S5.SS2.p2">
                <p class="ltx_p" id="S5.SS2.p2.5">Gupta and Rothenhäusler <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib46"
                      title>46</a>]</cite> propose a measure of instability that
                  quantifies the minimal perturbation required in the data
                  distribution to change the sign of the estimated parameters.
                </p>
                <table class="ltx_equationgroup ltx_eqn_table" id="S5.E11">
                  <tbody>
                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline"
                      id="S5.E11X">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                          alttext="\displaystyle s(\theta,P_{tr}):=\sup_{P\in\mathcal{P}}\exp\bigg{\{}-D_{\text{%
KL}}(P\|P_{tr})\bigg{\}}\quad\text{s.t.}\ \theta(P)=0," class="ltx_Math"
                          display="inline" id="S5.E11X.2.1.1.m1.4"><semantics
                            id="S5.E11X.2.1.1.m1.4a"><mrow
                              id="S5.E11X.2.1.1.m1.4.4.1"><mrow
                                id="S5.E11X.2.1.1.m1.4.4.1.1.2"
                                xref="S5.E11X.2.1.1.m1.4.4.1.1.3.cmml"><mrow
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.cmml"><mrow
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mi
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.3"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">s</mi><mo
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.2"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml"><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2"
                                        stretchy="false"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi
                                        id="S5.E11X.2.1.1.m1.1.1"
                                        xref="S5.E11X.2.1.1.m1.1.1.cmml">θ</mi><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">,</mo><msub
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">P</mi><mrow
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">r</mi></mrow></msub><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.4"
                                        rspace="0.278em" stretchy="false"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.3"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.3.cmml">:=</mo><mrow
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.cmml"><munder
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.cmml"><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.2"
                                        lspace="0.111em" movablelimits="false"
                                        rspace="0.167em"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml">sup</mo><mrow
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml"><mi
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.2"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.2.cmml">P</mi><mo
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.1"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml">∈</mo><mi
                                          class="ltx_font_mathcaligraphic"
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.3"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.3.cmml">𝒫</mi></mrow></munder><mrow
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml"><mi
                                        id="S5.E11X.2.1.1.m1.2.2"
                                        xref="S5.E11X.2.1.1.m1.2.2.cmml">exp</mi><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1a"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml">⁡</mo><mrow
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml"><mo
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.2"
                                          maxsize="210%" minsize="210%"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml">{</mo><mrow
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.cmml"><mo
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1a"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.cmml">−</mo><mrow
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.cmml"><msub
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.2"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.2.cmml">D</mi><mtext
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3a.cmml">KL</mtext></msub><mo
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.2"
                                                stretchy="false"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.2"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml">P</mi><mo
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.1"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi
                                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2"
                                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mrow
                                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3"
                                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi
                                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.2"
                                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo
                                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.1"
                                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi
                                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3"
                                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi></mrow></msub></mrow><mo
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.3"
                                                stretchy="false"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.3"
                                          maxsize="210%" minsize="210%"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><mspace
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.2.3" width="1em"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.3a.cmml"></mspace><mrow
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.2.2"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.cmml"><mrow
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.cmml"><mtext
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2a.cmml">s.t.</mtext><mo
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1"
                                      lspace="0.500em"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mi
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.3"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">θ</mi><mo
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1a"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mrow
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.4.2"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.cmml"><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.4.2.1"
                                        stretchy="false"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.cmml">(</mo><mi
                                        id="S5.E11X.2.1.1.m1.3.3"
                                        xref="S5.E11X.2.1.1.m1.3.3.cmml">P</mi><mo
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.4.2.2"
                                        stretchy="false"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.1"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.1.cmml">=</mo><mn
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.3"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo
                                id="S5.E11X.2.1.1.m1.4.4.1.2">,</mo></mrow><annotation-xml
                              encoding="MathML-Content"
                              id="S5.E11X.2.1.1.m1.4b"><apply
                                id="S5.E11X.2.1.1.m1.4.4.1.1.3.cmml"
                                xref="S5.E11X.2.1.1.m1.4.4.1.1.2"><csymbol
                                  cd="ambiguous"
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.3a.cmml"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.cmml"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1"><csymbol
                                    cd="latexml"
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.3.cmml"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.3">assign</csymbol><apply
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.cmml"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1"><times
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.2"></times><ci
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.3">𝑠</ci><interval
                                      closure="open"
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1"><ci
                                        id="S5.E11X.2.1.1.m1.1.1.cmml"
                                        xref="S5.E11X.2.1.1.m1.1.1">𝜃</ci><apply
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><csymbol
                                          cd="ambiguous"
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2">𝑃</ci><apply
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3"><times
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1"></times><ci
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply></interval></apply><apply
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.cmml"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2"><apply
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2"><csymbol
                                        cd="ambiguous"
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.1.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2">subscript</csymbol><csymbol
                                        cd="latexml"
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.2">supremum</csymbol><apply
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3"><in
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.1"></in><ci
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.2.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.2">𝑃</ci><ci
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.3.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.2.3.3">𝒫</ci></apply></apply><apply
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1"><exp
                                        id="S5.E11X.2.1.1.m1.2.2.cmml"
                                        xref="S5.E11X.2.1.1.m1.2.2"></exp><apply
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1"><minus
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.2.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1"></minus><apply
                                          id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.cmml"
                                          xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1"><times
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2"></times><apply
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3"><csymbol
                                              cd="ambiguous"
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.1.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.2.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.2">𝐷</ci><ci
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3a.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3"><mtext
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3.cmml"
                                                mathsize="70%"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.3">KL</mtext></ci></apply><apply
                                            id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"
                                            xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol
                                              cd="latexml"
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.2">𝑃</ci><apply
                                              id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml"
                                              xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol
                                                cd="ambiguous"
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2">𝑃</ci><apply
                                                id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml"
                                                xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3"><times
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.1.cmml"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.1"></times><ci
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.2.cmml"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci
                                                  id="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3.cmml"
                                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply></apply></apply></apply></apply></apply><apply
                                  id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.cmml"
                                  xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2"><eq
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.1.cmml"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.1"></eq><apply
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.cmml"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2"><times
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.1"></times><ci
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2a.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2"><mtext
                                        id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2.cmml"
                                        xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.2">s.t.</mtext></ci><ci
                                      id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml"
                                      xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.2.3">𝜃</ci><ci
                                      id="S5.E11X.2.1.1.m1.3.3.cmml"
                                      xref="S5.E11X.2.1.1.m1.3.3">𝑃</ci></apply><cn
                                    id="S5.E11X.2.1.1.m1.4.4.1.1.2.2.3.cmml"
                                    type="integer"
                                    xref="S5.E11X.2.1.1.m1.4.4.1.1.2.2.3">0</cn></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E11X.2.1.1.m1.4c">\displaystyle
                              s(\theta,P_{tr}):=\sup_{P\in\mathcal{P}}\exp\bigg{\{}-D_{\text{%
                              KL}}(P\|P_{tr})\bigg{\}}\quad\text{s.t.}\
                              \theta(P)=0,</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E11X.2.1.1.m1.4d">italic_s ( italic_θ ,
                              italic_P start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT ) := roman_sup
                              start_POSTSUBSCRIPT italic_P ∈ caligraphic_P
                              end_POSTSUBSCRIPT roman_exp { - italic_D
                              start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT (
                              italic_P ∥ italic_P start_POSTSUBSCRIPT italic_t
                              italic_r end_POSTSUBSCRIPT ) } s.t. italic_θ (
                              italic_P ) = 0
                              ,</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
                    </tr>
                  </tbody>
                </table>
                <p class="ltx_p" id="S5.SS2.p2.1">where <math
                    alttext="D_{\text{KL}}(\cdot\|\cdot)"
                    class="ltx_math_unparsed" display="inline"
                    id="S5.SS2.p2.1.m1.1"><semantics
                      id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1b"><msub
                          id="S5.SS2.p2.1.m1.1.1"><mi
                            id="S5.SS2.p2.1.m1.1.1.2">D</mi><mtext
                            id="S5.SS2.p2.1.m1.1.1.3">KL</mtext></msub><mrow
                          id="S5.SS2.p2.1.m1.1.2"><mo id="S5.SS2.p2.1.m1.1.2.1"
                            stretchy="false">(</mo><mo id="S5.SS2.p2.1.m1.1.2.2"
                            lspace="0em" rspace="0em">⋅</mo><mo
                            id="S5.SS2.p2.1.m1.1.2.3" lspace="0em"
                            rspace="0em">∥</mo><mo id="S5.SS2.p2.1.m1.1.2.4"
                            lspace="0em" rspace="0em">⋅</mo><mo
                            id="S5.SS2.p2.1.m1.1.2.5"
                            stretchy="false">)</mo></mrow></mrow><annotation
                        encoding="application/x-tex"
                        id="S5.SS2.p2.1.m1.1c">D_{\text{KL}}(\cdot\|\cdot)</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS2.p2.1.m1.1d">italic_D start_POSTSUBSCRIPT KL
                        end_POSTSUBSCRIPT ( ⋅ ∥ ⋅
                        )</annotation></semantics></math> denotes the
                  KL-divergence.
                  Contrary to the distributional robustness notions in Section
                  <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#S5.SS1"
                    title="5.1 Distributional Robustness ‣ 5 OOD intrinsic property characterization ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                      class="ltx_text ltx_ref_tag">5.1</span></a>, which
                  quantify worst-case risks, this stability measure evaluates
                  the magnitude of perturbations required to compromise an
                  estimator.
                  Extending beyond parameter estimation, Namkoong et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib119"
                      title>119</a>]</cite> substitute the constraints with
                  prediction error, investigating the extent of the distribution
                  shift needed to degrade system performance to an unacceptable
                  level.</p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E12">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="I_{t}(P_{tr}):=\inf_{Q}\bigg{\{}D_{\text{KL}}(Q\|P_{tr}):\mathbb{E}_{Q}[\ell]%
\geq t\bigg{\}}," class="ltx_math_unparsed" display="block"
                          id="S5.E12.m1.1"><semantics id="S5.E12.m1.1a"><mrow
                              id="S5.E12.m1.1b"><msub id="S5.E12.m1.1.1"><mi
                                  id="S5.E12.m1.1.1.2">I</mi><mi
                                  id="S5.E12.m1.1.1.3">t</mi></msub><mrow
                                id="S5.E12.m1.1.2"><mo id="S5.E12.m1.1.2.1"
                                  stretchy="false">(</mo><msub
                                  id="S5.E12.m1.1.2.2"><mi
                                    id="S5.E12.m1.1.2.2.2">P</mi><mrow
                                    id="S5.E12.m1.1.2.2.3"><mi
                                      id="S5.E12.m1.1.2.2.3.2">t</mi><mo
                                      id="S5.E12.m1.1.2.2.3.1">⁢</mo><mi
                                      id="S5.E12.m1.1.2.2.3.3">r</mi></mrow></msub><mo
                                  id="S5.E12.m1.1.2.3" rspace="0.278em"
                                  stretchy="false">)</mo></mrow><mo
                                id="S5.E12.m1.1.3">:=</mo><munder
                                id="S5.E12.m1.1.4"><mo id="S5.E12.m1.1.4.2"
                                  lspace="0.111em" movablelimits="false"
                                  rspace="0em">inf</mo><mi
                                  id="S5.E12.m1.1.4.3">Q</mi></munder><mrow
                                id="S5.E12.m1.1.5"><mo id="S5.E12.m1.1.5.1"
                                  maxsize="210%" minsize="210%">{</mo><msub
                                  id="S5.E12.m1.1.5.2"><mi
                                    id="S5.E12.m1.1.5.2.2">D</mi><mtext
                                    id="S5.E12.m1.1.5.2.3">KL</mtext></msub><mrow
                                  id="S5.E12.m1.1.5.3"><mo
                                    id="S5.E12.m1.1.5.3.1"
                                    stretchy="false">(</mo><mi
                                    id="S5.E12.m1.1.5.3.2">Q</mi><mo
                                    id="S5.E12.m1.1.5.3.3" lspace="0em"
                                    rspace="0.167em">∥</mo><msub
                                    id="S5.E12.m1.1.5.3.4"><mi
                                      id="S5.E12.m1.1.5.3.4.2">P</mi><mrow
                                      id="S5.E12.m1.1.5.3.4.3"><mi
                                        id="S5.E12.m1.1.5.3.4.3.2">t</mi><mo
                                        id="S5.E12.m1.1.5.3.4.3.1">⁢</mo><mi
                                        id="S5.E12.m1.1.5.3.4.3.3">r</mi></mrow></msub><mo
                                    id="S5.E12.m1.1.5.3.5" rspace="0.278em"
                                    stretchy="false">)</mo></mrow><mo
                                  id="S5.E12.m1.1.5.4"
                                  rspace="0.278em">:</mo><msub
                                  id="S5.E12.m1.1.5.5"><mi
                                    id="S5.E12.m1.1.5.5.2">𝔼</mi><mi
                                    id="S5.E12.m1.1.5.5.3">Q</mi></msub><mrow
                                  id="S5.E12.m1.1.5.6"><mo
                                    id="S5.E12.m1.1.5.6.1"
                                    stretchy="false">[</mo><mi
                                    id="S5.E12.m1.1.5.6.2"
                                    mathvariant="normal">ℓ</mi><mo
                                    id="S5.E12.m1.1.5.6.3"
                                    stretchy="false">]</mo></mrow><mo
                                  id="S5.E12.m1.1.5.7">≥</mo><mi
                                  id="S5.E12.m1.1.5.8">t</mi><mo
                                  id="S5.E12.m1.1.5.9" maxsize="210%"
                                  minsize="210%">}</mo></mrow><mo
                                id="S5.E12.m1.1.6">,</mo></mrow><annotation
                              encoding="application/x-tex"
                              id="S5.E12.m1.1c">I_{t}(P_{tr}):=\inf_{Q}\bigg{\{}D_{\text{KL}}(Q\|P_{tr}):\mathbb{E}_{Q}[\ell]%
                              \geq t\bigg{\}},</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E12.m1.1d">italic_I start_POSTSUBSCRIPT
                              italic_t end_POSTSUBSCRIPT ( italic_P
                              start_POSTSUBSCRIPT italic_t italic_r
                              end_POSTSUBSCRIPT ) := roman_inf
                              start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT {
                              italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT
                              ( italic_Q ∥ italic_P start_POSTSUBSCRIPT italic_t
                              italic_r end_POSTSUBSCRIPT ) : blackboard_E
                              start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [
                              roman_ℓ ] ≥ italic_t }
                              ,</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS2.p2.4">where <math alttext="t&gt;0"
                    class="ltx_Math" display="inline"
                    id="S5.SS2.p2.2.m1.1"><semantics
                      id="S5.SS2.p2.2.m1.1a"><mrow id="S5.SS2.p2.2.m1.1.1"
                        xref="S5.SS2.p2.2.m1.1.1.cmml"><mi
                          id="S5.SS2.p2.2.m1.1.1.2"
                          xref="S5.SS2.p2.2.m1.1.1.2.cmml">t</mi><mo
                          id="S5.SS2.p2.2.m1.1.1.1"
                          xref="S5.SS2.p2.2.m1.1.1.1.cmml">&gt;</mo><mn
                          id="S5.SS2.p2.2.m1.1.1.3"
                          xref="S5.SS2.p2.2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS2.p2.2.m1.1b"><apply
                          id="S5.SS2.p2.2.m1.1.1.cmml"
                          xref="S5.SS2.p2.2.m1.1.1"><gt
                            id="S5.SS2.p2.2.m1.1.1.1.cmml"
                            xref="S5.SS2.p2.2.m1.1.1.1"></gt><ci
                            id="S5.SS2.p2.2.m1.1.1.2.cmml"
                            xref="S5.SS2.p2.2.m1.1.1.2">𝑡</ci><cn
                            id="S5.SS2.p2.2.m1.1.1.3.cmml" type="integer"
                            xref="S5.SS2.p2.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS2.p2.2.m1.1c">t&gt;0</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS2.p2.2.m1.1d">italic_t &gt;
                        0</annotation></semantics></math> is the threshold, and
                  <math alttext="\ell" class="ltx_Math" display="inline"
                    id="S5.SS2.p2.3.m2.1"><semantics id="S5.SS2.p2.3.m2.1a"><mi
                        id="S5.SS2.p2.3.m2.1.1" mathvariant="normal"
                        xref="S5.SS2.p2.3.m2.1.1.cmml">ℓ</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS2.p2.3.m2.1b"><ci
                          id="S5.SS2.p2.3.m2.1.1.cmml"
                          xref="S5.SS2.p2.3.m2.1.1">ℓ</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS2.p2.3.m2.1c">\ell</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS2.p2.3.m2.1d">roman_ℓ</annotation></semantics></math>
                  denotes the model prediction error.
                  This stability metric evaluates the tail performance with
                  respect to the distribution <math alttext="P_{tr}"
                    class="ltx_Math" display="inline"
                    id="S5.SS2.p2.4.m3.1"><semantics
                      id="S5.SS2.p2.4.m3.1a"><msub id="S5.SS2.p2.4.m3.1.1"
                        xref="S5.SS2.p2.4.m3.1.1.cmml"><mi
                          id="S5.SS2.p2.4.m3.1.1.2"
                          xref="S5.SS2.p2.4.m3.1.1.2.cmml">P</mi><mrow
                          id="S5.SS2.p2.4.m3.1.1.3"
                          xref="S5.SS2.p2.4.m3.1.1.3.cmml"><mi
                            id="S5.SS2.p2.4.m3.1.1.3.2"
                            xref="S5.SS2.p2.4.m3.1.1.3.2.cmml">t</mi><mo
                            id="S5.SS2.p2.4.m3.1.1.3.1"
                            xref="S5.SS2.p2.4.m3.1.1.3.1.cmml">⁢</mo><mi
                            id="S5.SS2.p2.4.m3.1.1.3.3"
                            xref="S5.SS2.p2.4.m3.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S5.SS2.p2.4.m3.1b"><apply
                          id="S5.SS2.p2.4.m3.1.1.cmml"
                          xref="S5.SS2.p2.4.m3.1.1"><csymbol cd="ambiguous"
                            id="S5.SS2.p2.4.m3.1.1.1.cmml"
                            xref="S5.SS2.p2.4.m3.1.1">subscript</csymbol><ci
                            id="S5.SS2.p2.4.m3.1.1.2.cmml"
                            xref="S5.SS2.p2.4.m3.1.1.2">𝑃</ci><apply
                            id="S5.SS2.p2.4.m3.1.1.3.cmml"
                            xref="S5.SS2.p2.4.m3.1.1.3"><times
                              id="S5.SS2.p2.4.m3.1.1.3.1.cmml"
                              xref="S5.SS2.p2.4.m3.1.1.3.1"></times><ci
                              id="S5.SS2.p2.4.m3.1.1.3.2.cmml"
                              xref="S5.SS2.p2.4.m3.1.1.3.2">𝑡</ci><ci
                              id="S5.SS2.p2.4.m3.1.1.3.3.cmml"
                              xref="S5.SS2.p2.4.m3.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS2.p2.4.m3.1c">P_{tr}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS2.p2.4.m3.1d">italic_P start_POSTSUBSCRIPT
                        italic_t italic_r
                        end_POSTSUBSCRIPT</annotation></semantics></math>.
                  Compared with distributional robustness, which requires the
                  pre-specification of the uncertainty set’s size, stability
                  measures are more intuitive and interpretable.
                  Machine learning engineers can more readily decide on a
                  tolerable amount of prediction error based on their domain
                  knowledge.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S5.SS3">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">5.3 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S5.SS3.1.1">Invariance</span>
              </h3>
              <div class="ltx_para" id="S5.SS3.p1">
                <p class="ltx_p" id="S5.SS3.p1.1">In addition to distributional
                  robustness and stability, there exists a diverse range of
                  methods designed to determine whether the learned predictive
                  relationship remains invariant across varying training
                  environments or subpopulations.
                  These methods are natural extensions of invariant learning,
                  where many algorithms have been proposed to learn the
                  invariant relationship between covariates and labels.
                  Actually, the proposed penalties or regularizers in invariant
                  learning algorithms <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                      title>22</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib23"
                      title>23</a>]</cite> could all be utilized to reflect
                  whether a model captures the invariance or not.
                  In this section, we introduce some typical penalties in
                  invariant learning, and one could refer to Shen et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                      title>7</a>]</cite> for a detailed review.</p>
              </div>
              <div class="ltx_para" id="S5.SS3.p2">
                <p class="ltx_p" id="S5.SS3.p2.5">Drawing inspiration from
                  causal inference, Invariant Risk Minimization (IRM, <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                      title>22</a>]</cite>) extends Invariant Causal Prediction
                  (ICP, <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib120"
                      title>120</a>]</cite>) to more applicable settings.
                  IRM <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib22"
                      title>22</a>]</cite> employs first-order information to
                  quantify any violation of the invariance principle.
                  The invariance penalty is approximated as follows:</p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E13">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="\sum_{e\in\mathcal{E}_{tr}}\bigg{\|}\nabla_{w|w=1.0}R^{e}(w\cdot\Phi)\bigg{\|}%
^{2}," class="ltx_Math" display="block" id="S5.E13.m1.1"><semantics
                            id="S5.E13.m1.1a"><mrow id="S5.E13.m1.1.1.1"
                              xref="S5.E13.m1.1.1.1.1.cmml"><mrow
                                id="S5.E13.m1.1.1.1.1"
                                xref="S5.E13.m1.1.1.1.1.cmml"><munder
                                  id="S5.E13.m1.1.1.1.1.2"
                                  xref="S5.E13.m1.1.1.1.1.2.cmml"><mo
                                    id="S5.E13.m1.1.1.1.1.2.2"
                                    movablelimits="false"
                                    xref="S5.E13.m1.1.1.1.1.2.2.cmml">∑</mo><mrow
                                    id="S5.E13.m1.1.1.1.1.2.3"
                                    xref="S5.E13.m1.1.1.1.1.2.3.cmml"><mi
                                      id="S5.E13.m1.1.1.1.1.2.3.2"
                                      xref="S5.E13.m1.1.1.1.1.2.3.2.cmml">e</mi><mo
                                      id="S5.E13.m1.1.1.1.1.2.3.1"
                                      xref="S5.E13.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub
                                      id="S5.E13.m1.1.1.1.1.2.3.3"
                                      xref="S5.E13.m1.1.1.1.1.2.3.3.cmml"><mi
                                        class="ltx_font_mathcaligraphic"
                                        id="S5.E13.m1.1.1.1.1.2.3.3.2"
                                        xref="S5.E13.m1.1.1.1.1.2.3.3.2.cmml">ℰ</mi><mrow
                                        id="S5.E13.m1.1.1.1.1.2.3.3.3"
                                        xref="S5.E13.m1.1.1.1.1.2.3.3.3.cmml"><mi
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.2"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.2.cmml">t</mi><mo
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.1"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.1.cmml">⁢</mo><mi
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.3"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.3.cmml">r</mi></mrow></msub></mrow></munder><msup
                                  id="S5.E13.m1.1.1.1.1.1"
                                  xref="S5.E13.m1.1.1.1.1.1.cmml"><mrow
                                    id="S5.E13.m1.1.1.1.1.1.1.1"
                                    xref="S5.E13.m1.1.1.1.1.1.1.2.cmml"><mo
                                      id="S5.E13.m1.1.1.1.1.1.1.1.2"
                                      lspace="0em" maxsize="210%" minsize="210%"
                                      xref="S5.E13.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow
                                      id="S5.E13.m1.1.1.1.1.1.1.1.1"
                                      xref="S5.E13.m1.1.1.1.1.1.1.1.1.cmml"><mrow
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.3"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.cmml"><msub
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml"><mo
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.2"
                                            rspace="0.167em"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><mrow
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.cmml"><mrow
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.cmml"><mi
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.2"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.2.cmml">w</mi><mo
                                                fence="false"
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.1"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.1.cmml">|</mo><mi
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.3"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.3.cmml">w</mi></mrow><mo
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.1"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.1.cmml">=</mo><mn
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.3"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.3.cmml">1.0</mn></mrow></msub><msup
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.2"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">R</mi><mi
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.3"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">e</mi></msup></mrow><mo
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.2"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.2"
                                          stretchy="false"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mo
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1"
                                            lspace="0.222em" rspace="0.222em"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><mi
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3"
                                            mathvariant="normal"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">Φ</mi></mrow><mo
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.3"
                                          stretchy="false"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                      id="S5.E13.m1.1.1.1.1.1.1.1.3"
                                      maxsize="210%" minsize="210%"
                                      xref="S5.E13.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn
                                    id="S5.E13.m1.1.1.1.1.1.3"
                                    xref="S5.E13.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo
                                id="S5.E13.m1.1.1.1.2"
                                xref="S5.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml
                              encoding="MathML-Content" id="S5.E13.m1.1b"><apply
                                id="S5.E13.m1.1.1.1.1.cmml"
                                xref="S5.E13.m1.1.1.1"><apply
                                  id="S5.E13.m1.1.1.1.1.2.cmml"
                                  xref="S5.E13.m1.1.1.1.1.2"><csymbol
                                    cd="ambiguous"
                                    id="S5.E13.m1.1.1.1.1.2.1.cmml"
                                    xref="S5.E13.m1.1.1.1.1.2">subscript</csymbol><sum
                                    id="S5.E13.m1.1.1.1.1.2.2.cmml"
                                    xref="S5.E13.m1.1.1.1.1.2.2"></sum><apply
                                    id="S5.E13.m1.1.1.1.1.2.3.cmml"
                                    xref="S5.E13.m1.1.1.1.1.2.3"><in
                                      id="S5.E13.m1.1.1.1.1.2.3.1.cmml"
                                      xref="S5.E13.m1.1.1.1.1.2.3.1"></in><ci
                                      id="S5.E13.m1.1.1.1.1.2.3.2.cmml"
                                      xref="S5.E13.m1.1.1.1.1.2.3.2">𝑒</ci><apply
                                      id="S5.E13.m1.1.1.1.1.2.3.3.cmml"
                                      xref="S5.E13.m1.1.1.1.1.2.3.3"><csymbol
                                        cd="ambiguous"
                                        id="S5.E13.m1.1.1.1.1.2.3.3.1.cmml"
                                        xref="S5.E13.m1.1.1.1.1.2.3.3">subscript</csymbol><ci
                                        id="S5.E13.m1.1.1.1.1.2.3.3.2.cmml"
                                        xref="S5.E13.m1.1.1.1.1.2.3.3.2">ℰ</ci><apply
                                        id="S5.E13.m1.1.1.1.1.2.3.3.3.cmml"
                                        xref="S5.E13.m1.1.1.1.1.2.3.3.3"><times
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.1.cmml"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.1"></times><ci
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.2.cmml"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.2">𝑡</ci><ci
                                          id="S5.E13.m1.1.1.1.1.2.3.3.3.3.cmml"
                                          xref="S5.E13.m1.1.1.1.1.2.3.3.3.3">𝑟</ci></apply></apply></apply></apply><apply
                                  id="S5.E13.m1.1.1.1.1.1.cmml"
                                  xref="S5.E13.m1.1.1.1.1.1"><csymbol
                                    cd="ambiguous"
                                    id="S5.E13.m1.1.1.1.1.1.2.cmml"
                                    xref="S5.E13.m1.1.1.1.1.1">superscript</csymbol><apply
                                    id="S5.E13.m1.1.1.1.1.1.1.2.cmml"
                                    xref="S5.E13.m1.1.1.1.1.1.1.1"><csymbol
                                      cd="latexml"
                                      id="S5.E13.m1.1.1.1.1.1.1.2.1.cmml"
                                      xref="S5.E13.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply
                                      id="S5.E13.m1.1.1.1.1.1.1.1.1.cmml"
                                      xref="S5.E13.m1.1.1.1.1.1.1.1.1"><times
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.2.cmml"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.2"></times><apply
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.3.cmml"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.3"><apply
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1"><csymbol
                                            cd="ambiguous"
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.1.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.2.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.2">∇</ci><apply
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3"><eq
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.1.cmml"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.1"></eq><apply
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.cmml"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2"><csymbol
                                                cd="latexml"
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.1.cmml"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.1">conditional</csymbol><ci
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.2.cmml"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.2">𝑤</ci><ci
                                                id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.3.cmml"
                                                xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.2.3">𝑤</ci></apply><cn
                                              id="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.3.cmml"
                                              type="float"
                                              xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.1.3.3">1.0</cn></apply></apply><apply
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2"><csymbol
                                            cd="ambiguous"
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.1.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.2.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.2">𝑅</ci><ci
                                            id="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"
                                            xref="S5.E13.m1.1.1.1.1.1.1.1.1.3.2.3">𝑒</ci></apply></apply><apply
                                        id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                        xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1"><ci
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1">⋅</ci><ci
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci
                                          id="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"
                                          xref="S5.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3">Φ</ci></apply></apply></apply><cn
                                    id="S5.E13.m1.1.1.1.1.1.3.cmml"
                                    type="integer"
                                    xref="S5.E13.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E13.m1.1c">\sum_{e\in\mathcal{E}_{tr}}\bigg{\|}\nabla_{w|w=1.0}R^{e}(w\cdot\Phi)\bigg{\|}%
                              ^{2},</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E13.m1.1d">∑ start_POSTSUBSCRIPT italic_e ∈
                              caligraphic_E start_POSTSUBSCRIPT italic_t
                              italic_r end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ ∇
                              start_POSTSUBSCRIPT italic_w | italic_w = 1.0
                              end_POSTSUBSCRIPT italic_R start_POSTSUPERSCRIPT
                              italic_e end_POSTSUPERSCRIPT ( italic_w ⋅ roman_Φ
                              ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT
                              ,</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS3.p2.4">Here, <math
                    alttext="\mathcal{E}_{tr}" class="ltx_Math" display="inline"
                    id="S5.SS3.p2.1.m1.1"><semantics
                      id="S5.SS3.p2.1.m1.1a"><msub id="S5.SS3.p2.1.m1.1.1"
                        xref="S5.SS3.p2.1.m1.1.1.cmml"><mi
                          class="ltx_font_mathcaligraphic"
                          id="S5.SS3.p2.1.m1.1.1.2"
                          xref="S5.SS3.p2.1.m1.1.1.2.cmml">ℰ</mi><mrow
                          id="S5.SS3.p2.1.m1.1.1.3"
                          xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mi
                            id="S5.SS3.p2.1.m1.1.1.3.2"
                            xref="S5.SS3.p2.1.m1.1.1.3.2.cmml">t</mi><mo
                            id="S5.SS3.p2.1.m1.1.1.3.1"
                            xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi
                            id="S5.SS3.p2.1.m1.1.1.3.3"
                            xref="S5.SS3.p2.1.m1.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml
                        encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply
                          id="S5.SS3.p2.1.m1.1.1.cmml"
                          xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous"
                            id="S5.SS3.p2.1.m1.1.1.1.cmml"
                            xref="S5.SS3.p2.1.m1.1.1">subscript</csymbol><ci
                            id="S5.SS3.p2.1.m1.1.1.2.cmml"
                            xref="S5.SS3.p2.1.m1.1.1.2">ℰ</ci><apply
                            id="S5.SS3.p2.1.m1.1.1.3.cmml"
                            xref="S5.SS3.p2.1.m1.1.1.3"><times
                              id="S5.SS3.p2.1.m1.1.1.3.1.cmml"
                              xref="S5.SS3.p2.1.m1.1.1.3.1"></times><ci
                              id="S5.SS3.p2.1.m1.1.1.3.2.cmml"
                              xref="S5.SS3.p2.1.m1.1.1.3.2">𝑡</ci><ci
                              id="S5.SS3.p2.1.m1.1.1.3.3.cmml"
                              xref="S5.SS3.p2.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS3.p2.1.m1.1c">\mathcal{E}_{tr}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS3.p2.1.m1.1d">caligraphic_E start_POSTSUBSCRIPT
                        italic_t italic_r
                        end_POSTSUBSCRIPT</annotation></semantics></math>
                  denotes the set of training environments, <math
                    alttext="\mathbb{R}^{e}" class="ltx_Math" display="inline"
                    id="S5.SS3.p2.2.m2.1"><semantics
                      id="S5.SS3.p2.2.m2.1a"><msup id="S5.SS3.p2.2.m2.1.1"
                        xref="S5.SS3.p2.2.m2.1.1.cmml"><mi
                          id="S5.SS3.p2.2.m2.1.1.2"
                          xref="S5.SS3.p2.2.m2.1.1.2.cmml">ℝ</mi><mi
                          id="S5.SS3.p2.2.m2.1.1.3"
                          xref="S5.SS3.p2.2.m2.1.1.3.cmml">e</mi></msup><annotation-xml
                        encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply
                          id="S5.SS3.p2.2.m2.1.1.cmml"
                          xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous"
                            id="S5.SS3.p2.2.m2.1.1.1.cmml"
                            xref="S5.SS3.p2.2.m2.1.1">superscript</csymbol><ci
                            id="S5.SS3.p2.2.m2.1.1.2.cmml"
                            xref="S5.SS3.p2.2.m2.1.1.2">ℝ</ci><ci
                            id="S5.SS3.p2.2.m2.1.1.3.cmml"
                            xref="S5.SS3.p2.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS3.p2.2.m2.1c">\mathbb{R}^{e}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS3.p2.2.m2.1d">blackboard_R
                        start_POSTSUPERSCRIPT italic_e
                        end_POSTSUPERSCRIPT</annotation></semantics></math>
                  represents the prediction risk in environment <math
                    alttext="e" class="ltx_Math" display="inline"
                    id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mi
                        id="S5.SS3.p2.3.m3.1.1"
                        xref="S5.SS3.p2.3.m3.1.1.cmml">e</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><ci
                          id="S5.SS3.p2.3.m3.1.1.cmml"
                          xref="S5.SS3.p2.3.m3.1.1">𝑒</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS3.p2.3.m3.1c">e</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS3.p2.3.m3.1d">italic_e</annotation></semantics></math>,
                  and <math alttext="w,\Phi" class="ltx_Math" display="inline"
                    id="S5.SS3.p2.4.m4.2"><semantics
                      id="S5.SS3.p2.4.m4.2a"><mrow id="S5.SS3.p2.4.m4.2.3.2"
                        xref="S5.SS3.p2.4.m4.2.3.1.cmml"><mi
                          id="S5.SS3.p2.4.m4.1.1"
                          xref="S5.SS3.p2.4.m4.1.1.cmml">w</mi><mo
                          id="S5.SS3.p2.4.m4.2.3.2.1"
                          xref="S5.SS3.p2.4.m4.2.3.1.cmml">,</mo><mi
                          id="S5.SS3.p2.4.m4.2.2" mathvariant="normal"
                          xref="S5.SS3.p2.4.m4.2.2.cmml">Φ</mi></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS3.p2.4.m4.2b"><list
                          id="S5.SS3.p2.4.m4.2.3.1.cmml"
                          xref="S5.SS3.p2.4.m4.2.3.2"><ci
                            id="S5.SS3.p2.4.m4.1.1.cmml"
                            xref="S5.SS3.p2.4.m4.1.1">𝑤</ci><ci
                            id="S5.SS3.p2.4.m4.2.2.cmml"
                            xref="S5.SS3.p2.4.m4.2.2">Φ</ci></list></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS3.p2.4.m4.2c">w,\Phi</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS3.p2.4.m4.2d">italic_w ,
                        roman_Φ</annotation></semantics></math> stand for the
                  linear classifier and representation, respectively.
                  When this measure equals 0, it indicates that the learned
                  representation is optimal across the training environments.
                  Based on IRM, subsequent research (Section 4.1 in Shen et al.
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib7"
                      title>7</a>]</cite>) has proposed various forms of first-
                  or second-order information to signify invariance.
                  Moreover, from a validation standpoint, Ye et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib47"
                      title>47</a>]</cite> introduce a rigorous theoretical
                  framework addressing the out-of-distribution (OOD)
                  generalization problem. Through their theoretical analysis,
                  they derive a model selection criterion to quantify the
                  variation in learned representations.
                  Furthermore, drawing inspiration from multi-group calibration,
                  Wald et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib121"
                      title>121</a>]</cite> establish a relationship between
                  multi-group calibration and the invariance principle.
                  As a result, they propose Calibration Loss Over Environments
                  (CLOvE) for model selection.
                  When explicit environments cannot be predetermined, Liu et al.
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib23"
                      title>23</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib122"
                      title>122</a>]</cite> suggest initially exploring the
                  latent heterogeneity within the data.
                  Following this, the heterogeneous subpopulations can be
                  incorporated with invariance penalties.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S5.SS4">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">5.4 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S5.SS4.1.1">Flatness</span>
              </h3>
              <div class="ltx_para" id="S5.SS4.p1">
                <p class="ltx_p" id="S5.SS4.p1.1">The relationship between
                  flatness and generalization has long been investigated <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib123"
                      title>123</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib124"
                      title>124</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib125"
                      title>125</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib50"
                      title>50</a>]</cite>. It is widely acknowledged that a
                  flatter minimum leads to a better ID generalization ability.
                  Moreover, recently there have been many works focusing on
                  extending flatness to the area of OOD generalization, through
                  either directly defining a flatness metric or an ensemble of
                  network parameters to seek flatness.</p>
              </div>
              <div class="ltx_para" id="S5.SS4.p2">
                <p class="ltx_p" id="S5.SS4.p2.5">The most widely adopted
                  flatness metric is proposed in Sharpness-Aware Minimization
                  (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib50"
                      title>50</a>]</cite>, defined as the maximal loss gap
                  between the given point and the points in the
                  neighborhood:</p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E14">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="R_{\rho}^{SAM}(\boldsymbol{\theta}):=\max_{\boldsymbol{\theta}^{\prime}\in B(%
\boldsymbol{\theta},\rho)}\left(\hat{L}(\boldsymbol{\theta}^{\prime})-\hat{L}(%
\boldsymbol{\theta})\right)" class="ltx_Math" display="block"
                          id="S5.E14.m1.6"><semantics id="S5.E14.m1.6a"><mrow
                              id="S5.E14.m1.6.6" xref="S5.E14.m1.6.6.cmml"><mrow
                                id="S5.E14.m1.6.6.4"
                                xref="S5.E14.m1.6.6.4.cmml"><msubsup
                                  id="S5.E14.m1.6.6.4.2"
                                  xref="S5.E14.m1.6.6.4.2.cmml"><mi
                                    id="S5.E14.m1.6.6.4.2.2.2"
                                    xref="S5.E14.m1.6.6.4.2.2.2.cmml">R</mi><mi
                                    id="S5.E14.m1.6.6.4.2.2.3"
                                    xref="S5.E14.m1.6.6.4.2.2.3.cmml">ρ</mi><mrow
                                    id="S5.E14.m1.6.6.4.2.3"
                                    xref="S5.E14.m1.6.6.4.2.3.cmml"><mi
                                      id="S5.E14.m1.6.6.4.2.3.2"
                                      xref="S5.E14.m1.6.6.4.2.3.2.cmml">S</mi><mo
                                      id="S5.E14.m1.6.6.4.2.3.1"
                                      xref="S5.E14.m1.6.6.4.2.3.1.cmml">⁢</mo><mi
                                      id="S5.E14.m1.6.6.4.2.3.3"
                                      xref="S5.E14.m1.6.6.4.2.3.3.cmml">A</mi><mo
                                      id="S5.E14.m1.6.6.4.2.3.1a"
                                      xref="S5.E14.m1.6.6.4.2.3.1.cmml">⁢</mo><mi
                                      id="S5.E14.m1.6.6.4.2.3.4"
                                      xref="S5.E14.m1.6.6.4.2.3.4.cmml">M</mi></mrow></msubsup><mo
                                  id="S5.E14.m1.6.6.4.1"
                                  xref="S5.E14.m1.6.6.4.1.cmml">⁢</mo><mrow
                                  id="S5.E14.m1.6.6.4.3.2"
                                  xref="S5.E14.m1.6.6.4.cmml"><mo
                                    id="S5.E14.m1.6.6.4.3.2.1" stretchy="false"
                                    xref="S5.E14.m1.6.6.4.cmml">(</mo><mi
                                    id="S5.E14.m1.3.3"
                                    xref="S5.E14.m1.3.3.cmml">𝜽</mi><mo
                                    id="S5.E14.m1.6.6.4.3.2.2" rspace="0.278em"
                                    stretchy="false"
                                    xref="S5.E14.m1.6.6.4.cmml">)</mo></mrow></mrow><mo
                                id="S5.E14.m1.6.6.3" rspace="0.278em"
                                xref="S5.E14.m1.6.6.3.cmml">:=</mo><mrow
                                id="S5.E14.m1.6.6.2.2"
                                xref="S5.E14.m1.6.6.2.3.cmml"><munder
                                  id="S5.E14.m1.5.5.1.1.1"
                                  xref="S5.E14.m1.5.5.1.1.1.cmml"><mi
                                    id="S5.E14.m1.5.5.1.1.1.2"
                                    xref="S5.E14.m1.5.5.1.1.1.2.cmml">max</mi><mrow
                                    id="S5.E14.m1.2.2.2"
                                    xref="S5.E14.m1.2.2.2.cmml"><msup
                                      id="S5.E14.m1.2.2.2.4"
                                      xref="S5.E14.m1.2.2.2.4.cmml"><mi
                                        id="S5.E14.m1.2.2.2.4.2"
                                        xref="S5.E14.m1.2.2.2.4.2.cmml">𝜽</mi><mo
                                        id="S5.E14.m1.2.2.2.4.3"
                                        xref="S5.E14.m1.2.2.2.4.3.cmml">′</mo></msup><mo
                                      id="S5.E14.m1.2.2.2.3"
                                      xref="S5.E14.m1.2.2.2.3.cmml">∈</mo><mrow
                                      id="S5.E14.m1.2.2.2.5"
                                      xref="S5.E14.m1.2.2.2.5.cmml"><mi
                                        id="S5.E14.m1.2.2.2.5.2"
                                        xref="S5.E14.m1.2.2.2.5.2.cmml">B</mi><mo
                                        id="S5.E14.m1.2.2.2.5.1"
                                        xref="S5.E14.m1.2.2.2.5.1.cmml">⁢</mo><mrow
                                        id="S5.E14.m1.2.2.2.5.3.2"
                                        xref="S5.E14.m1.2.2.2.5.3.1.cmml"><mo
                                          id="S5.E14.m1.2.2.2.5.3.2.1"
                                          stretchy="false"
                                          xref="S5.E14.m1.2.2.2.5.3.1.cmml">(</mo><mi
                                          id="S5.E14.m1.1.1.1.1"
                                          xref="S5.E14.m1.1.1.1.1.cmml">𝜽</mi><mo
                                          id="S5.E14.m1.2.2.2.5.3.2.2"
                                          xref="S5.E14.m1.2.2.2.5.3.1.cmml">,</mo><mi
                                          id="S5.E14.m1.2.2.2.2"
                                          xref="S5.E14.m1.2.2.2.2.cmml">ρ</mi><mo
                                          id="S5.E14.m1.2.2.2.5.3.2.3"
                                          stretchy="false"
                                          xref="S5.E14.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mo
                                  id="S5.E14.m1.6.6.2.2a"
                                  xref="S5.E14.m1.6.6.2.3.cmml">⁡</mo><mrow
                                  id="S5.E14.m1.6.6.2.2.2"
                                  xref="S5.E14.m1.6.6.2.3.cmml"><mo
                                    id="S5.E14.m1.6.6.2.2.2.2"
                                    xref="S5.E14.m1.6.6.2.3.cmml">(</mo><mrow
                                    id="S5.E14.m1.6.6.2.2.2.1"
                                    xref="S5.E14.m1.6.6.2.2.2.1.cmml"><mrow
                                      id="S5.E14.m1.6.6.2.2.2.1.1"
                                      xref="S5.E14.m1.6.6.2.2.2.1.1.cmml"><mover
                                        accent="true"
                                        id="S5.E14.m1.6.6.2.2.2.1.1.3"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.3.cmml"><mi
                                          id="S5.E14.m1.6.6.2.2.2.1.1.3.2"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.3.2.cmml">L</mi><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.1.3.1"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.3.1.cmml">^</mo></mover><mo
                                        id="S5.E14.m1.6.6.2.2.2.1.1.2"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.2.cmml">⁢</mo><mrow
                                        id="S5.E14.m1.6.6.2.2.2.1.1.1.1"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.cmml"><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.2"
                                          stretchy="false"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.cmml">(</mo><msup
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.cmml"><mi
                                            id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.2"
                                            xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.2.cmml">𝜽</mi><mo
                                            id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.3"
                                            xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.3.cmml">′</mo></msup><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.3"
                                          stretchy="false"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                      id="S5.E14.m1.6.6.2.2.2.1.2"
                                      xref="S5.E14.m1.6.6.2.2.2.1.2.cmml">−</mo><mrow
                                      id="S5.E14.m1.6.6.2.2.2.1.3"
                                      xref="S5.E14.m1.6.6.2.2.2.1.3.cmml"><mover
                                        accent="true"
                                        id="S5.E14.m1.6.6.2.2.2.1.3.2"
                                        xref="S5.E14.m1.6.6.2.2.2.1.3.2.cmml"><mi
                                          id="S5.E14.m1.6.6.2.2.2.1.3.2.2"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.2.2.cmml">L</mi><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.3.2.1"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.2.1.cmml">^</mo></mover><mo
                                        id="S5.E14.m1.6.6.2.2.2.1.3.1"
                                        xref="S5.E14.m1.6.6.2.2.2.1.3.1.cmml">⁢</mo><mrow
                                        id="S5.E14.m1.6.6.2.2.2.1.3.3.2"
                                        xref="S5.E14.m1.6.6.2.2.2.1.3.cmml"><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.3.3.2.1"
                                          stretchy="false"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.cmml">(</mo><mi
                                          id="S5.E14.m1.4.4"
                                          xref="S5.E14.m1.4.4.cmml">𝜽</mi><mo
                                          id="S5.E14.m1.6.6.2.2.2.1.3.3.2.2"
                                          stretchy="false"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo
                                    id="S5.E14.m1.6.6.2.2.2.3"
                                    xref="S5.E14.m1.6.6.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S5.E14.m1.6b"><apply
                                id="S5.E14.m1.6.6.cmml"
                                xref="S5.E14.m1.6.6"><csymbol cd="latexml"
                                  id="S5.E14.m1.6.6.3.cmml"
                                  xref="S5.E14.m1.6.6.3">assign</csymbol><apply
                                  id="S5.E14.m1.6.6.4.cmml"
                                  xref="S5.E14.m1.6.6.4"><times
                                    id="S5.E14.m1.6.6.4.1.cmml"
                                    xref="S5.E14.m1.6.6.4.1"></times><apply
                                    id="S5.E14.m1.6.6.4.2.cmml"
                                    xref="S5.E14.m1.6.6.4.2"><csymbol
                                      cd="ambiguous"
                                      id="S5.E14.m1.6.6.4.2.1.cmml"
                                      xref="S5.E14.m1.6.6.4.2">superscript</csymbol><apply
                                      id="S5.E14.m1.6.6.4.2.2.cmml"
                                      xref="S5.E14.m1.6.6.4.2"><csymbol
                                        cd="ambiguous"
                                        id="S5.E14.m1.6.6.4.2.2.1.cmml"
                                        xref="S5.E14.m1.6.6.4.2">subscript</csymbol><ci
                                        id="S5.E14.m1.6.6.4.2.2.2.cmml"
                                        xref="S5.E14.m1.6.6.4.2.2.2">𝑅</ci><ci
                                        id="S5.E14.m1.6.6.4.2.2.3.cmml"
                                        xref="S5.E14.m1.6.6.4.2.2.3">𝜌</ci></apply><apply
                                      id="S5.E14.m1.6.6.4.2.3.cmml"
                                      xref="S5.E14.m1.6.6.4.2.3"><times
                                        id="S5.E14.m1.6.6.4.2.3.1.cmml"
                                        xref="S5.E14.m1.6.6.4.2.3.1"></times><ci
                                        id="S5.E14.m1.6.6.4.2.3.2.cmml"
                                        xref="S5.E14.m1.6.6.4.2.3.2">𝑆</ci><ci
                                        id="S5.E14.m1.6.6.4.2.3.3.cmml"
                                        xref="S5.E14.m1.6.6.4.2.3.3">𝐴</ci><ci
                                        id="S5.E14.m1.6.6.4.2.3.4.cmml"
                                        xref="S5.E14.m1.6.6.4.2.3.4">𝑀</ci></apply></apply><ci
                                    id="S5.E14.m1.3.3.cmml"
                                    xref="S5.E14.m1.3.3">𝜽</ci></apply><apply
                                  id="S5.E14.m1.6.6.2.3.cmml"
                                  xref="S5.E14.m1.6.6.2.2"><apply
                                    id="S5.E14.m1.5.5.1.1.1.cmml"
                                    xref="S5.E14.m1.5.5.1.1.1"><csymbol
                                      cd="ambiguous"
                                      id="S5.E14.m1.5.5.1.1.1.1.cmml"
                                      xref="S5.E14.m1.5.5.1.1.1">subscript</csymbol><max
                                      id="S5.E14.m1.5.5.1.1.1.2.cmml"
                                      xref="S5.E14.m1.5.5.1.1.1.2"></max><apply
                                      id="S5.E14.m1.2.2.2.cmml"
                                      xref="S5.E14.m1.2.2.2"><in
                                        id="S5.E14.m1.2.2.2.3.cmml"
                                        xref="S5.E14.m1.2.2.2.3"></in><apply
                                        id="S5.E14.m1.2.2.2.4.cmml"
                                        xref="S5.E14.m1.2.2.2.4"><csymbol
                                          cd="ambiguous"
                                          id="S5.E14.m1.2.2.2.4.1.cmml"
                                          xref="S5.E14.m1.2.2.2.4">superscript</csymbol><ci
                                          id="S5.E14.m1.2.2.2.4.2.cmml"
                                          xref="S5.E14.m1.2.2.2.4.2">𝜽</ci><ci
                                          id="S5.E14.m1.2.2.2.4.3.cmml"
                                          xref="S5.E14.m1.2.2.2.4.3">′</ci></apply><apply
                                        id="S5.E14.m1.2.2.2.5.cmml"
                                        xref="S5.E14.m1.2.2.2.5"><times
                                          id="S5.E14.m1.2.2.2.5.1.cmml"
                                          xref="S5.E14.m1.2.2.2.5.1"></times><ci
                                          id="S5.E14.m1.2.2.2.5.2.cmml"
                                          xref="S5.E14.m1.2.2.2.5.2">𝐵</ci><interval
                                          closure="open"
                                          id="S5.E14.m1.2.2.2.5.3.1.cmml"
                                          xref="S5.E14.m1.2.2.2.5.3.2"><ci
                                            id="S5.E14.m1.1.1.1.1.cmml"
                                            xref="S5.E14.m1.1.1.1.1">𝜽</ci><ci
                                            id="S5.E14.m1.2.2.2.2.cmml"
                                            xref="S5.E14.m1.2.2.2.2">𝜌</ci></interval></apply></apply></apply><apply
                                    id="S5.E14.m1.6.6.2.2.2.1.cmml"
                                    xref="S5.E14.m1.6.6.2.2.2.1"><minus
                                      id="S5.E14.m1.6.6.2.2.2.1.2.cmml"
                                      xref="S5.E14.m1.6.6.2.2.2.1.2"></minus><apply
                                      id="S5.E14.m1.6.6.2.2.2.1.1.cmml"
                                      xref="S5.E14.m1.6.6.2.2.2.1.1"><times
                                        id="S5.E14.m1.6.6.2.2.2.1.1.2.cmml"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.2"></times><apply
                                        id="S5.E14.m1.6.6.2.2.2.1.1.3.cmml"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.3"><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.1.3.1.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.3.1">^</ci><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.1.3.2.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.3.2">𝐿</ci></apply><apply
                                        id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.cmml"
                                        xref="S5.E14.m1.6.6.2.2.2.1.1.1.1"><csymbol
                                          cd="ambiguous"
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.1.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1">superscript</csymbol><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.2.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.2">𝜽</ci><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.3.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.1.1.1.1.3">′</ci></apply></apply><apply
                                      id="S5.E14.m1.6.6.2.2.2.1.3.cmml"
                                      xref="S5.E14.m1.6.6.2.2.2.1.3"><times
                                        id="S5.E14.m1.6.6.2.2.2.1.3.1.cmml"
                                        xref="S5.E14.m1.6.6.2.2.2.1.3.1"></times><apply
                                        id="S5.E14.m1.6.6.2.2.2.1.3.2.cmml"
                                        xref="S5.E14.m1.6.6.2.2.2.1.3.2"><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.3.2.1.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.2.1">^</ci><ci
                                          id="S5.E14.m1.6.6.2.2.2.1.3.2.2.cmml"
                                          xref="S5.E14.m1.6.6.2.2.2.1.3.2.2">𝐿</ci></apply><ci
                                        id="S5.E14.m1.4.4.cmml"
                                        xref="S5.E14.m1.4.4">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E14.m1.6c">R_{\rho}^{SAM}(\boldsymbol{\theta}):=\max_{\boldsymbol{\theta}^{\prime}\in
                              B(%
                              \boldsymbol{\theta},\rho)}\left(\hat{L}(\boldsymbol{\theta}^{\prime})-\hat{L}(%
                              \boldsymbol{\theta})\right)</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E14.m1.6d">italic_R start_POSTSUBSCRIPT
                              italic_ρ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
                              italic_S italic_A italic_M end_POSTSUPERSCRIPT (
                              bold_italic_θ ) := roman_max start_POSTSUBSCRIPT
                              bold_italic_θ start_POSTSUPERSCRIPT ′
                              end_POSTSUPERSCRIPT ∈ italic_B ( bold_italic_θ ,
                              italic_ρ ) end_POSTSUBSCRIPT ( over^ start_ARG
                              italic_L end_ARG ( bold_italic_θ
                              start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) -
                              over^ start_ARG italic_L end_ARG ( bold_italic_θ )
                              )</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS4.p2.3">where <math
                    alttext="\boldsymbol{\theta}" class="ltx_Math"
                    display="inline" id="S5.SS4.p2.1.m1.1"><semantics
                      id="S5.SS4.p2.1.m1.1a"><mi id="S5.SS4.p2.1.m1.1.1"
                        xref="S5.SS4.p2.1.m1.1.1.cmml">𝜽</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><ci
                          id="S5.SS4.p2.1.m1.1.1.cmml"
                          xref="S5.SS4.p2.1.m1.1.1">𝜽</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS4.p2.1.m1.1c">\boldsymbol{\theta}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS4.p2.1.m1.1d">bold_italic_θ</annotation></semantics></math>
                  is the given parameter point, <math alttext="\rho"
                    class="ltx_Math" display="inline"
                    id="S5.SS4.p2.2.m2.1"><semantics id="S5.SS4.p2.2.m2.1a"><mi
                        id="S5.SS4.p2.2.m2.1.1"
                        xref="S5.SS4.p2.2.m2.1.1.cmml">ρ</mi><annotation-xml
                        encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><ci
                          id="S5.SS4.p2.2.m2.1.1.cmml"
                          xref="S5.SS4.p2.2.m2.1.1">𝜌</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS4.p2.2.m2.1c">\rho</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS4.p2.2.m2.1d">italic_ρ</annotation></semantics></math>
                  denotes the radius of the neighborhood ball, <math
                    alttext="\hat{L}" class="ltx_Math" display="inline"
                    id="S5.SS4.p2.3.m3.1"><semantics
                      id="S5.SS4.p2.3.m3.1a"><mover accent="true"
                        id="S5.SS4.p2.3.m3.1.1"
                        xref="S5.SS4.p2.3.m3.1.1.cmml"><mi
                          id="S5.SS4.p2.3.m3.1.1.2"
                          xref="S5.SS4.p2.3.m3.1.1.2.cmml">L</mi><mo
                          id="S5.SS4.p2.3.m3.1.1.1"
                          xref="S5.SS4.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml
                        encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><apply
                          id="S5.SS4.p2.3.m3.1.1.cmml"
                          xref="S5.SS4.p2.3.m3.1.1"><ci
                            id="S5.SS4.p2.3.m3.1.1.1.cmml"
                            xref="S5.SS4.p2.3.m3.1.1.1">^</ci><ci
                            id="S5.SS4.p2.3.m3.1.1.2.cmml"
                            xref="S5.SS4.p2.3.m3.1.1.2">𝐿</ci></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS4.p2.3.m3.1c">\hat{L}</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS4.p2.3.m3.1d">over^ start_ARG italic_L
                        end_ARG</annotation></semantics></math> denotes the
                  empirical loss.
                  This metric only takes advantage of the zeroth-order
                  information, i.e. the loss value itself. Thus Zhang et al.
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib126"
                      title>126</a>]</cite> propose Gradient-Aware Minimization
                  (GAM), where a first-order flatness metric is defined as the
                  maximal gradient norm in the neighborhood.
                </p>
                <table class="ltx_equation ltx_eqn_table" id="S5.E15">
                  <tbody><tr
                      class="ltx_equation ltx_eqn_row ltx_align_baseline">
                      <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                      <td class="ltx_eqn_cell ltx_align_center"><math
                          alttext="R^{GAM}_{\rho}(\boldsymbol{\theta}):=\rho\cdot\max_{\boldsymbol{\theta}^{%
\prime}\in B(\boldsymbol{\theta},\rho)}\left\|\nabla\hat{L}(\boldsymbol{\theta%
}^{\prime})\right\|" class="ltx_Math" display="block"
                          id="S5.E15.m1.4"><semantics id="S5.E15.m1.4a"><mrow
                              id="S5.E15.m1.4.4" xref="S5.E15.m1.4.4.cmml"><mrow
                                id="S5.E15.m1.4.4.3"
                                xref="S5.E15.m1.4.4.3.cmml"><msubsup
                                  id="S5.E15.m1.4.4.3.2"
                                  xref="S5.E15.m1.4.4.3.2.cmml"><mi
                                    id="S5.E15.m1.4.4.3.2.2.2"
                                    xref="S5.E15.m1.4.4.3.2.2.2.cmml">R</mi><mi
                                    id="S5.E15.m1.4.4.3.2.3"
                                    xref="S5.E15.m1.4.4.3.2.3.cmml">ρ</mi><mrow
                                    id="S5.E15.m1.4.4.3.2.2.3"
                                    xref="S5.E15.m1.4.4.3.2.2.3.cmml"><mi
                                      id="S5.E15.m1.4.4.3.2.2.3.2"
                                      xref="S5.E15.m1.4.4.3.2.2.3.2.cmml">G</mi><mo
                                      id="S5.E15.m1.4.4.3.2.2.3.1"
                                      xref="S5.E15.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi
                                      id="S5.E15.m1.4.4.3.2.2.3.3"
                                      xref="S5.E15.m1.4.4.3.2.2.3.3.cmml">A</mi><mo
                                      id="S5.E15.m1.4.4.3.2.2.3.1a"
                                      xref="S5.E15.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi
                                      id="S5.E15.m1.4.4.3.2.2.3.4"
                                      xref="S5.E15.m1.4.4.3.2.2.3.4.cmml">M</mi></mrow></msubsup><mo
                                  id="S5.E15.m1.4.4.3.1"
                                  xref="S5.E15.m1.4.4.3.1.cmml">⁢</mo><mrow
                                  id="S5.E15.m1.4.4.3.3.2"
                                  xref="S5.E15.m1.4.4.3.cmml"><mo
                                    id="S5.E15.m1.4.4.3.3.2.1" stretchy="false"
                                    xref="S5.E15.m1.4.4.3.cmml">(</mo><mi
                                    id="S5.E15.m1.3.3"
                                    xref="S5.E15.m1.3.3.cmml">𝜽</mi><mo
                                    id="S5.E15.m1.4.4.3.3.2.2" rspace="0.278em"
                                    stretchy="false"
                                    xref="S5.E15.m1.4.4.3.cmml">)</mo></mrow></mrow><mo
                                id="S5.E15.m1.4.4.2" rspace="0.278em"
                                xref="S5.E15.m1.4.4.2.cmml">:=</mo><mrow
                                id="S5.E15.m1.4.4.1"
                                xref="S5.E15.m1.4.4.1.cmml"><mi
                                  id="S5.E15.m1.4.4.1.3"
                                  xref="S5.E15.m1.4.4.1.3.cmml">ρ</mi><mo
                                  id="S5.E15.m1.4.4.1.2" lspace="0.222em"
                                  rspace="0.222em"
                                  xref="S5.E15.m1.4.4.1.2.cmml">⋅</mo><mrow
                                  id="S5.E15.m1.4.4.1.1"
                                  xref="S5.E15.m1.4.4.1.1.cmml"><munder
                                    id="S5.E15.m1.4.4.1.1.2"
                                    xref="S5.E15.m1.4.4.1.1.2.cmml"><mi
                                      id="S5.E15.m1.4.4.1.1.2.2"
                                      xref="S5.E15.m1.4.4.1.1.2.2.cmml">max</mi><mrow
                                      id="S5.E15.m1.2.2.2"
                                      xref="S5.E15.m1.2.2.2.cmml"><msup
                                        id="S5.E15.m1.2.2.2.4"
                                        xref="S5.E15.m1.2.2.2.4.cmml"><mi
                                          id="S5.E15.m1.2.2.2.4.2"
                                          xref="S5.E15.m1.2.2.2.4.2.cmml">𝜽</mi><mo
                                          id="S5.E15.m1.2.2.2.4.3"
                                          xref="S5.E15.m1.2.2.2.4.3.cmml">′</mo></msup><mo
                                        id="S5.E15.m1.2.2.2.3"
                                        xref="S5.E15.m1.2.2.2.3.cmml">∈</mo><mrow
                                        id="S5.E15.m1.2.2.2.5"
                                        xref="S5.E15.m1.2.2.2.5.cmml"><mi
                                          id="S5.E15.m1.2.2.2.5.2"
                                          xref="S5.E15.m1.2.2.2.5.2.cmml">B</mi><mo
                                          id="S5.E15.m1.2.2.2.5.1"
                                          xref="S5.E15.m1.2.2.2.5.1.cmml">⁢</mo><mrow
                                          id="S5.E15.m1.2.2.2.5.3.2"
                                          xref="S5.E15.m1.2.2.2.5.3.1.cmml"><mo
                                            id="S5.E15.m1.2.2.2.5.3.2.1"
                                            stretchy="false"
                                            xref="S5.E15.m1.2.2.2.5.3.1.cmml">(</mo><mi
                                            id="S5.E15.m1.1.1.1.1"
                                            xref="S5.E15.m1.1.1.1.1.cmml">𝜽</mi><mo
                                            id="S5.E15.m1.2.2.2.5.3.2.2"
                                            xref="S5.E15.m1.2.2.2.5.3.1.cmml">,</mo><mi
                                            id="S5.E15.m1.2.2.2.2"
                                            xref="S5.E15.m1.2.2.2.2.cmml">ρ</mi><mo
                                            id="S5.E15.m1.2.2.2.5.3.2.3"
                                            stretchy="false"
                                            xref="S5.E15.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mo
                                    id="S5.E15.m1.4.4.1.1a"
                                    xref="S5.E15.m1.4.4.1.1.cmml">⁡</mo><mrow
                                    id="S5.E15.m1.4.4.1.1.1.1"
                                    xref="S5.E15.m1.4.4.1.1.1.2.cmml"><mo
                                      id="S5.E15.m1.4.4.1.1.1.1.2"
                                      xref="S5.E15.m1.4.4.1.1.1.2.1.cmml">‖</mo><mrow
                                      id="S5.E15.m1.4.4.1.1.1.1.1"
                                      xref="S5.E15.m1.4.4.1.1.1.1.1.cmml"><mrow
                                        id="S5.E15.m1.4.4.1.1.1.1.1.3"
                                        xref="S5.E15.m1.4.4.1.1.1.1.1.3.cmml"><mo
                                          id="S5.E15.m1.4.4.1.1.1.1.1.3.1"
                                          rspace="0.167em"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.3.1.cmml">∇</mo><mover
                                          accent="true"
                                          id="S5.E15.m1.4.4.1.1.1.1.1.3.2"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.3.2.cmml"><mi
                                            id="S5.E15.m1.4.4.1.1.1.1.1.3.2.2"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.3.2.2.cmml">L</mi><mo
                                            id="S5.E15.m1.4.4.1.1.1.1.1.3.2.1"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.3.2.1.cmml">^</mo></mover></mrow><mo
                                        id="S5.E15.m1.4.4.1.1.1.1.1.2"
                                        xref="S5.E15.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow
                                        id="S5.E15.m1.4.4.1.1.1.1.1.1.1"
                                        xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo
                                          id="S5.E15.m1.4.4.1.1.1.1.1.1.1.2"
                                          stretchy="false"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msup
                                          id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi
                                            id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.2"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo
                                            id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.3"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo
                                          id="S5.E15.m1.4.4.1.1.1.1.1.1.1.3"
                                          stretchy="false"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                                      id="S5.E15.m1.4.4.1.1.1.1.3"
                                      xref="S5.E15.m1.4.4.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><annotation-xml
                              encoding="MathML-Content" id="S5.E15.m1.4b"><apply
                                id="S5.E15.m1.4.4.cmml"
                                xref="S5.E15.m1.4.4"><csymbol cd="latexml"
                                  id="S5.E15.m1.4.4.2.cmml"
                                  xref="S5.E15.m1.4.4.2">assign</csymbol><apply
                                  id="S5.E15.m1.4.4.3.cmml"
                                  xref="S5.E15.m1.4.4.3"><times
                                    id="S5.E15.m1.4.4.3.1.cmml"
                                    xref="S5.E15.m1.4.4.3.1"></times><apply
                                    id="S5.E15.m1.4.4.3.2.cmml"
                                    xref="S5.E15.m1.4.4.3.2"><csymbol
                                      cd="ambiguous"
                                      id="S5.E15.m1.4.4.3.2.1.cmml"
                                      xref="S5.E15.m1.4.4.3.2">subscript</csymbol><apply
                                      id="S5.E15.m1.4.4.3.2.2.cmml"
                                      xref="S5.E15.m1.4.4.3.2"><csymbol
                                        cd="ambiguous"
                                        id="S5.E15.m1.4.4.3.2.2.1.cmml"
                                        xref="S5.E15.m1.4.4.3.2">superscript</csymbol><ci
                                        id="S5.E15.m1.4.4.3.2.2.2.cmml"
                                        xref="S5.E15.m1.4.4.3.2.2.2">𝑅</ci><apply
                                        id="S5.E15.m1.4.4.3.2.2.3.cmml"
                                        xref="S5.E15.m1.4.4.3.2.2.3"><times
                                          id="S5.E15.m1.4.4.3.2.2.3.1.cmml"
                                          xref="S5.E15.m1.4.4.3.2.2.3.1"></times><ci
                                          id="S5.E15.m1.4.4.3.2.2.3.2.cmml"
                                          xref="S5.E15.m1.4.4.3.2.2.3.2">𝐺</ci><ci
                                          id="S5.E15.m1.4.4.3.2.2.3.3.cmml"
                                          xref="S5.E15.m1.4.4.3.2.2.3.3">𝐴</ci><ci
                                          id="S5.E15.m1.4.4.3.2.2.3.4.cmml"
                                          xref="S5.E15.m1.4.4.3.2.2.3.4">𝑀</ci></apply></apply><ci
                                      id="S5.E15.m1.4.4.3.2.3.cmml"
                                      xref="S5.E15.m1.4.4.3.2.3">𝜌</ci></apply><ci
                                    id="S5.E15.m1.3.3.cmml"
                                    xref="S5.E15.m1.3.3">𝜽</ci></apply><apply
                                  id="S5.E15.m1.4.4.1.cmml"
                                  xref="S5.E15.m1.4.4.1"><ci
                                    id="S5.E15.m1.4.4.1.2.cmml"
                                    xref="S5.E15.m1.4.4.1.2">⋅</ci><ci
                                    id="S5.E15.m1.4.4.1.3.cmml"
                                    xref="S5.E15.m1.4.4.1.3">𝜌</ci><apply
                                    id="S5.E15.m1.4.4.1.1.cmml"
                                    xref="S5.E15.m1.4.4.1.1"><apply
                                      id="S5.E15.m1.4.4.1.1.2.cmml"
                                      xref="S5.E15.m1.4.4.1.1.2"><csymbol
                                        cd="ambiguous"
                                        id="S5.E15.m1.4.4.1.1.2.1.cmml"
                                        xref="S5.E15.m1.4.4.1.1.2">subscript</csymbol><max
                                        id="S5.E15.m1.4.4.1.1.2.2.cmml"
                                        xref="S5.E15.m1.4.4.1.1.2.2"></max><apply
                                        id="S5.E15.m1.2.2.2.cmml"
                                        xref="S5.E15.m1.2.2.2"><in
                                          id="S5.E15.m1.2.2.2.3.cmml"
                                          xref="S5.E15.m1.2.2.2.3"></in><apply
                                          id="S5.E15.m1.2.2.2.4.cmml"
                                          xref="S5.E15.m1.2.2.2.4"><csymbol
                                            cd="ambiguous"
                                            id="S5.E15.m1.2.2.2.4.1.cmml"
                                            xref="S5.E15.m1.2.2.2.4">superscript</csymbol><ci
                                            id="S5.E15.m1.2.2.2.4.2.cmml"
                                            xref="S5.E15.m1.2.2.2.4.2">𝜽</ci><ci
                                            id="S5.E15.m1.2.2.2.4.3.cmml"
                                            xref="S5.E15.m1.2.2.2.4.3">′</ci></apply><apply
                                          id="S5.E15.m1.2.2.2.5.cmml"
                                          xref="S5.E15.m1.2.2.2.5"><times
                                            id="S5.E15.m1.2.2.2.5.1.cmml"
                                            xref="S5.E15.m1.2.2.2.5.1"></times><ci
                                            id="S5.E15.m1.2.2.2.5.2.cmml"
                                            xref="S5.E15.m1.2.2.2.5.2">𝐵</ci><interval
                                            closure="open"
                                            id="S5.E15.m1.2.2.2.5.3.1.cmml"
                                            xref="S5.E15.m1.2.2.2.5.3.2"><ci
                                              id="S5.E15.m1.1.1.1.1.cmml"
                                              xref="S5.E15.m1.1.1.1.1">𝜽</ci><ci
                                              id="S5.E15.m1.2.2.2.2.cmml"
                                              xref="S5.E15.m1.2.2.2.2">𝜌</ci></interval></apply></apply></apply><apply
                                      id="S5.E15.m1.4.4.1.1.1.2.cmml"
                                      xref="S5.E15.m1.4.4.1.1.1.1"><csymbol
                                        cd="latexml"
                                        id="S5.E15.m1.4.4.1.1.1.2.1.cmml"
                                        xref="S5.E15.m1.4.4.1.1.1.1.2">norm</csymbol><apply
                                        id="S5.E15.m1.4.4.1.1.1.1.1.cmml"
                                        xref="S5.E15.m1.4.4.1.1.1.1.1"><times
                                          id="S5.E15.m1.4.4.1.1.1.1.1.2.cmml"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.2"></times><apply
                                          id="S5.E15.m1.4.4.1.1.1.1.1.3.cmml"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.3"><ci
                                            id="S5.E15.m1.4.4.1.1.1.1.1.3.1.cmml"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.3.1">∇</ci><apply
                                            id="S5.E15.m1.4.4.1.1.1.1.1.3.2.cmml"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.3.2"><ci
                                              id="S5.E15.m1.4.4.1.1.1.1.1.3.2.1.cmml"
                                              xref="S5.E15.m1.4.4.1.1.1.1.1.3.2.1">^</ci><ci
                                              id="S5.E15.m1.4.4.1.1.1.1.1.3.2.2.cmml"
                                              xref="S5.E15.m1.4.4.1.1.1.1.1.3.2.2">𝐿</ci></apply></apply><apply
                                          id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.cmml"
                                          xref="S5.E15.m1.4.4.1.1.1.1.1.1.1"><csymbol
                                            cd="ambiguous"
                                            id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci
                                            id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.2">𝜽</ci><ci
                                            id="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"
                                            xref="S5.E15.m1.4.4.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation
                              encoding="application/x-tex"
                              id="S5.E15.m1.4c">R^{GAM}_{\rho}(\boldsymbol{\theta}):=\rho\cdot\max_{\boldsymbol{\theta}^{%
                              \prime}\in
                              B(\boldsymbol{\theta},\rho)}\left\|\nabla\hat{L}(\boldsymbol{\theta%
                              }^{\prime})\right\|</annotation><annotation
                              encoding="application/x-llamapun"
                              id="S5.E15.m1.4d">italic_R start_POSTSUPERSCRIPT
                              italic_G italic_A italic_M end_POSTSUPERSCRIPT
                              start_POSTSUBSCRIPT italic_ρ end_POSTSUBSCRIPT (
                              bold_italic_θ ) := italic_ρ ⋅ roman_max
                              start_POSTSUBSCRIPT bold_italic_θ
                              start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈
                              italic_B ( bold_italic_θ , italic_ρ )
                              end_POSTSUBSCRIPT ∥ ∇ over^ start_ARG italic_L
                              end_ARG ( bold_italic_θ start_POSTSUPERSCRIPT ′
                              end_POSTSUPERSCRIPT )
                              ∥</annotation></semantics></math></td>
                      <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                      <td
                        class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                        rowspan="1"><span
                          class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
                    </tr></tbody>
                </table>
                <p class="ltx_p" id="S5.SS4.p2.4">Compared with the metric of
                  SAM, this GAM metric takes a step further by utilizing the
                  first-order information of the loss gradient. Other metrics
                  are also employed to describe flatness, like the maximal
                  eigenvalue of the Hessian matrix <math
                    alttext="\lambda_{{\rm max}}(\nabla^{2}\hat{L}(\boldsymbol{\theta}^{*}))"
                    class="ltx_Math" display="inline"
                    id="S5.SS4.p2.4.m1.1"><semantics
                      id="S5.SS4.p2.4.m1.1a"><mrow id="S5.SS4.p2.4.m1.1.1"
                        xref="S5.SS4.p2.4.m1.1.1.cmml"><msub
                          id="S5.SS4.p2.4.m1.1.1.3"
                          xref="S5.SS4.p2.4.m1.1.1.3.cmml"><mi
                            id="S5.SS4.p2.4.m1.1.1.3.2"
                            xref="S5.SS4.p2.4.m1.1.1.3.2.cmml">λ</mi><mi
                            id="S5.SS4.p2.4.m1.1.1.3.3"
                            xref="S5.SS4.p2.4.m1.1.1.3.3.cmml">max</mi></msub><mo
                          id="S5.SS4.p2.4.m1.1.1.2"
                          xref="S5.SS4.p2.4.m1.1.1.2.cmml">⁢</mo><mrow
                          id="S5.SS4.p2.4.m1.1.1.1.1"
                          xref="S5.SS4.p2.4.m1.1.1.1.1.1.cmml"><mo
                            id="S5.SS4.p2.4.m1.1.1.1.1.2" stretchy="false"
                            xref="S5.SS4.p2.4.m1.1.1.1.1.1.cmml">(</mo><mrow
                            id="S5.SS4.p2.4.m1.1.1.1.1.1"
                            xref="S5.SS4.p2.4.m1.1.1.1.1.1.cmml"><mrow
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.3"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.cmml"><msup
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.cmml"><mo
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.2"
                                  rspace="0.167em"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.2.cmml">∇</mo><mn
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.3"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.3.cmml">2</mn></msup><mover
                                accent="true" id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.cmml"><mi
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.2"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.2.cmml">L</mi><mo
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.1"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover></mrow><mo
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.2"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.cmml"><mo
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.2"
                                stretchy="false"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.cmml"><mi
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.2"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.3"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.3.cmml">*</mo></msup><mo
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.3"
                                stretchy="false"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo
                            id="S5.SS4.p2.4.m1.1.1.1.1.3" stretchy="false"
                            xref="S5.SS4.p2.4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml
                        encoding="MathML-Content" id="S5.SS4.p2.4.m1.1b"><apply
                          id="S5.SS4.p2.4.m1.1.1.cmml"
                          xref="S5.SS4.p2.4.m1.1.1"><times
                            id="S5.SS4.p2.4.m1.1.1.2.cmml"
                            xref="S5.SS4.p2.4.m1.1.1.2"></times><apply
                            id="S5.SS4.p2.4.m1.1.1.3.cmml"
                            xref="S5.SS4.p2.4.m1.1.1.3"><csymbol cd="ambiguous"
                              id="S5.SS4.p2.4.m1.1.1.3.1.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.3">subscript</csymbol><ci
                              id="S5.SS4.p2.4.m1.1.1.3.2.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.3.2">𝜆</ci><ci
                              id="S5.SS4.p2.4.m1.1.1.3.3.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.3.3">max</ci></apply><apply
                            id="S5.SS4.p2.4.m1.1.1.1.1.1.cmml"
                            xref="S5.SS4.p2.4.m1.1.1.1.1"><times
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.2.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.2"></times><apply
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.3.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.3"><apply
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.cmml"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1"><csymbol
                                  cd="ambiguous"
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.1.cmml"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1">superscript</csymbol><ci
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.2.cmml"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.2">∇</ci><cn
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.3.cmml"
                                  type="integer"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.1.3">2</cn></apply><apply
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.cmml"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2"><ci
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.1.cmml"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.1">^</ci><ci
                                  id="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.2.cmml"
                                  xref="S5.SS4.p2.4.m1.1.1.1.1.1.3.2.2">𝐿</ci></apply></apply><apply
                              id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.cmml"
                              xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1"><csymbol
                                cd="ambiguous"
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.1.cmml"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1">superscript</csymbol><ci
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.2.cmml"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.2">𝜽</ci><times
                                id="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.3.cmml"
                                xref="S5.SS4.p2.4.m1.1.1.1.1.1.1.1.1.3"></times></apply></apply></apply></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="S5.SS4.p2.4.m1.1c">\lambda_{{\rm
                        max}}(\nabla^{2}\hat{L}(\boldsymbol{\theta}^{*}))</annotation><annotation
                        encoding="application/x-llamapun"
                        id="S5.SS4.p2.4.m1.1d">italic_λ start_POSTSUBSCRIPT
                        roman_max end_POSTSUBSCRIPT ( ∇ start_POSTSUPERSCRIPT 2
                        end_POSTSUPERSCRIPT over^ start_ARG italic_L end_ARG (
                        bold_italic_θ start_POSTSUPERSCRIPT *
                        end_POSTSUPERSCRIPT ) )</annotation></semantics></math>
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib127"
                      title>127</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib128"
                      title>128</a>]</cite>.
                  An extension of GAM is demonstrated to improve the ability of
                  domain generalization <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib48"
                      title>48</a>]</cite>, revealing the potential of seeking
                  flatness for OOD generalization.
                  In the future, despite more complex flatness metrics, like
                  metrics with a higher order, being hard to optimize, they can
                  be designed for OOD evaluation, e.g. model selection.</p>
              </div>
              <div class="ltx_para" id="S5.SS4.p3">
                <p class="ltx_p" id="S5.SS4.p3.1">The other branch of works
                  seeks flatness via an ensemble of network parameters.
                  Stochastic Weight Averaging (SWA) <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib125"
                      title>125</a>]</cite> averages the parameters every epoch
                  or certain number of iterations after warming up. Authors
                  empirically illustrate that such an averaging strategy leads
                  to wider optima and stronger generalization.
                  Based on this finding, Cha et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib129"
                      title>129</a>]</cite> modify this strategy for DG tasks.
                  They preserve the moving average of parameters across every
                  iteration from the start of overfitting to the end of
                  training. They also evaluate the flatness of trained models
                  via the metric defined by SAM <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib50"
                      title>50</a>]</cite> and confirm the effectiveness of SWAD
                  in improving flatness.
                  Another DG method also employs moving average of network
                  parameters <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib130"
                      title>130</a>]</cite>. They demonstrate that the
                  validation performance of moving averaged models is better and
                  more stably correlated with OOD test performance than that of
                  a single model. This indicates the averaged model’s validation
                  performance can be used for model selection.
                  Recently many efforts have been put into designing ensemble
                  strategies for DG in addition to averaging model parameters
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib131"
                      title>131</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib132"
                      title>132</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib133"
                      title>133</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib134"
                      title>134</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib135"
                      title>135</a>]</cite>.</p>
              </div>
              <div class="ltx_para" id="S5.SS4.p4">
                <p class="ltx_p" id="S5.SS4.p4.1">Despite more and more works
                  focusing on this area, the relationship between flatness and
                  OOD generalization abilities is not totally clear yet. For
                  example, researchers find that in DG tasks, SAM does not
                  outperform SWAD and even degrades the performance when
                  combined with SWAD, although SAM is designed for achieving
                  flatness more directly than SWAD <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib129"
                      title>129</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib134"
                      title>134</a>]</cite>. Rame et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib134"
                      title>134</a>]</cite> point out the theoretical flaws of
                  the relationship between flatness and OOD generalization error
                  in SWAD, and provide a new analysis for model parameter
                  averaging and OOD generalization error. Andriushchenko et al.
                  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib136"
                      title>136</a>]</cite> even discover a negative correlation
                  between flatness and OOD generalization, contrary to our
                  previous knowledge.</p>
              </div>
            </section>
            <section class="ltx_subsection" id="S5.SS5">
              <h3 class="ltx_title ltx_title_subsection">
                <span class="ltx_tag ltx_tag_subsection">5.5 </span><span
                  class="ltx_text ltx_font_italic"
                  id="S5.SS5.1.1">Discussion</span>
              </h3>
              <div class="ltx_para" id="S5.SS5.p1">
                <p class="ltx_p" id="S5.SS5.p1.1">While we have explored the
                  intrinsic properties from four distinct perspectives, they are
                  intimately interconnected.
                  Distributional robustness is intricately linked to the notion
                  of stability, where the objectives and constraints swap roles.
                  The former quantifies the worst sub-population performance
                  under predefined distribution perturbations, while the latter
                  is characterized by the minimal perturbations necessary to
                  compromise model performance.
                  Originating from the causal inference literature, invariance
                  can be perceived as a milder form of causality.
                  As highlighted in Meinshausen et al. <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib137"
                      title>137</a>]</cite>, it represents a specific form of
                  distributional robustness.
                  While the invariance property concentrates on model
                  performance across varying environments, flatness is more
                  attuned to the immediate vicinity, underscoring the model’s
                  local characteristics.</p>
              </div>
              <div class="ltx_para" id="S5.SS5.p2">
                <p class="ltx_p" id="S5.SS5.p2.1">In general, these properties,
                  though analyzed from different lenses, collectively form the
                  bedrock of understanding models’ resilience, adaptability, and
                  reliability. Their intertwined nature underscores the
                  necessity of a comprehensive approach to grasp the full
                  spectrum of model behavior in diverse scenarios.</p>
              </div>
            </section>
          </section>
          <section class="ltx_section" id="S6">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">6 </span><span
                class="ltx_text ltx_font_smallcaps" id="S6.1.1">Discussion on
                pretrained models</span>
            </h2>
            <div class="ltx_para" id="S6.p1">
              <p class="ltx_p" id="S6.p1.1">Recently, pretrained models,
                especially Large Language Models (LLMs) <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib138"
                    title>138</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib139"
                    title>139</a>]</cite>, have achieved brilliant performance
                across a wide spectrum of tasks and garnered worldwide
                attention.
                However, results in the newly established OOD benchmark GLUE-X
                <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib81"
                    title>81</a>]</cite> show that even equipped with strong
                pretrained weights, models still fall far behind human-level
                performance in OOD generalization tasks. They also show that
                GPT-3.5, while surpassing GPT-3 by a large margin in standard
                NLP tasks, exhibits only marginal superiority in OOD tasks of
                GLUE-X.
                Moreover, GPT-3.5 even fails to outperform ELECTRA-large, a
                smaller pretrained model. A similar phenomenon is observed in
                another latest OOD benchmark BOSS <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                    title>82</a>]</cite> that GPT-3.5 cannot always outperform
                smaller models. Besides, issues related to bias and fairness,
                which are closely related to OOD generalization, are still
                ubiquitous for LLM <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib34"
                    title>34</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib140"
                    title>140</a>]</cite>.
                These results collectively underscore that the mere expansion of
                model parameters and training data, without concurrent
                development of OOD strategies, falls short of completely solving
                the OOD generalization problem.</p>
            </div>
            <div class="ltx_para" id="S6.p2">
              <p class="ltx_p" id="S6.p2.1">However, as pretrained models
                continue to advance, their wide-spread and irreplaceable
                integration into various tasks naturally provokes a fundamental
                question concerning evaluating OOD generalization abilities: How
                should we define the distribution shift given a strong
                pretrained model that contains abundant information from its
                pretraining data?
                Indeed, it is possible that portions of the test data may have
                been encountered during the pretraining phase, or that the test
                distribution of input data closely aligns with that of the
                pretraining data.
                In such a case, models’ performance drop on test data may not
                accurately reflect the distribution shift between test and
                training data, but rather the shift between test data and the
                combination of training and pretraining data.
                Previous works <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib141"
                    title>141</a>, <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib36"
                    title>36</a>]</cite> have shown that simple linear-probing
                can outperform fine-tuning the whole network, even surpassing
                some domain generalization algorithms across a number of OOD
                generalization tasks. This implies that the better utilization
                of pretrained weights plays a leading role in enhancing the
                evaluated performance, instead of bolstering the OOD
                generalization ability from training data to test data.</p>
            </div>
            <div class="ltx_para" id="S6.p3">
              <p class="ltx_p" id="S6.p3.1">At present, it remains a fundamental
                open problem that how we should design a more reasonable
                evaluation procedure in the presence of strong pretrained
                models.
                Yu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a
                    class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib36"
                    title>36</a>]</cite> modify the DomainBed protocol <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib18"
                    title>18</a>]</cite> by removing the pretrained weights and
                training all models from scratch when evaluating OOD
                generalization algorithms. This serves as a pure and accurate
                evaluation protocol, but increases the evaluation burdens due to
                training large models from scratch.
                Another dataset ObjectNet <cite
                  class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#bib.bib69"
                    title>69</a>]</cite>, though not specially designed for OOD
                generalization, collects the data by taking new photos with
                various attributes including rotation, viewpoint, and
                background. In this way, they ensure that the constructed
                dataset has not appeared in any model’s training data before.
                ImageNet-pretrained models suffer a huge performance drop on
                ObjectNet, confirming its success of preventing data leakage.
                However, datasets with images similar to ObjectNet may arise,
                and images in ObjectNet may be crawled and collected into newer
                datasets used for pretraining in the future, so the problem
                still exists by that time.</p>
            </div>
          </section>
          <section class="ltx_section" id="S7">
            <h2 class="ltx_title ltx_title_section">
              <span class="ltx_tag ltx_tag_section">7 </span><span
                class="ltx_text ltx_font_smallcaps" id="S7.1.1">Conclusion and
                Future Directions</span>
            </h2>
            <div class="ltx_para" id="S7.p1">
              <p class="ltx_p" id="S7.p1.1">A scientific and reasonable paradigm
                of OOD evaluation, i.e. the evaluation of Out-of-Distribution
                Generalization, is of paramount significance not only to
                promoting the development of new OOD generalization algorithms,
                but also to the more practical and flexible application of
                existing models. In this paper, we undertake a systematic review
                of the problem setting, three primary categories of OOD
                evaluation methods, and briefly discuss in the context of
                pretrained models.
                Although we have discussed drawbacks and future directions for
                each specific category of OOD evaluation, here we enumerate
                several valuable potential future directions that are more
                general but somewhat absent in the current literature, based on
                our perception and reflection of OOD evaluation at present.</p>
            </div>
            <section class="ltx_paragraph" id="S7.SS0.SSS0.Px1">
              <h5
                class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">OOD
                evaluation beyond performance</h5>
              <div class="ltx_para" id="S7.SS0.SSS0.Px1.p1">
                <p class="ltx_p" id="S7.SS0.SSS0.Px1.p1.1">Most existing OOD
                  evaluation paradigms predominantly center around the
                  performance of models. They aim to evaluate whether their OOD
                  performance is good enough or not, or make comparisons among
                  models. Nonetheless, as stated in Section <a class="ltx_ref"
                    href="https://arxiv.org/html/2403.01874v1#S1"
                    title="1 Introduction ‣ A Survey on Evaluation of Out-of-Distribution Generalization"><span
                      class="ltx_text ltx_ref_tag">1</span></a>, the objective
                  of OOD evaluation is more than ”whether”, but also ”where”.
                  Since the ultimate solution of OOD generalization is hard to
                  find considering various kinds of distribution shifts, it is
                  more practical in the deployment of machine learning models to
                  identify the safe or risky regions for a specific model and to
                  certify the kind of distribution shift that an algorithm can
                  effectively address. A few works mentioned above <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib118"
                      title>118</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib95"
                      title>95</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib96"
                      title>96</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib32"
                      title>32</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib33"
                      title>33</a>]</cite> serve as primitive efforts towards
                  this objective. It is worth noting that they are all
                  relatively new works, suggesting that there may be an ongoing
                  trend towards the evaluation beyond performance.</p>
              </div>
            </section>
            <section class="ltx_paragraph" id="S7.SS0.SSS0.Px2">
              <h5
                class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">OOD
                evaluation of training data</h5>
              <div class="ltx_para" id="S7.SS0.SSS0.Px2.p1">
                <p class="ltx_p" id="S7.SS0.SSS0.Px2.p1.1">While fully-trained
                  models are a composite result of model structures, algorithms,
                  and training data, current OOD evaluation paradigms mostly
                  evaluate models across different model structures or different
                  algorithms, but seldom across different kinds of training
                  data, and they seldom analyze the properties of training data
                  that is beneficial to OOD generalization.
                  In an era when people pay attention to developing new model
                  structures and new algorithms, training data is easy to
                  ignore, despite its pivotal impact on model performance <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib142"
                      title>142</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib143"
                      title>143</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib144"
                      title>144</a>]</cite>. Only a limited number of studies
                  delve into this issue from the perspective of training data
                  heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a
                      class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib122"
                      title>122</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib145"
                      title>145</a>]</cite>.</p>
              </div>
            </section>
            <section class="ltx_paragraph" id="S7.SS0.SSS0.Px3">
              <h5
                class="ltx_title ltx_runin ltx_font_bold ltx_title_paragraph">Distinguishing
                performance of OOD generalization from ID generalization</h5>
              <div class="ltx_para" id="S7.SS0.SSS0.Px3.p1">
                <p class="ltx_p" id="S7.SS0.SSS0.Px3.p1.1">Existing OOD
                  evaluation methods rely on direct comparisons of absolute
                  performance. However, we raise concerns about whether these
                  comparisons accurately gauge the authentic OOD generalization
                  capability of models. There is a chance that the performance
                  gain is attributed to the improvement of ID generalization
                  ability, instead of OOD generalization ability.
                  For example, with sufficient training on the same dataset, a
                  larger network tends to achieve a higher performance on both
                  ID and OOD test data. The performance gap between ID and OOD,
                  though not necessarily the proper evaluation metric, may
                  remain the same or even get larger.
                  Of course, increasing the size of training data and the model
                  capacity usually helps increase ID performance, thus
                  increasing OOD performance, but it does not mean this is the
                  answer to solving the OOD generalization problem, considering
                  that large models also suffer from severe performance
                  degradation encountering distribution shifts <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib81"
                      title>81</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                      title>82</a>]</cite>, as well as the related issues of
                  bias and fairness <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib34"
                      title>34</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib140"
                      title>140</a>]</cite>.
                  Therefore, for the ultimate solution of OOD generalization, we
                  suggest that we should distinguish the OOD performance from ID
                  performance when evaluating the OOD generalization ability of
                  models. Simply using the performance gap might not be suitable
                  since strong regularization tricks like using a large weight
                  decay may decrease the ID performance to reduce the
                  performance gap. There are already several works discussing
                  the relationship between OOD and ID performance <cite
                    class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib146"
                      title>146</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib147"
                      title>147</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib111"
                      title>111</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib148"
                      title>148</a>, <a class="ltx_ref"
                      href="https://arxiv.org/html/2403.01874v1#bib.bib82"
                      title>82</a>]</cite> while deeper investigations
                  concerning this aspect are expected.</p>
              </div>
            </section>
          </section>
          <section class="ltx_bibliography" id="bib">
            <h2 class="ltx_title ltx_title_bibliography">References</h2>
            <ul class="ltx_biblist">
              <li class="ltx_bibitem" id="bib.bib1">
                <span class="ltx_tag ltx_tag_bibitem">[1]</span>
                <span class="ltx_bibblock">
                  K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning
                  for image recognition,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib1.1.1">Proceedings of the IEEE conference on
                    computer vision and pattern recognition</em>, 2016, pp.
                  770–778.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib2">
                <span class="ltx_tag ltx_tag_bibitem">[2]</span>
                <span class="ltx_bibblock">
                  J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert:
                  Pre-training of deep bidirectional transformers for language
                  understanding,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib2.1.1">arXiv preprint arXiv:1810.04805</em>,
                  2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib3">
                <span class="ltx_tag ltx_tag_bibitem">[3]</span>
                <span class="ltx_bibblock">
                  X. He, L. Liao, H. Zhang, L. Nie, X. Hu, and T.-S. Chua,
                  “Neural collaborative filtering,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib3.1.1">Proceedings of the 26th international
                    conference on world wide web</em>, 2017, pp. 173–182.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib4">
                <span class="ltx_tag ltx_tag_bibitem">[4]</span>
                <span class="ltx_bibblock">
                  R. Shokri and V. Shmatikov, “Privacy-preserving deep
                  learning,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib4.1.1">Proceedings of the 22nd ACM SIGSAC
                    conference on computer and communications security</em>,
                  2015, pp. 1310–1321.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib5">
                <span class="ltx_tag ltx_tag_bibitem">[5]</span>
                <span class="ltx_bibblock">
                  Q.-s. Zhang and S.-C. Zhu, “Visual interpretability for deep
                  learning: a survey,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib5.1.1">Frontiers of Information Technology &amp;
                    Electronic Engineering</em>, vol. 19, no. 1, pp. 27–39,
                  2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib6">
                <span class="ltx_tag ltx_tag_bibitem">[6]</span>
                <span class="ltx_bibblock">
                  N. Akhtar and A. Mian, “Threat of adversarial attacks on deep
                  learning in computer vision: A survey,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Ieee
                    Access</em>, vol. 6, pp. 14 410–14 430, 2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib7">
                <span class="ltx_tag ltx_tag_bibitem">[7]</span>
                <span class="ltx_bibblock">
                  J. Liu, Z. Shen, Y. He, X. Zhang, R. Xu, H. Yu, and P. Cui,
                  “Towards out-of-distribution generalization: A survey,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv
                    preprint arXiv:2108.13624</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib8">
                <span class="ltx_tag ltx_tag_bibitem">[8]</span>
                <span class="ltx_bibblock">
                  R. Berk, H. Heidari, S. Jabbari, M. Kearns, and A. Roth,
                  “Fairness in criminal justice risk assessments: The state of
                  the art,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib8.1.1">Sociological Methods &amp; Research</em>,
                  vol. 50, no. 1, pp. 3–44, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib9">
                <span class="ltx_tag ltx_tag_bibitem">[9]</span>
                <span class="ltx_bibblock">
                  M. Kukar, “Transductive reliability estimation for medical
                  diagnosis,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib9.1.1">Artificial Intelligence in Medicine</em>,
                  vol. 29, no. 1-2, pp. 81–106, 2003.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib10">
                <span class="ltx_tag ltx_tag_bibitem">[10]</span>
                <span class="ltx_bibblock">
                  B. Huval, T. Wang, S. Tandon, J. Kiske, W. Song, J.
                  Pazhayampallil, M. Andriluka, P. Rajpurkar, T. Migimatsu, R.
                  Cheng-Yue <em class="ltx_emph ltx_font_italic"
                    id="bib.bib10.1.1">et al.</em>, “An empirical evaluation of
                  deep learning on highway driving,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib10.2.2">arXiv
                    preprint arXiv:1504.01716</em>, 2015.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib11">
                <span class="ltx_tag ltx_tag_bibitem">[11]</span>
                <span class="ltx_bibblock">
                  D. Li, Y. Yang, Y.-Z. Song, and T. M. Hospedales, “Deeper,
                  broader and artier domain generalization,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib11.1.1">ICCV</em>, 2017, pp. 5542–5550.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib12">
                <span class="ltx_tag ltx_tag_bibitem">[12]</span>
                <span class="ltx_bibblock">
                  F. Ding, M. Hardt, J. Miller, and L. Schmidt, “Retiring adult:
                  New datasets for fair machine learning,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances
                    in neural information processing systems</em>, vol. 34, pp.
                  6478–6490, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib13">
                <span class="ltx_tag ltx_tag_bibitem">[13]</span>
                <span class="ltx_bibblock">
                  S. Ben-David, J. Blitzer, K. Crammer, A. Kulesza, F. Pereira,
                  and J. W. Vaughan, “A theory of learning from different
                  domains,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib13.1.1">Machine learning</em>, vol. 79, no. 1-2,
                  pp. 151–175, 2010.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib14">
                <span class="ltx_tag ltx_tag_bibitem">[14]</span>
                <span class="ltx_bibblock">
                  M. Long, Y. Cao, J. Wang, and M. Jordan, “Learning
                  transferable features with deep adaptation networks,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib14.1.1">International conference on machine
                    learning</em>. PMLR, 2015, pp. 97–105.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib15">
                <span class="ltx_tag ltx_tag_bibitem">[15]</span>
                <span class="ltx_bibblock">
                  M. Long, H. Zhu, J. Wang, and M. I. Jordan, “Deep transfer
                  learning with joint adaptation networks,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib15.1.1">International conference on machine
                    learning</em>. PMLR, 2017, pp. 2208–2217.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib16">
                <span class="ltx_tag ltx_tag_bibitem">[16]</span>
                <span class="ltx_bibblock">
                  J. Wang, C. Lan, C. Liu, Y. Ouyang, T. Qin, W. Lu, Y. Chen, W.
                  Zeng, and P. Yu, “Generalizing to unseen domains: A survey on
                  domain generalization,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib16.1.1">IEEE Transactions on Knowledge and Data
                    Engineering</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib17">
                <span class="ltx_tag ltx_tag_bibitem">[17]</span>
                <span class="ltx_bibblock">
                  K. Zhou, Z. Liu, Y. Qiao, T. Xiang, and C. C. Loy, “Domain
                  generalization: A survey,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">IEEE
                    Transactions on Pattern Analysis and Machine
                    Intelligence</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib18">
                <span class="ltx_tag ltx_tag_bibitem">[18]</span>
                <span class="ltx_bibblock">
                  I. Gulrajani and D. Lopez-Paz, “In search of lost domain
                  generalization,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib18.1.1">International Conference on Learning
                    Representations</em>, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib19">
                <span class="ltx_tag ltx_tag_bibitem">[19]</span>
                <span class="ltx_bibblock">
                  H. Namkoong and J. C. Duchi, “Stochastic gradient methods for
                  distributionally robust optimization with f-divergences,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances
                    in neural information processing systems</em>, vol. 29,
                  2016.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib20">
                <span class="ltx_tag ltx_tag_bibitem">[20]</span>
                <span class="ltx_bibblock">
                  A. Sinha, H. Namkoong, and J. Duchi, “Certifying some
                  distributional robustness with principled adversarial
                  training,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib20.1.1">International Conference on Learning
                    Representations</em>, 2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib21">
                <span class="ltx_tag ltx_tag_bibitem">[21]</span>
                <span class="ltx_bibblock">
                  J. C. Duchi and H. Namkoong, “Learning models with uniform
                  performance via distributionally robust optimization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">The
                    Annals of Statistics</em>, vol. 49, no. 3, pp. 1378–1406,
                  2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib22">
                <span class="ltx_tag ltx_tag_bibitem">[22]</span>
                <span class="ltx_bibblock">
                  M. Arjovsky, L. Bottou, I. Gulrajani, and D. Lopez-Paz,
                  “Invariant risk minimization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv
                    preprint arXiv:1907.02893</em>, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib23">
                <span class="ltx_tag ltx_tag_bibitem">[23]</span>
                <span class="ltx_bibblock">
                  J. Liu, Z. Hu, P. Cui, B. Li, and Z. Shen, “Heterogeneous risk
                  minimization,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib23.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2021, pp. 6804–6814.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib24">
                <span class="ltx_tag ltx_tag_bibitem">[24]</span>
                <span class="ltx_bibblock">
                  ——, “Kernelized heterogeneous risk minimization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv
                    preprint arXiv:2110.12425</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib25">
                <span class="ltx_tag ltx_tag_bibitem">[25]</span>
                <span class="ltx_bibblock">
                  Z. Shen, P. Cui, T. Zhang, and K. Kunag, “Stable learning via
                  sample reweighting,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib25.1.1">Proceedings of the AAAI Conference on
                    Artificial Intelligence</em>, vol. 34, no. 04, 2020, pp.
                  5692–5699.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib26">
                <span class="ltx_tag ltx_tag_bibitem">[26]</span>
                <span class="ltx_bibblock">
                  K. Kuang, R. Xiong, P. Cui, S. Athey, and B. Li, “Stable
                  prediction with model misspecification and agnostic
                  distribution shift,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib26.1.1">Proceedings of the AAAI Conference on
                    Artificial Intelligence</em>, vol. 34, no. 04, 2020, pp.
                  4485–4492.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib27">
                <span class="ltx_tag ltx_tag_bibitem">[27]</span>
                <span class="ltx_bibblock">
                  H. Yu, P. Cui, Y. He, Z. Shen, Y. Lin, R. Xu, and X. Zhang,
                  “Stable learning via sparse variable independence,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib27.1.1">Proceedings of the AAAI Conference on
                    Artificial Intelligence</em>, vol. 37, no. 9, 2023, pp. 10
                  998–11 006.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib28">
                <span class="ltx_tag ltx_tag_bibitem">[28]</span>
                <span class="ltx_bibblock">
                  J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei,
                  “Imagenet: A large-scale hierarchical image database,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib28.1.1">CVPR</em>. Ieee, 2009, pp. 248–255.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib29">
                <span class="ltx_tag ltx_tag_bibitem">[29]</span>
                <span class="ltx_bibblock">
                  X. Zhang, Y. He, R. Xu, H. Yu, Z. Shen, and P. Cui, “Nico++:
                  Towards better benchmarking for domain generalization,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib29.1.1">Proceedings of the IEEE/CVF Conference on
                    Computer Vision and Pattern Recognition</em>, 2023, pp. 16
                  036–16 047.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib30">
                <span class="ltx_tag ltx_tag_bibitem">[30]</span>
                <span class="ltx_bibblock">
                  A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A.
                  N. Gomez, Ł. Kaiser, and I. Polosukhin, “Attention is all you
                  need,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib30.1.1">Advances in neural information processing
                    systems</em>, vol. 30, 2017.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib31">
                <span class="ltx_tag ltx_tag_bibitem">[31]</span>
                <span class="ltx_bibblock">
                  N. Ye, K. Li, H. Bai, R. Yu, L. Hong, F. Zhou, Z. Li, and J.
                  Zhu, “Ood-bench: Quantifying and understanding two dimensions
                  of out-of-distribution generalization,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib31.1.1">Proceedings of the IEEE/CVF Conference on
                    Computer Vision and Pattern Recognition</em>, 2022, pp.
                  7947–7958.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib32">
                <span class="ltx_tag ltx_tag_bibitem">[32]</span>
                <span class="ltx_bibblock">
                  T. T. Cai, H. Namkoong, S. Yadlowsky <em
                    class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">et
                    al.</em>, “Diagnosing model performance under distribution
                  shift.” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib32.2.2">arXiv preprint arXiv:2303.02011</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib33">
                <span class="ltx_tag ltx_tag_bibitem">[33]</span>
                <span class="ltx_bibblock">
                  J. Liu, T. Wang, P. Cui, and H. Namkoong, “On the need for a
                  language describing distribution shifts: Illustrations on
                  tabular datasets,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib33.1.1">arXiv preprint arXiv:2307.05284</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib34">
                <span class="ltx_tag ltx_tag_bibitem">[34]</span>
                <span class="ltx_bibblock">
                  W. X. Zhao, K. Zhou, J. Li, T. Tang, X. Wang, Y. Hou, Y. Min,
                  B. Zhang, J. Zhang, Z. Dong <em
                    class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">et
                    al.</em>, “A survey of large language models,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib34.2.2">arXiv
                    preprint arXiv:2303.18223</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib35">
                <span class="ltx_tag ltx_tag_bibitem">[35]</span>
                <span class="ltx_bibblock">
                  J. Lee, C. Liu, J. Kim, Z. Chen, Y. Sun, J. R. Rogers, W. K.
                  Chung, and C. Weng, “Deep learning for rare disease: A scoping
                  review,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib35.1.1">Journal of Biomedical Informatics</em>,
                  p. 104227, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib36">
                <span class="ltx_tag ltx_tag_bibitem">[36]</span>
                <span class="ltx_bibblock">
                  H. Yu, X. Zhang, R. Xu, J. Liu, Y. He, and P. Cui, “Rethinking
                  the evaluation protocol of domain generalization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv
                    preprint arXiv:2305.15253</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib37">
                <span class="ltx_tag ltx_tag_bibitem">[37]</span>
                <span class="ltx_bibblock">
                  X. Li, M. Liu, S. Gao, and W. Buntine, “A survey on
                  out-of-distribution evaluation of neural nlp models,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv
                    preprint arXiv:2306.15261</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib38">
                <span class="ltx_tag ltx_tag_bibitem">[38]</span>
                <span class="ltx_bibblock">
                  V. Vapnik, “Principles of risk minimization for learning
                  theory,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib38.1.1">NeurIPS 4</em>, vol. 4, 1991, pp.
                  831–838.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib39">
                <span class="ltx_tag ltx_tag_bibitem">[39]</span>
                <span class="ltx_bibblock">
                  A. Torralba and A. A. Efros, “Unbiased look at dataset bias,”
                  in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib39.1.1">CVPR 2011</em>. IEEE, 2011, pp.
                  1521–1528.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib40">
                <span class="ltx_tag ltx_tag_bibitem">[40]</span>
                <span class="ltx_bibblock">
                  D. C. Castro, I. Walker, and B. Glocker, “Causality matters in
                  medical imaging,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib40.1.1">Nature Communications</em>, vol. 11, no.
                  1, p. 3673, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib41">
                <span class="ltx_tag ltx_tag_bibitem">[41]</span>
                <span class="ltx_bibblock">
                  S. Garg, S. Balakrishnan, Z. C. Lipton, B. Neyshabur, and H.
                  Sedghi, “Leveraging unlabeled data to predict
                  out-of-distribution performance,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib41.1.1">International Conference on Learning
                    Representations</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib42">
                <span class="ltx_tag ltx_tag_bibitem">[42]</span>
                <span class="ltx_bibblock">
                  W. Deng and L. Zheng, “Are labels always necessary for
                  classifier accuracy evaluation?” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib42.1.1">Proceedings of the IEEE/CVF conference on
                    computer vision and pattern recognition</em>, 2021, pp. 15
                  069–15 078.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib43">
                <span class="ltx_tag ltx_tag_bibitem">[43]</span>
                <span class="ltx_bibblock">
                  C. Baek, Y. Jiang, A. Raghunathan, and J. Z. Kolter,
                  “Agreement-on-the-line: Predicting the performance of neural
                  networks under distribution shift,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Advances
                    in Neural Information Processing Systems</em>, vol. 35, pp.
                  19 274–19 289, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib44">
                <span class="ltx_tag ltx_tag_bibitem">[44]</span>
                <span class="ltx_bibblock">
                  J. N. Kaur, E. Kiciman, and A. Sharma, “Modeling the
                  data-generating process is necessary for out-of-distribution
                  generalization,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib44.1.1">arXiv preprint arXiv:2206.07837</em>,
                  2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib45">
                <span class="ltx_tag ltx_tag_bibitem">[45]</span>
                <span class="ltx_bibblock">
                  M. Li, H. Namkoong, and S. Xia, “Evaluating model performance
                  under worst-case subpopulations,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Advances
                    in Neural Information Processing Systems</em>, vol. 34, pp.
                  17 325–17 334, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib46">
                <span class="ltx_tag ltx_tag_bibitem">[46]</span>
                <span class="ltx_bibblock">
                  S. Gupta and D. Rothenhäusler, “The <math alttext="s"
                    class="ltx_Math" display="inline"
                    id="bib.bib46.1.m1.1"><semantics id="bib.bib46.1.m1.1a"><mi
                        id="bib.bib46.1.m1.1.1"
                        xref="bib.bib46.1.m1.1.1.cmml">s</mi><annotation-xml
                        encoding="MathML-Content" id="bib.bib46.1.m1.1b"><ci
                          id="bib.bib46.1.m1.1.1.cmml"
                          xref="bib.bib46.1.m1.1.1">𝑠</ci></annotation-xml><annotation
                        encoding="application/x-tex"
                        id="bib.bib46.1.m1.1c">s</annotation><annotation
                        encoding="application/x-llamapun"
                        id="bib.bib46.1.m1.1d">italic_s</annotation></semantics></math>-value:
                  evaluating stability with respect to distributional shifts,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib46.2.1">arXiv
                    preprint arXiv:2105.03067</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib47">
                <span class="ltx_tag ltx_tag_bibitem">[47]</span>
                <span class="ltx_bibblock">
                  H. Ye, C. Xie, T. Cai, R. Li, Z. Li, and L. Wang, “Towards a
                  theoretical framework of out-of-distribution generalization,”
                  <em class="ltx_emph ltx_font_italic"
                    id="bib.bib47.1.1">Advances in Neural Information Processing
                    Systems</em>, vol. 34, pp. 23 519–23 531, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib48">
                <span class="ltx_tag ltx_tag_bibitem">[48]</span>
                <span class="ltx_bibblock">
                  X. Zhang, R. Xu, H. Yu, Y. Dong, P. Tian, and P. Cu,
                  “Flatness-aware minimization for domain generalization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv
                    preprint arXiv:2307.11108</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib49">
                <span class="ltx_tag ltx_tag_bibitem">[49]</span>
                <span class="ltx_bibblock">
                  J. C. Duchi, T. Hashimoto, and H. Namkoong, “Distributionally
                  robust losses against mixture covariate shifts,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Under
                    review</em>, vol. 2, no. 1, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib50">
                <span class="ltx_tag ltx_tag_bibitem">[50]</span>
                <span class="ltx_bibblock">
                  P. Foret, A. Kleiner, H. Mobahi, and B. Neyshabur,
                  “Sharpness-aware minimization for efficiently improving
                  generalization,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib50.1.1">International Conference on Learning
                    Representations</em>, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib51">
                <span class="ltx_tag ltx_tag_bibitem">[51]</span>
                <span class="ltx_bibblock">
                  L. G. Neuberg, “Causality: models, reasoning, and inference,
                  by judea pearl, cambridge university press, 2000,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib51.1.1">Econometric Theory</em>, vol. 19, no. 4,
                  pp. 675–685, 2003.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib52">
                <span class="ltx_tag ltx_tag_bibitem">[52]</span>
                <span class="ltx_bibblock">
                  S. Wright, “Correlation and causation,” 1921.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib53">
                <span class="ltx_tag ltx_tag_bibitem">[53]</span>
                <span class="ltx_bibblock">
                  H. Venkateswara, J. Eusebio, S. Chakraborty, and S.
                  Panchanathan, “Deep hashing network for unsupervised domain
                  adaptation,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib53.1.1">CVPR</em>, 2017, pp. 5018–5027.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib54">
                <span class="ltx_tag ltx_tag_bibitem">[54]</span>
                <span class="ltx_bibblock">
                  X. Peng, Q. Bai, X. Xia, Z. Huang, K. Saenko, and B. Wang,
                  “Moment matching for multi-source domain adaptation,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib54.1.1">Proceedings of the IEEE/CVF international
                    conference on computer vision</em>, 2019, pp. 1406–1415.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib55">
                <span class="ltx_tag ltx_tag_bibitem">[55]</span>
                <span class="ltx_bibblock">
                  C. Wah, S. Branson, P. Welinder, P. Perona, and S. Belongie,
                  “The caltech-ucsd birds-200-2011 dataset,” 2011.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib56">
                <span class="ltx_tag ltx_tag_bibitem">[56]</span>
                <span class="ltx_bibblock">
                  W. Liang and J. Zou, “Metashift: A dataset of datasets for
                  evaluating contextual distribution shifts and training
                  conflicts,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib56.1.1">International Conference on Learning
                    Representations</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib57">
                <span class="ltx_tag ltx_tag_bibitem">[57]</span>
                <span class="ltx_bibblock">
                  K. Xiao, L. Engstrom, A. Ilyas, and A. Madry, “Noise or
                  signal: The role of image backgrounds in object recognition,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv
                    preprint arXiv:2006.09994</em>, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib58">
                <span class="ltx_tag ltx_tag_bibitem">[58]</span>
                <span class="ltx_bibblock">
                  S. Beery, G. Van Horn, and P. Perona, “Recognition in terra
                  incognita,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib58.1.1">Proceedings of the European conference on
                    computer vision (ECCV)</em>, 2018, pp. 456–473.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib59">
                <span class="ltx_tag ltx_tag_bibitem">[59]</span>
                <span class="ltx_bibblock">
                  S. Beery, A. Agarwal, E. Cole, and V. Birodkar, “The iwildcam
                  2021 competition dataset,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv
                    preprint arXiv:2105.03494</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib60">
                <span class="ltx_tag ltx_tag_bibitem">[60]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks and T. Dietterich, “Benchmarking neural network
                  robustness to common corruptions and perturbations,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib60.1.1">International Conference on Learning
                    Representations</em>, 2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib61">
                <span class="ltx_tag ltx_tag_bibitem">[61]</span>
                <span class="ltx_bibblock">
                  A. Khosla, T. Zhou, T. Malisiewicz, A. A. Efros, and A.
                  Torralba, “Undoing the damage of dataset bias,” in <em
                    class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">European
                    Conference on Computer Vision</em>. Springer, 2012, pp.
                  158–171.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib62">
                <span class="ltx_tag ltx_tag_bibitem">[62]</span>
                <span class="ltx_bibblock">
                  A. M. Puli, L. H. Zhang, E. K. Oermann, and R. Ranganath,
                  “Out-of-distribution generalization in the presence of
                  nuisance-induced spurious correlations,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib62.1.1">International Conference on Learning
                    Representations</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib63">
                <span class="ltx_tag ltx_tag_bibitem">[63]</span>
                <span class="ltx_bibblock">
                  Z. Liu, P. Luo, X. Wang, and X. Tang, “Deep learning face
                  attributes in the wild,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib63.1.1">Proceedings of the IEEE international
                    conference on computer vision</em>, 2015, pp. 3730–3738.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib64">
                <span class="ltx_tag ltx_tag_bibitem">[64]</span>
                <span class="ltx_bibblock">
                  A. E. Johnson, T. J. Pollard, N. R. Greenbaum, M. P. Lungren,
                  C.-y. Deng, Y. Peng, Z. Lu, R. G. Mark, S. J. Berkowitz, and
                  S. Horng, “Mimic-cxr-jpg, a large publicly available database
                  of labeled chest radiographs,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv
                    preprint arXiv:1901.07042</em>, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib65">
                <span class="ltx_tag ltx_tag_bibitem">[65]</span>
                <span class="ltx_bibblock">
                  J. Irvin, P. Rajpurkar, M. Ko, Y. Yu, S. Ciurea-Ilcus, C.
                  Chute, H. Marklund, B. Haghgoo, R. Ball, K. Shpanskaya <em
                    class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">et
                    al.</em>, “Chexpert: A large chest radiograph dataset with
                  uncertainty labels and expert comparison,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib65.2.2">Proceedings of the AAAI conference on
                    artificial intelligence</em>, vol. 33, no. 01, 2019, pp.
                  590–597.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib66">
                <span class="ltx_tag ltx_tag_bibitem">[66]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks, S. Basart, N. Mu, S. Kadavath, F. Wang, E.
                  Dorundo, R. Desai, T. Zhu, S. Parajuli, M. Guo <em
                    class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">et
                    al.</em>, “The many faces of robustness: A critical analysis
                  of out-of-distribution generalization,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib66.2.2">Proceedings of the IEEE/CVF International
                    Conference on Computer Vision</em>, 2021, pp. 8340–8349.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib67">
                <span class="ltx_tag ltx_tag_bibitem">[67]</span>
                <span class="ltx_bibblock">
                  A. Lynch, G. J. Dovonon, J. Kaddour, and R. Silva, “Spawrious:
                  A benchmark for fine control of spurious correlation biases,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">arXiv
                    preprint arXiv:2303.05470</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib68">
                <span class="ltx_tag ltx_tag_bibitem">[68]</span>
                <span class="ltx_bibblock">
                  Y. Yang, H. Zhang, D. Katabi, and M. Ghassemi, “Change is
                  hard: A closer look at subpopulation shift,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">arXiv
                    preprint arXiv:2302.12254</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib69">
                <span class="ltx_tag ltx_tag_bibitem">[69]</span>
                <span class="ltx_bibblock">
                  A. Barbu, D. Mayo, J. Alverio, W. Luo, C. Wang, D. Gutfreund,
                  J. Tenenbaum, and B. Katz, “Objectnet: A large-scale
                  bias-controlled dataset for pushing the limits of object
                  recognition models,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib69.1.1">Advances in neural information processing
                    systems</em>, vol. 32, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib70">
                <span class="ltx_tag ltx_tag_bibitem">[70]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks, K. Zhao, S. Basart, J. Steinhardt, and D. Song,
                  “Natural adversarial examples,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib70.1.1">Proceedings of the IEEE/CVF Conference on
                    Computer Vision and Pattern Recognition</em>, 2021, pp. 15
                  262–15 271.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib71">
                <span class="ltx_tag ltx_tag_bibitem">[71]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks, S. Basart, M. Mazeika, A. Zou, J. Kwon, M.
                  Mostajabi, J. Steinhardt, and D. Song, “Scaling
                  out-of-distribution detection for real-world settings,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib71.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2022, pp. 8759–8773.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib72">
                <span class="ltx_tag ltx_tag_bibitem">[72]</span>
                <span class="ltx_bibblock">
                  P. W. Koh, S. Sagawa, H. Marklund, S. M. Xie, M. Zhang, A.
                  Balsubramani, W. Hu, M. Yasunaga, R. L. Phillips, I. Gao <em
                    class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">et
                    al.</em>, “Wilds: A benchmark of in-the-wild distribution
                  shifts,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib72.2.2">International Conference on Machine
                    Learning</em>. PMLR, 2021, pp. 5637–5664.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib73">
                <span class="ltx_tag ltx_tag_bibitem">[73]</span>
                <span class="ltx_bibblock">
                  X. Mao, Y. Chen, Y. Zhu, D. Chen, H. Su, R. Zhang, and H. Xue,
                  “Coco-o: A benchmark for object detectors under natural
                  distribution shifts,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib73.1.1">arXiv preprint arXiv:2307.12730</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib74">
                <span class="ltx_tag ltx_tag_bibitem">[74]</span>
                <span class="ltx_bibblock">
                  G. Ros, L. Sellart, J. Materzynska, D. Vazquez, and A. M.
                  Lopez, “The synthia dataset: A large collection of synthetic
                  images for semantic segmentation of urban scenes,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib74.1.1">Proceedings of the IEEE conference on
                    computer vision and pattern recognition</em>, 2016, pp.
                  3234–3243.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib75">
                <span class="ltx_tag ltx_tag_bibitem">[75]</span>
                <span class="ltx_bibblock">
                  S. R. Richter, V. Vineet, S. Roth, and V. Koltun, “Playing for
                  data: Ground truth from computer games,” in <em
                    class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">Computer
                    Vision–ECCV 2016: 14th European Conference, Amsterdam, The
                    Netherlands, October 11-14, 2016, Proceedings, Part II
                    14</em>. Springer, 2016, pp. 102–118.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib76">
                <span class="ltx_tag ltx_tag_bibitem">[76]</span>
                <span class="ltx_bibblock">
                  M. Cordts, M. Omran, S. Ramos, T. Rehfeld, M. Enzweiler, R.
                  Benenson, U. Franke, S. Roth, and B. Schiele, “The cityscapes
                  dataset for semantic urban scene understanding,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib76.1.1">Proceedings of the IEEE conference on
                    computer vision and pattern recognition</em>, 2016, pp.
                  3213–3223.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib77">
                <span class="ltx_tag ltx_tag_bibitem">[77]</span>
                <span class="ltx_bibblock">
                  A. Williams, N. Nangia, and S. Bowman, “A broad-coverage
                  challenge corpus for sentence understanding through
                  inference,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib77.1.1">Proceedings of the 2018 Conference of the
                    North American Chapter of the Association for Computational
                    Linguistics: Human Language Technologies, Volume 1 (Long
                    Papers)</em>, 2018, pp. 1112–1122.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib78">
                <span class="ltx_tag ltx_tag_bibitem">[78]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks, X. Liu, E. Wallace, A. Dziedzic, R. Krishnan,
                  and D. Song, “Pretrained transformers improve
                  out-of-distribution robustness,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib78.1.1">Proceedings of the 58th Annual Meeting of
                    the Association for Computational Linguistics</em>, 2020,
                  pp. 2744–2751.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib79">
                <span class="ltx_tag ltx_tag_bibitem">[79]</span>
                <span class="ltx_bibblock">
                  R. Socher, A. Perelygin, J. Wu, J. Chuang, C. D. Manning, A.
                  Y. Ng, and C. Potts, “Recursive deep models for semantic
                  compositionality over a sentiment treebank,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib79.1.1">Proceedings of the 2013 conference on
                    empirical methods in natural language processing</em>, 2013,
                  pp. 1631–1642.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib80">
                <span class="ltx_tag ltx_tag_bibitem">[80]</span>
                <span class="ltx_bibblock">
                  A. Maas, R. E. Daly, P. T. Pham, D. Huang, A. Y. Ng, and C.
                  Potts, “Learning word vectors for sentiment analysis,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib80.1.1">Proceedings of the 49th annual meeting of
                    the association for computational linguistics: Human
                    language technologies</em>, 2011, pp. 142–150.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib81">
                <span class="ltx_tag ltx_tag_bibitem">[81]</span>
                <span class="ltx_bibblock">
                  L. Yang, S. Zhang, L. Qin, Y. Li, Y. Wang, H. Liu, J. Wang, X.
                  Xie, and Y. Zhang, “Glue-x: Evaluating natural language
                  understanding models from an out-of-distribution
                  generalization perspective,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">arXiv
                    preprint arXiv:2211.08073</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib82">
                <span class="ltx_tag ltx_tag_bibitem">[82]</span>
                <span class="ltx_bibblock">
                  L. Yuan, Y. Chen, G. Cui, H. Gao, F. Zou, X. Cheng, H. Ji, Z.
                  Liu, and M. Sun, “Revisiting out-of-distribution robustness in
                  nlp: Benchmark, analysis, and llms evaluations,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">arXiv
                    preprint arXiv:2306.04618</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib83">
                <span class="ltx_tag ltx_tag_bibitem">[83]</span>
                <span class="ltx_bibblock">
                  Z. Shen, P. Cui, J. Liu, T. Zhang, B. Li, and Z. Chen, “Stable
                  learning via differentiated variable decorrelation,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib83.1.1">Proceedings of the 26th acm sigkdd
                    international conference on knowledge discovery &amp; data
                    mining</em>, 2020, pp. 2185–2193.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib84">
                <span class="ltx_tag ltx_tag_bibitem">[84]</span>
                <span class="ltx_bibblock">
                  D. Anna Montoya, “House prices - advanced regression
                  techniques,” 2016. [Online]. Available: <a
                    class="ltx_ref ltx_url ltx_font_typewriter"
                    href="https://kaggle.com/competitions/house-prices-advanced-regression-techniques"
                    title>https://kaggle.com/competitions/house-prices-advanced-regression-techniques</a>
                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib85">
                <span class="ltx_tag ltx_tag_bibitem">[85]</span>
                <span class="ltx_bibblock">
                  M. Risdal, “New york city taxi trip duration,” 2017. [Online].
                  Available: <a class="ltx_ref ltx_url ltx_font_typewriter"
                    href="https://kaggle.com/competitions/nyc-taxi-trip-duration"
                    title>https://kaggle.com/competitions/nyc-taxi-trip-duration</a>
                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib86">
                <span class="ltx_tag ltx_tag_bibitem">[86]</span>
                <span class="ltx_bibblock">
                  S. Moosavi, M. H. Samavatian, S. Parthasarathy, and R.
                  Ramnath, “A countrywide traffic accident dataset,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">arXiv
                    preprint arXiv:1906.05409</em>, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib87">
                <span class="ltx_tag ltx_tag_bibitem">[87]</span>
                <span class="ltx_bibblock">
                  R. Kohavi <em class="ltx_emph ltx_font_italic"
                    id="bib.bib87.1.1">et al.</em>, “Scaling up the accuracy of
                  naive-bayes classifiers: A decision-tree hybrid.” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib87.2.2">Kdd</em>, vol. 96, 1996, pp. 202–207.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib88">
                <span class="ltx_tag ltx_tag_bibitem">[88]</span>
                <span class="ltx_bibblock">
                  S. Jesus, J. Pombal, D. Alves, A. Cruz, P. Saleiro, R.
                  Ribeiro, J. Gama, and P. Bizarro, “Turning the tables: Biased,
                  imbalanced, dynamic tabular datasets for ml evaluation,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib88.1.1">Advances
                    in Neural Information Processing Systems</em>, vol. 35, pp.
                  33 563–33 575, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib89">
                <span class="ltx_tag ltx_tag_bibitem">[89]</span>
                <span class="ltx_bibblock">
                  I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D.
                  Warde-Farley, S. Ozair, A. Courville, and Y. Bengio,
                  “Generative adversarial networks,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib89.1.1">Communications of the ACM</em>, vol. 63,
                  no. 11, pp. 139–144, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib90">
                <span class="ltx_tag ltx_tag_bibitem">[90]</span>
                <span class="ltx_bibblock">
                  B. Y. Idrissi, M. Arjovsky, M. Pezeshki, and D. Lopez-Paz,
                  “Simple data balancing achieves competitive
                  worst-group-accuracy,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib90.1.1">Conference on Causal Learning and
                    Reasoning</em>. PMLR, 2022, pp. 336–351.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib91">
                <span class="ltx_tag ltx_tag_bibitem">[91]</span>
                <span class="ltx_bibblock">
                  S. Santurkar, D. Tsipras, and A. Madry, “Breeds: Benchmarks
                  for subpopulation shift,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib91.1.1">arXiv preprint arXiv:2008.04859</em>,
                  2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib92">
                <span class="ltx_tag ltx_tag_bibitem">[92]</span>
                <span class="ltx_bibblock">
                  T. Gao, X. Yao, and D. Chen, “Simcse: Simple contrastive
                  learning of sentence embeddings,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib92.1.1">Proceedings of the 2021 Conference on
                    Empirical Methods in Natural Language Processing</em>, 2021,
                  pp. 6894–6910.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib93">
                <span class="ltx_tag ltx_tag_bibitem">[93]</span>
                <span class="ltx_bibblock">
                  B. Recht, R. Roelofs, L. Schmidt, and V. Shankar, “Do imagenet
                  classifiers generalize to imagenet?” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib93.1.1">International conference on machine
                    learning</em>. PMLR, 2019, pp. 5389–5400.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib94">
                <span class="ltx_tag ltx_tag_bibitem">[94]</span>
                <span class="ltx_bibblock">
                  K. Budhathoki, D. Janzing, P. Bloebaum, and H. Ng, “Why did
                  the distribution change?” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib94.1.1">International Conference on Artificial
                    Intelligence and Statistics</em>. PMLR, 2021, pp. 1666–1674.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib95">
                <span class="ltx_tag ltx_tag_bibitem">[95]</span>
                <span class="ltx_bibblock">
                  H. Zhang, H. Singh, M. Ghassemi, and S. Joshi, “” why did the
                  model fail?”: Attributing model performance changes to
                  distribution shifts,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib95.1.1">arXiv preprint arXiv:2210.10769</em>,
                  2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib96">
                <span class="ltx_tag ltx_tag_bibitem">[96]</span>
                <span class="ltx_bibblock">
                  S. Kulinski and D. I. Inouye, “Towards explaining distribution
                  shifts,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib96.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2023, pp. 17 931–17 952.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib97">
                <span class="ltx_tag ltx_tag_bibitem">[97]</span>
                <span class="ltx_bibblock">
                  D. Hendrycks and K. Gimpel, “A baseline for detecting
                  misclassified and out-of-distribution examples in neural
                  networks,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib97.1.1">International Conference on Learning
                    Representations</em>, 2016.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib98">
                <span class="ltx_tag ltx_tag_bibitem">[98]</span>
                <span class="ltx_bibblock">
                  N. Ng, K. Cho, N. Hulkund, and M. Ghassemi, “Predicting
                  out-of-domain generalization with local manifold smoothness,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib98.1.1">arXiv
                    preprint arXiv:2207.02093</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib99">
                <span class="ltx_tag ltx_tag_bibitem">[99]</span>
                <span class="ltx_bibblock">
                  D. Guillory, V. Shankar, S. Ebrahimi, T. Darrell, and L.
                  Schmidt, “Predicting with confidence on unseen distributions,”
                  in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib99.1.1">Proceedings of the IEEE/CVF international
                    conference on computer vision</em>, 2021, pp. 1134–1144.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib100">
                <span class="ltx_tag ltx_tag_bibitem">[100]</span>
                <span class="ltx_bibblock">
                  W. Deng, Y. Suh, S. Gould, and L. Zheng, “Confidence and
                  dispersity speak: Characterising prediction matrix for
                  unsupervised accuracy estimation,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib100.1.1">arXiv
                    preprint arXiv:2302.01094</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib101">
                <span class="ltx_tag ltx_tag_bibitem">[101]</span>
                <span class="ltx_bibblock">
                  W. Deng, S. Gould, and L. Zheng, “What does rotation
                  prediction tell us about classifier accuracy under varying
                  testing environments?” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib101.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2021, pp. 2579–2589.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib102">
                <span class="ltx_tag ltx_tag_bibitem">[102]</span>
                <span class="ltx_bibblock">
                  Y. Liu, C. X. Tian, H. Li, L. Ma, and S. Wang, “Neuron
                  activation coverage: Rethinking out-of-distribution detection
                  and generalization,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib102.1.1">arXiv preprint arXiv:2306.02879</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib103">
                <span class="ltx_tag ltx_tag_bibitem">[103]</span>
                <span class="ltx_bibblock">
                  S. Sagawa, P. W. Koh, T. B. Hashimoto, and P. Liang,
                  “Distributionally robust neural networks,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib103.1.1">International Conference on Learning
                    Representations</em>, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib104">
                <span class="ltx_tag ltx_tag_bibitem">[104]</span>
                <span class="ltx_bibblock">
                  Y. He, Z. Shen, and P. Cui, “Towards non-iid image
                  classification: A dataset and baselines,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib104.1.1">Pattern
                    Recognition</em>, vol. 110, p. 107383, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib105">
                <span class="ltx_tag ltx_tag_bibitem">[105]</span>
                <span class="ltx_bibblock">
                  Y. Yu, Z. Yang, A. Wei, Y. Ma, and J. Steinhardt, “Predicting
                  out-of-distribution error with the projection norm,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib105.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2022, pp. 25 721–25 746.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib106">
                <span class="ltx_tag ltx_tag_bibitem">[106]</span>
                <span class="ltx_bibblock">
                  C.-Y. Chuang, A. Torralba, and S. Jegelka, “Estimating
                  generalization under distribution shifts via domain-invariant
                  representations,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib106.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2020, pp. 1984–1994.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib107">
                <span class="ltx_tag ltx_tag_bibitem">[107]</span>
                <span class="ltx_bibblock">
                  Y. Lu, Y. Qin, R. Zhai, A. Shen, K. Chen, Z. Wang, S. Kolouri,
                  S. Stepputtis, J. Campbell, and K. Sycara, “Characterizing
                  out-of-distribution error via optimal transport,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib107.1.1">arXiv
                    preprint arXiv:2305.15640</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib108">
                <span class="ltx_tag ltx_tag_bibitem">[108]</span>
                <span class="ltx_bibblock">
                  O. Madani, D. Pennock, and G. Flake, “Co-validation: Using
                  model disagreement on unlabeled data to validate
                  classification algorithms,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib108.1.1">Advances in neural information
                    processing systems</em>, vol. 17, 2004.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib109">
                <span class="ltx_tag ltx_tag_bibitem">[109]</span>
                <span class="ltx_bibblock">
                  P. Nakkiran and Y. Bansal, “Distributional generalization: A
                  new kind of generalization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib109.1.1">arXiv
                    preprint arXiv:2009.08092</em>, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib110">
                <span class="ltx_tag ltx_tag_bibitem">[110]</span>
                <span class="ltx_bibblock">
                  Y. Jiang, V. Nagarajan, C. Baek, and J. Z. Kolter, “Assessing
                  generalization of sgd via disagreement,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib110.1.1">International Conference on Learning
                    Representations</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib111">
                <span class="ltx_tag ltx_tag_bibitem">[111]</span>
                <span class="ltx_bibblock">
                  J. P. Miller, R. Taori, A. Raghunathan, S. Sagawa, P. W. Koh,
                  V. Shankar, P. Liang, Y. Carmon, and L. Schmidt, “Accuracy on
                  the line: on the strong correlation between
                  out-of-distribution and in-distribution generalization,” in
                  <em class="ltx_emph ltx_font_italic"
                    id="bib.bib111.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2021, pp. 7721–7735.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib112">
                <span class="ltx_tag ltx_tag_bibitem">[112]</span>
                <span class="ltx_bibblock">
                  J. Chen, F. Liu, B. Avci, X. Wu, Y. Liang, and S. Jha,
                  “Detecting errors and estimating accuracy on unlabeled data
                  with self-training ensembles,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib112.1.1">Advances in Neural Information
                    Processing Systems</em>, vol. 34, pp. 14 980–14 992, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib113">
                <span class="ltx_tag ltx_tag_bibitem">[113]</span>
                <span class="ltx_bibblock">
                  A. Kirsch and Y. Gal, “A note on” assessing generalization of
                  sgd via disagreement”,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib113.1.1">Transactions on Machine Learning
                    Research</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib114">
                <span class="ltx_tag ltx_tag_bibitem">[114]</span>
                <span class="ltx_bibblock">
                  Y. Jiang, C. Baek, and J. Z. Kolter, “On the joint interaction
                  of models, data, and features,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib114.1.1">arXiv
                    preprint arXiv:2306.04793</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib115">
                <span class="ltx_tag ltx_tag_bibitem">[115]</span>
                <span class="ltx_bibblock">
                  P. Trivedi, D. Koutra, and J. J. Thiagarajan, “A closer look
                  at scoring functions and generalization prediction,” in <em
                    class="ltx_emph ltx_font_italic" id="bib.bib115.1.1">ICASSP
                    2023-2023 IEEE International Conference on Acoustics, Speech
                    and Signal Processing (ICASSP)</em>. IEEE, 2023, pp. 1–5.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib116">
                <span class="ltx_tag ltx_tag_bibitem">[116]</span>
                <span class="ltx_bibblock">
                  L. Chen, M. Zaharia, and J. Y. Zou, “Is unsupervised
                  performance estimation impossible when both covariates and
                  labels shift?” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib116.1.1">NeurIPS 2022 Workshop on Distribution
                    Shifts: Connecting Methods and Applications</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib117">
                <span class="ltx_tag ltx_tag_bibitem">[117]</span>
                <span class="ltx_bibblock">
                  A. Subbaswamy, R. Adams, and S. Saria, “Evaluating model
                  robustness and stability to dataset shift,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib117.1.1">International conference on artificial
                    intelligence and statistics</em>. PMLR, 2021, pp. 2611–2619.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib118">
                <span class="ltx_tag ltx_tag_bibitem">[118]</span>
                <span class="ltx_bibblock">
                  N. Thams, M. Oberst, and D. Sontag, “Evaluating robustness to
                  dataset shift via parametric robustness sets,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib118.1.1">Advances in Neural Information
                    Processing Systems</em>, vol. 35, pp. 16 877–16 889, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib119">
                <span class="ltx_tag ltx_tag_bibitem">[119]</span>
                <span class="ltx_bibblock">
                  H. Namkoong, Y. Ma, and P. W. Glynn, “Minimax optimal
                  estimation of stability under distribution shift,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib119.1.1">arXiv
                    preprint arXiv:2212.06338</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib120">
                <span class="ltx_tag ltx_tag_bibitem">[120]</span>
                <span class="ltx_bibblock">
                  J. Peters, P. Bühlmann, and N. Meinshausen, “Causal inference
                  by using invariant prediction: identification and confidence
                  intervals,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib120.1.1">Journal of the Royal Statistical
                    Society. Series B (Statistical Methodology)</em>, vol. 78,
                  no. 5, pp. 947–1012, 2016. [Online]. Available: <a
                    class="ltx_ref ltx_url ltx_font_typewriter"
                    href="http://www.jstor.org/stable/44682904"
                    title>http://www.jstor.org/stable/44682904</a>
                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib121">
                <span class="ltx_tag ltx_tag_bibitem">[121]</span>
                <span class="ltx_bibblock">
                  Y. Wald, A. Feder, D. Greenfeld, and U. Shalit, “On
                  calibration and out-of-domain generalization,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib121.1.1">Advances in neural information
                    processing systems</em>, vol. 34, pp. 2215–2227, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib122">
                <span class="ltx_tag ltx_tag_bibitem">[122]</span>
                <span class="ltx_bibblock">
                  J. Liu, J. Wu, R. Pi, R. Xu, X. Zhang, B. Li, and P. Cui,
                  “Measure the predictive heterogeneity,” in <em
                    class="ltx_emph ltx_font_italic" id="bib.bib122.1.1">The
                    Eleventh International Conference on Learning
                    Representations</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib123">
                <span class="ltx_tag ltx_tag_bibitem">[123]</span>
                <span class="ltx_bibblock">
                  N. S. Keskar, D. Mudigere, J. Nocedal, M. Smelyanskiy, and P.
                  T. P. Tang, “On large-batch training for deep learning:
                  Generalization gap and sharp minima,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib123.1.1">International Conference on Learning
                    Representations</em>, 2016.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib124">
                <span class="ltx_tag ltx_tag_bibitem">[124]</span>
                <span class="ltx_bibblock">
                  Z. Jia and H. Su, “Information-theoretic local minima
                  characterization and regularization,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib124.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2020, pp. 4773–4783.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib125">
                <span class="ltx_tag ltx_tag_bibitem">[125]</span>
                <span class="ltx_bibblock">
                  P. Izmailov, D. Podoprikhin, T. Garipov, D. Vetrov, and A. G.
                  Wilson, “Averaging weights leads to wider optima and better
                  generalization,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib125.1.1">arXiv preprint arXiv:1803.05407</em>,
                  2018.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib126">
                <span class="ltx_tag ltx_tag_bibitem">[126]</span>
                <span class="ltx_bibblock">
                  X. Zhang, R. Xu, H. Yu, H. Zou, and P. Cui, “Gradient norm
                  aware minimization seeks first-order flatness and improves
                  generalization,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib126.1.1">Proceedings of the IEEE/CVF Conference
                    on Computer Vision and Pattern Recognition</em>, 2023, pp.
                  20 247–20 257.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib127">
                <span class="ltx_tag ltx_tag_bibitem">[127]</span>
                <span class="ltx_bibblock">
                  P. Chaudhari, A. Choromanska, S. Soatto, Y. LeCun, C.
                  Baldassi, C. Borgs, J. Chayes, L. Sagun, and R. Zecchina,
                  “Entropy-sgd: Biasing gradient descent into wide valleys,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib127.1.1">Journal
                    of Statistical Mechanics: Theory and Experiment</em>, vol.
                  2019, no. 12, p. 124018, 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib128">
                <span class="ltx_tag ltx_tag_bibitem">[128]</span>
                <span class="ltx_bibblock">
                  A. Lewkowycz, Y. Bahri, E. Dyer, J. Sohl-Dickstein, and G.
                  Gur-Ari, “The large learning rate phase of deep learning: the
                  catapult mechanism,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib128.1.1">arXiv preprint arXiv:2003.02218</em>,
                  2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib129">
                <span class="ltx_tag ltx_tag_bibitem">[129]</span>
                <span class="ltx_bibblock">
                  J. Cha, S. Chun, K. Lee, H.-C. Cho, S. Park, Y. Lee, and S.
                  Park, “Swad: Domain generalization by seeking flat minima,”
                  <em class="ltx_emph ltx_font_italic"
                    id="bib.bib129.1.1">Advances in Neural Information
                    Processing Systems</em>, vol. 34, pp. 22 405–22 418, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib130">
                <span class="ltx_tag ltx_tag_bibitem">[130]</span>
                <span class="ltx_bibblock">
                  D. Arpit, H. Wang, Y. Zhou, and C. Xiong, “Ensemble of
                  averages: Improving model selection and boosting performance
                  in domain generalization,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib130.1.1">Advances in Neural Information
                    Processing Systems</em>, vol. 35, pp. 8265–8277, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib131">
                <span class="ltx_tag ltx_tag_bibitem">[131]</span>
                <span class="ltx_bibblock">
                  X. Chu, Y. Jin, W. Zhu, Y. Wang, X. Wang, S. Zhang, and H.
                  Mei, “Dna: Domain generalization with diversified neural
                  averaging,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib131.1.1">International Conference on Machine
                    Learning</em>. PMLR, 2022, pp. 4010–4034.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib132">
                <span class="ltx_tag ltx_tag_bibitem">[132]</span>
                <span class="ltx_bibblock">
                  M. Wortsman, G. Ilharco, S. Y. Gadre, R. Roelofs, R.
                  Gontijo-Lopes, A. S. Morcos, H. Namkoong, A. Farhadi, Y.
                  Carmon, S. Kornblith <em class="ltx_emph ltx_font_italic"
                    id="bib.bib132.1.1">et al.</em>, “Model soups: averaging
                  weights of multiple fine-tuned models improves accuracy
                  without increasing inference time,” in <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib132.2.2">International Conference on Machine
                    Learning</em>. PMLR, 2022, pp. 23 965–23 998.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib133">
                <span class="ltx_tag ltx_tag_bibitem">[133]</span>
                <span class="ltx_bibblock">
                  A. Rame, K. Ahuja, J. Zhang, M. Cord, L. Bottou, and D.
                  Lopez-Paz, “Model ratatouille: Recycling diverse models for
                  out-of-distribution generalization,” 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib134">
                <span class="ltx_tag ltx_tag_bibitem">[134]</span>
                <span class="ltx_bibblock">
                  A. Rame, M. Kirchmeyer, T. Rahier, A. Rakotomamonjy, P.
                  Gallinari, and M. Cord, “Diverse weight averaging for
                  out-of-distribution generalization,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib134.1.1">Advances in Neural Information
                    Processing Systems</em>, vol. 35, pp. 10 821–10 836, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib135">
                <span class="ltx_tag ltx_tag_bibitem">[135]</span>
                <span class="ltx_bibblock">
                  Z. Li, K. Ren, X. Jiang, Y. Shen, H. Zhang, and D. Li,
                  “Simple: Specialized model-sample matching for domain
                  generalization,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib135.1.1">The Eleventh International Conference on
                    Learning Representations</em>, 2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib136">
                <span class="ltx_tag ltx_tag_bibitem">[136]</span>
                <span class="ltx_bibblock">
                  M. Andriushchenko, F. Croce, M. Müller, M. Hein, and N.
                  Flammarion, “A modern look at the relationship between
                  sharpness and generalization,” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib136.1.1">arXiv
                    preprint arXiv:2302.07011</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib137">
                <span class="ltx_tag ltx_tag_bibitem">[137]</span>
                <span class="ltx_bibblock">
                  N. Meinshausen, “Causality from a distributional robustness
                  point of view,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib137.1.1">2018 IEEE Data Science Workshop
                    (DSW)</em>. IEEE, 2018, pp. 6–10.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib138">
                <span class="ltx_tag ltx_tag_bibitem">[138]</span>
                <span class="ltx_bibblock">
                  T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P.
                  Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em
                    class="ltx_emph ltx_font_italic" id="bib.bib138.1.1">et
                    al.</em>, “Language models are few-shot learners,” <em
                    class="ltx_emph ltx_font_italic"
                    id="bib.bib138.2.2">Advances in neural information
                    processing systems</em>, vol. 33, pp. 1877–1901, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib139">
                <span class="ltx_tag ltx_tag_bibitem">[139]</span>
                <span class="ltx_bibblock">
                  S. Bubeck, V. Chandrasekaran, R. Eldan, J. Gehrke, E. Horvitz,
                  E. Kamar, P. Lee, Y. T. Lee, Y. Li, S. Lundberg <em
                    class="ltx_emph ltx_font_italic" id="bib.bib139.1.1">et
                    al.</em>, “Sparks of artificial general intelligence: Early
                  experiments with gpt-4,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib139.2.2">arXiv preprint arXiv:2303.12712</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib140">
                <span class="ltx_tag ltx_tag_bibitem">[140]</span>
                <span class="ltx_bibblock">
                  Y. Chang, X. Wang, J. Wang, Y. Wu, K. Zhu, H. Chen, L. Yang,
                  X. Yi, C. Wang, Y. Wang <em class="ltx_emph ltx_font_italic"
                    id="bib.bib140.1.1">et al.</em>, “A survey on evaluation of
                  large language models,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib140.2.2">arXiv preprint arXiv:2307.03109</em>,
                  2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib141">
                <span class="ltx_tag ltx_tag_bibitem">[141]</span>
                <span class="ltx_bibblock">
                  A. Kumar, A. Raghunathan, R. M. Jones, T. Ma, and P. Liang,
                  “Fine-tuning can distort pretrained features and underperform
                  out-of-distribution,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib141.1.1">International Conference on Learning
                    Representations</em>, 2021.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib142">
                <span class="ltx_tag ltx_tag_bibitem">[142]</span>
                <span class="ltx_bibblock">
                  M. Mazumder, C. Banbury, X. Yao, B. Karlaš, W. G. Rojas, S.
                  Diamos, G. Diamos, L. He, D. Kiela, D. Jurado <em
                    class="ltx_emph ltx_font_italic" id="bib.bib142.1.1">et
                    al.</em>, “Dataperf: Benchmarks for data-centric ai
                  development,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib142.2.2">arXiv preprint arXiv:2207.10062</em>,
                  2022.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib143">
                <span class="ltx_tag ltx_tag_bibitem">[143]</span>
                <span class="ltx_bibblock">
                  X. Zhang, Y. He, T. Wang, J. Qi, H. Yu, Z. Wang, J. Peng, R.
                  Xu, Z. Shen, Y. Niu <em class="ltx_emph ltx_font_italic"
                    id="bib.bib143.1.1">et al.</em>, “Nico challenge:
                  Out-of-distribution generalization for image recognition
                  challenges,” in <em class="ltx_emph ltx_font_italic"
                    id="bib.bib143.2.2">European Conference on Computer
                    Vision</em>. Springer, 2022, pp. 433–450.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib144">
                <span class="ltx_tag ltx_tag_bibitem">[144]</span>
                <span class="ltx_bibblock">
                  D. Zha, Z. P. Bhat, K.-H. Lai, F. Yang, Z. Jiang, S. Zhong,
                  and X. Hu, “Data-centric artificial intelligence: A survey,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib144.1.1">arXiv
                    preprint arXiv:2303.10158</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib145">
                <span class="ltx_tag ltx_tag_bibitem">[145]</span>
                <span class="ltx_bibblock">
                  Z. Shen, H. Yu, P. Cui, J. Liu, X. Zhang, L. Zhou, and F. Liu,
                  “Meta adaptive task sampling for few-domain generalization,”
                  <em class="ltx_emph ltx_font_italic" id="bib.bib145.1.1">arXiv
                    preprint arXiv:2305.15644</em>, 2023.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib146">
                <span class="ltx_tag ltx_tag_bibitem">[146]</span>
                <span class="ltx_bibblock">
                  R. Taori, A. Dave, V. Shankar, N. Carlini, B. Recht, and L.
                  Schmidt, “When robustness doesn’t promote robustness:
                  Synthetic vs. natural distribution shifts on imagenet,” 2019.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib147">
                <span class="ltx_tag ltx_tag_bibitem">[147]</span>
                <span class="ltx_bibblock">
                  H. Mania and S. Sra, “Why do classifier accuracies show linear
                  trends under distribution shift?” <em
                    class="ltx_emph ltx_font_italic" id="bib.bib147.1.1">arXiv
                    preprint arXiv:2012.15483</em>, 2020.

                </span>
              </li>
              <li class="ltx_bibitem" id="bib.bib148">
                <span class="ltx_tag ltx_tag_bibitem">[148]</span>
                <span class="ltx_bibblock">
                  A. J. Andreassen, Y. Bahri, B. Neyshabur, and R. Roelofs, “The
                  evolution of out-of-distribution robustness throughout
                  fine-tuning,” <em class="ltx_emph ltx_font_italic"
                    id="bib.bib148.1.1">Transactions on Machine Learning
                    Research</em>, 2022.

                </span>
              </li>
            </ul>
          </section>
        </article>
      </div>
      <footer class="ltx_page_footer">
        <div class="ltx_page_logo">Generated on Mon Mar 4 09:27:58 2024 by <a
            class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span
              style="letter-spacing:-0.2em; margin-right:0.1em;">L<span
                style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span
                style="position:relative; bottom:-0.4ex;">E</span></span><span
              class="ltx_font_smallcaps">xml</span><img alt="[LOGO]"
              src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" /></a>
        </div></footer>
    </div>
  </body>
</html>